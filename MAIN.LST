Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 1
MAIN.ASM



      1
      2				     ; M0 ? Sanity check: texto	-> 13h -> desenha 1 pixel -> volta pro texto
      3	0000			     .model small
      4	0000			     .stack
      5
      6	0000			     .data
      7	0000  0000			 ale dw	0
      8	0002  00			 menu db 0
      9	0003  01			 fase db 1
     10	0004  0E*(20) DA C4 C4 C4 +	 btn_iniciar db	 14 dup(" "),218,196,196,196,196,196,196,196,196,196,191,13,10
     11	      C4 C4 C4 C4 C4 C4	BF+
     12	      0D 0A
     13	001F  0E*(20) B3 20 20 4A +		      db 14 dup(" "),179,"  JOGAR  ",179,10,13
     14	      4F 47 41 52 20 20	B3+
     15	      0A 0D
     16	003A  0E*(20) C0 C4 C4 C4 +		      db 14 dup(" "),192,196,196,196,196,196,196,196,196,196,217,13,10
     17	      C4 C4 C4 C4 C4 C4	D9+
     18	      0D 0A
     19
     20	      =0051			 btn_iniciar_length equ	$-btn_iniciar
     21
     22	0055  0E*(20) DA C4 C4 C4 +	 btn_sair db  14 dup(" "),218,196,196,196,196,196,196,196,196,196,191,13,10
     23	      C4 C4 C4 C4 C4 C4	BF+
     24	      0D 0A
     25	0070  0E*(20) B3 20 20 53 +		   db 14 dup(" "),179,"	 SAIR	",179,10,13
     26	      41 49 52 20 20 20	B3+
     27	      0A 0D
     28	008B  0E*(20) C0 C4 C4 C4 +		   db 14 dup(" "),192,196,196,196,196,196,196,196,196,196,217,13,10
     29	      C4 C4 C4 C4 C4 C4	D9+
     30	      0D 0A
     31
     32	      =0051			 btn_sair_length equ $-btn_sair
     33	00A6  02*(20) 20 20 20 20 +	 string	 db 2 dup(" "),"				    ",13,10
     34	      20 20 20 20 20 20	20+
     35	      20 20 20 20 20 20	20+
     36	      20 20 20 20 20 20	20+
     37	      20 20 20 20 20 20	20+
     38	      20 20 20 20 0D 0A
     39	00CE  02*(20) 20 20 5F 5F +		 db 2 dup(" "),"  ___			 _    _	    ",13,10
     40	      5F 20 20 20 20 20	20+
     41	      20 20 20 20 20 20	20+
     42	      20 20 20 20 20 20	20+
     43	      5F 20 20 20 20 5F	20+
     44	      20 20 20 20 0D 0A
     45	00F6  02*(20) 20 2F 20 5F +		 db 2 dup(" ")," / __| __ _ _ __ _ _ __	| |__| |___ ",13,10
     46	      5F 7C 20 5F 5F 20	5F+
     47	      20 5F 20 5F 5F 20	5F+
     48	      20 5F 20 5F 5F 20	7C+
     49	      20 7C 5F 5F 7C 20	7C+
     50	      5F 5F 5F 20 0D 0A
     51	011E  02*(20) 20 5C 5F 5F +		 db 2 dup(" ")," \__ \/	_| '_/ _` | '  \| '_ \ / -_)",13,10
     52	      20 5C 2F 20 5F 7C	20+
     53	      27 5F 2F 20 5F 60	20+
     54	      7C 20 27 20 20 5C	7C+
     55	      20 27 5F 20 5C 20	2F+
     56	      20 2D 5F 29 0D 0A
     57	0146  02*(20) 20 7C 5F 5F +		 db 2 dup(" ")," |___/\__|_| \__,_|_|_|_|_.__/_\___|",13,10
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 2
MAIN.ASM



     58	      5F 2F 5C 5F 5F 7C	5F+
     59	      7C 20 5C 5F 5F 2C	5F+
     60	      7C 5F 7C 5F 7C 5F	7C+
     61	      5F 2E 5F 5F 2F 5F	5C+
     62	      5F 5F 5F 7C 0D 0A
     63
     64
     65	      =00C8			 string_length equ $-string
     66	016E  00 00 00 00 00 00	00+	 meteor_sprite	 db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
     67	      00 00 00 00 00 00	00+
     68	      00 00 00 00 00 00	00+
     69	      00 00 00
     70	0186  00 00 00 00 00 00	00+			 db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
     71	      00 00 00 00 00 00	00+
     72	      00 00 00 00 00 00	00+
     73	      00 00 00
     74	019E  00 00 00 00 00 00	00+			 db 0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0
     75	      00 00 01 01 01 01	00+
     76	      00 00 00 00 00 00	00+
     77	      00 00 00
     78	01B6  00 00 00 00 00 00	01+			 db 0,0,0,0,0,0,1,1,4,4,4,4,4,1,0,0,0,0,0,0,0,0,0,0
     79	      01 04 04 04 04 04	01+
     80	      00 00 00 00 00 00	00+
     81	      00 00 00
     82	01CE  00 00 00 00 00 01	04+			 db 0,0,0,0,0,1,4,4,4,4,4,4,4,4,1,0,1,1,0,0,0,0,0,0
     83	      04 04 04 04 04 04	04+
     84	      01 00 01 01 00 00	00+
     85	      00 00 00
     86	01E6  00 00 00 00 00 01	04+			 db 0,0,0,0,0,1,4,4,4,4,4,4,4,4,1,0,1,1,0,0,0,0,0,0
     87	      04 04 04 04 04 04	04+
     88	      01 00 01 01 00 00	00+
     89	      00 00 00
     90	01FE  00 00 00 00 01 04	04+			 db 0,0,0,0,1,4,4,4,5,5,5,5,4,4,4,1,0,0,0,0,0,0,0,0
     91	      04 05 05 05 05 04	04+
     92	      04 01 00 00 00 00	00+
     93	      00 00 00
     94	0216  00 00 00 01 04 04	05+			 db 0,0,0,1,4,4,5,5,5,5,5,5,5,4,4,1,0,0,0,0,0,0,0,0
     95	      05 05 05 05 05 05	04+
     96	      04 01 00 00 00 00	00+
     97	      00 00 00
     98	022E  00 00 00 01 04 04	05+			 db 0,0,0,1,4,4,5,5,5,5,5,5,5,5,4,1,5,5,0,0,0,0,0,0
     99	      05 05 05 05 05 05	05+
    100	      04 01 05 05 00 00	00+
    101	      00 00 00
    102	0246  00 00 00 01 04 04	04+			 db 0,0,0,1,4,4,4,5,5,5,5,5,5,4,4,1,4,5,0,0,0,0,0,0
    103	      05 05 05 05 05 05	04+
    104	      04 01 04 05 00 00	00+
    105	      00 00 00
    106	025E  00 00 00 01 04 04	04+			 db 0,0,0,1,4,4,4,5,5,5,5,5,5,4,4,1,4,5,0,0,0,0,0,0
    107	      05 05 05 05 05 05	04+
    108	      04 01 04 05 00 00	00+
    109	      00 00 00
    110	0276  00 00 00 01 04 04	04+			 db 0,0,0,1,4,4,4,5,5,5,5,5,5,4,4,1,4,5,0,0,0,0,0,0
    111	      05 05 05 05 05 05	04+
    112	      04 01 04 05 00 00	00+
    113	      00 00 00
    114	028E  00 00 00 00 01 04	04+			 db 0,0,0,0,1,4,4,4,4,5,5,5,4,4,1,0,0,0,0,0,0,0,0,0
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 3
MAIN.ASM



    115	      04 04 05 05 05 04	04+
    116	      01 00 00 00 00 00	00+
    117	      00 00 00
    118	02A6  00 00 00 00 01 04	04+			 db 0,0,0,0,1,4,4,4,4,4,4,4,4,4,1,0,1,5,0,0,0,0,0,0
    119	      04 04 04 04 04 04	04+
    120	      01 00 01 05 00 00	00+
    121	      00 00 00
    122	02BE  00 00 00 00 00 01	04+			 db 0,0,0,0,0,1,4,4,4,4,4,4,4,1,0,0,0,0,0,0,0,0,0,0
    123	      04 04 04 04 04 04	01+
    124	      00 00 00 00 00 00	00+
    125	      00 00 00
    126	02D6  00 00 00 00 00 00	01+			 db 0,0,0,0,0,0,1,4,4,4,4,4,1,0,4,4,0,0,0,0,0,0,0,0
    127	      04 04 04 04 04 01	00+
    128	      04 04 00 00 00 00	00+
    129	      00 00 00
    130	02EE  00 00 00 00 00 00	01+			 db 0,0,0,0,0,0,1,4,4,4,4,4,1,0,4,4,0,0,0,0,0,0,0,0
    131	      04 04 04 04 04 01	00+
    132	      04 04 00 00 00 00	00+
    133	      00 00 00
    134	0306  00 00 00 00 00 00	00+			 db 0,0,0,0,0,0,0,1,1,1,1,1,0,0,1,0,0,0,0,0,0,0,0,0
    135	      01 01 01 01 01 00	00+
    136	      01 00 00 00 00 00	00+
    137	      00 00 00
    138	031E  00 00 00 00 00 00	00+			 db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
    139	      00 00 00 00 00 00	00+
    140	      00 00 00 00 00 00	00+
    141	      00 00 00
    142	0336  00 00 00 00 00 00	00+			 db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
    143	      00 00 00 00 00 00	00+
    144	      00 00 00 00 00 00	00+
    145	      00 00 00
    146
    147
    148	034E  00 00 00 00 00 00	00+	 alien_sprite	 db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
    149	      00 00 00 00 00 00	00+
    150	      00 00 00 00 00 00	00+
    151	      00 00 00
    152	0366  00 00 00 00 00 00	00+			 db 0,0,0,0,0,0,0,0,0,0AH,0AH,0AH,2,0EH,0AH,0AH,0AH,0,0,0,0,0,0,0
    153	      00 00 0A 0A 0A 02	0E+
    154	      0A 0A 0A 00 00 00	00+
    155	      00 00 00
    156	037E  00 00 00 00 00 00	0E+			 db 0,0,0,0,0,0,0EH,2,2,2,2,2,2,2,2,2,2,0EH,0,0,0,0,0,0
    157	      02 02 02 02 02 02	02+
    158	      02 02 02 0E 00 00	00+
    159	      00 00 00
    160	0396  00 00 00 00 00 00	0E+			 db 0,0,0,0,0,0,0EH,2,2,2,2,2,2,2,2,2,2,0EH,0,0,0,0,0,0
    161	      02 02 02 02 02 02	02+
    162	      02 02 02 0E 00 00	00+
    163	      00 00 00
    164	03AE  00 00 00 00 00 0E	02+			 db 0,0,0,0,0,0EH,2,2,2,2,2,2,2,2,2,2,2,2,0EH,0,0,0,0,0
    165	      02 02 02 02 02 02	02+
    166	      02 02 02 02 0E 00	00+
    167	      00 00 00
    168	03C6  00 00 00 00 00 0E	0E+			 db 0,0,0,0,0,0EH,0EH,0AH,5,5,0AH,2,0EH,0AH,5,5,0AH,0EH,0EH,0,0,0,0,0
    169	      0A 05 05 0A 02 0E	0A+
    170	      05 05 0A 0E 0E 00	00+
    171	      00 00 00
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 4
MAIN.ASM



    172	03DE  00 00 00 00 00 0E	0E+			 db 0,0,0,0,0,0EH,0EH,0AH,5,5,0AH,2,0EH,0AH,5,5,0AH,0EH,0EH,0,0,0,0,0
    173	      0A 05 05 0A 02 0E	0A+
    174	      05 05 0A 0E 0E 00	00+
    175	      00 00 00
    176	03F6  00 00 00 00 00 0E	0E+			 db 0,0,0,0,0,0EH,0EH,0EH,0AH,0AH,0AH,2,0EH,0AH,0AH,0AH,0EH,0EH,0EH,0,0,0,0,0
    177	      0E 0A 0A 0A 02 0E	0A+
    178	      0A 0A 0E 0E 0E 00	00+
    179	      00 00 00
    180	040E  00 00 00 00 00 00	00+			 db 0,0,0,0,0,0,0,0EH,0AH,2,5,5,2,5,5,2,0AH,0EH,0,0,0,0,0,0
    181	      0E 0A 02 05 05 02	05+
    182	      05 02 0A 0E 00 00	00+
    183	      00 00 00
    184	0426  00 00 00 00 00 00	00+			 db 0,0,0,0,0,0,0,0EH,0AH,2,5,5,2,5,5,2,0AH,0EH,0,0,0,0,0,0
    185	      0E 0A 02 05 05 02	05+
    186	      05 02 0A 0E 00 00	00+
    187	      00 00 00
    188	043E  00 00 00 00 00 00	00+			 db 0,0,0,0,0,0,0,0EH,0AH,2,5,5,0AH,5,5,2,0AH,0EH,0,0,0,0,0,0
    189	      0E 0A 02 05 05 0A	05+
    190	      05 02 0A 0E 00 00	00+
    191	      00 00 00
    192	0456  00 00 00 00 00 00	00+			 db 0,0,0,0,0,0,0,0EH,0AH,2,5,5,0AH,5,5,2,0AH,0EH,0,0,0,0,0,0
    193	      0E 0A 02 05 05 0A	05+
    194	      05 02 0A 0E 00 00	00+
    195	      00 00 00
    196	046E  00 00 00 00 00 00	00+			 db 0,0,0,0,0,0,0,0EH,0AH,2,5,5,2,5,5,2,0AH,0EH,0,0,0,0,0,0
    197	      0E 0A 02 05 05 02	05+
    198	      05 02 0A 0E 00 00	00+
    199	      00 00 00
    200	0486  00 00 00 00 00 00	00+			 db 0,0,0,0,0,0,0,0EH,0AH,2,5,5,2,5,5,2,0AH,0EH,0,0,0,0,0,0
    201	      0E 0A 02 05 05 02	05+
    202	      05 02 0A 0E 00 00	00+
    203	      00 00 00
    204	049E  00 00 00 00 00 00	00+			 db 0,0,0,0,0,0,0,0,0AH,0AH,0AH,2,0EH,0AH,0AH,0AH,0,0,0,0,0,0,0
    205	      00 0A 0A 0A 02 0E	0A+
    206	      0A 0A 00 00 00 00	00+
    207	      00 00
    208	04B5  00 00 00 00 00 00	00+			 db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
    209	      00 00 00 00 00 00	00+
    210	      00 00 00 00 00 00	00+
    211	      00 00 00
    212	04CD  00 00 00 00 00 00	00+			 db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
    213	      00 00 00 00 00 00	00+
    214	      00 00 00 00 00 00	00+
    215	      00 00 00
    216	04E5  00 00 00 00 00 00	00+			 db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
    217	      00 00 00 00 00 00	00+
    218	      00 00 00 00 00 00	00+
    219	      00 00 00
    220	04FD  00 00 00 00 00 00	00+			 db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
    221	      00 00 00 00 00 00	00+
    222	      00 00 00 00 00 00	00+
    223	      00 00 00
    224	0515  00 00 00 00 00 00	00+			 db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
    225	      00 00 00 00 00 00	00+
    226	      00 00 00 00 00 00	00+
    227	      00 00 00
    228	052D  00 00 00 00 00 00	00+			 db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 5
MAIN.ASM



    229	      00 00 00 00 00 00	00+
    230	      00 00 00 00 00 00	00+
    231	      00 00 00
    232
    233	0545  9D6C			 alien_pos dw 125*320 +	300 ; posição	inicial	(linha 125, x =	300)
    234	0547  00			 alien_dir db 0	 ; direção do	alien (0=esquerda, 1=direita)
    235
    236					 ; Sprite da nave principal (29x13 pixels) - baseado no	exemplo
    237	0548  00 00 00 00 00 00	00+	 ship_sprite db	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
    238	      00 00 00 00 00 00	00+
    239	      00 00 00 00 00 00	00+
    240	      00 00 00
    241	0560  00 00 00 00 00 00	00+		     db	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
    242	      00 00 00 00 00 00	00+
    243	      00 00 00 00 00 00	00+
    244	      00 00 00
    245	0578  00 00 00 00 00 00	00+		     db	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
    246	      00 00 00 00 00 00	00+
    247	      00 00 00 00 00 00	00+
    248	      00 00 00
    249	0590  00 00 00 00 00 00	00+		     db	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
    250	      00 00 00 00 00 00	00+
    251	      00 00 00 00 00 00	00+
    252	      00 00 00
    253	05A8  00 00 00 00 00 00	00+		     db	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
    254	      00 00 00 00 00 00	00+
    255	      00 00 00 00 00 00	00+
    256	      00 00 00
    257	05C0  00 00 00 00 00 0F	0F+		     db	0,0,0,0,0,15,15,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
    258	      0F 00 00 00 00 00	00+
    259	      00 00 00 00 00 00	00+
    260	      00 00 00
    261	05D8  00 00 00 00 00 00	01+		     db	0,0,0,0,0,0,1,15,15,0AH,0AH,0AH,0,0,0,0,0,0,0,0,0,0,0,0
    262	      0F 0F 0A 0A 0A 00	00+
    263	      00 00 00 00 00 00	00+
    264	      00 00 00
    265	05F0  00 00 00 00 00 00	01+		     db	0,0,0,0,0,0,1,15,15,15,0AH,0AH,0,0,0,0,0,0,0,0,0,0,0,0
    266	      0F 0F 0F 0A 0A 00	00+
    267	      00 00 00 00 00 00	00+
    268	      00 00 00
    269	0608  00 00 00 00 00 00	01+		     db	0,0,0,0,0,0,1,15,15,15,15,15,15,0,0,0,0,0,0,0,0,0,0,0
    270	      0F 0F 0F 0F 0F 0F	00+
    271	      00 00 00 00 00 00	00+
    272	      00 00 00
    273	0620  00 00 00 00 00 00	01+		     db	0,0,0,0,0,0,1,09H,09H,09H,09H,09H,09H,15,15,15,15,15,15,0,0,0,0,0
    274	      09 09 09 09 09 09	0F+
    275	      0F 0F 0F 0F 0F 00	00+
    276	      00 00 00
    277	0638  00 00 00 00 00 00	01+		     db	0,0,0,0,0,0,1,09H,09H,09H,09H,09H,09H,15,15,15,15,15,15,0,0,0,0,0
    278	      09 09 09 09 09 09	0F+
    279	      0F 0F 0F 0F 0F 00	00+
    280	      00 00 00
    281	0650  00 00 00 00 00 00	01+		     db	0,0,0,0,0,0,1,15,15,15,15,15,15,0,0,0,0,0,0,0,0,0,0,0
    282	      0F 0F 0F 0F 0F 0F	00+
    283	      00 00 00 00 00 00	00+
    284	      00 00 00
    285	0668  00 00 00 00 00 00	01+		     db	0,0,0,0,0,0,1,15,15,15,0AH,0AH,0,0,0,0,0,0,0,0,0,0,0,0
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 6
MAIN.ASM



    286	      0F 0F 0F 0A 0A 00	00+
    287	      00 00 00 00 00 00	00+
    288	      00 00 00
    289	0680  00 00 00 00 00 00	01+		     db	0,0,0,0,0,0,1,15,15,0AH,0AH,0AH,0,0,0,0,0,0,0,0,0,0,0,0
    290	      0F 0F 0A 0A 0A 00	00+
    291	      00 00 00 00 00 00	00+
    292	      00 00 00
    293	0698  00 00 00 00 00 0F	0F+		     db	0,0,0,0,0,15,15,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
    294	      0F 00 00 00 00 00	00+
    295	      00 00 00 00 00 00	00+
    296	      00 00 00
    297	06B0  00 00 00 00 00 00	00+		     db	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
    298	      00 00 00 00 00 00	00+
    299	      00 00 00 00 00 00	00+
    300	      00 00
    301	06C7  00 00 00 00 00 00	00+		     db	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
    302	      00 00 00 00 00 00	00+
    303	      00 00 00 00 00 00	00+
    304	      00 00 00
    305	06DF  00 00 00 00 00 00	00+		     db	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
    306	      00 00 00 00 00 00	00+
    307	      00 00 00 00 00 00	00+
    308	      00 00 00
    309	06F7  00 00 00 00 00 00	00+		     db	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
    310	      00 00 00 00 00 00	00+
    311	      00 00 00 00 00 00	00+
    312	      00 00 00
    313	070F  00 00 00 00 00 00	00+		     db	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
    314	      00 00 00 00 00 00	00+
    315	      00 00 00 00 00 00	00+
    316	      00 00 00
    317
    318					 ; Sprite do tiro (8x6 pixels) - horizontal
    319	0727  00 00 00 00 00 00		 shot_sprite db	0,0,0,0,0,0
    320	072D  00 00 00 00 00 00			     db	0,0,0,0,0,0
    321	0733  00 00 0F 0F 00 00			     db	0,0,15,15,0,0
    322	0739  00 00 0F 0F 00 00			     db	0,0,15,15,0,0
    323	073F  00 00 00 00 00 00			     db	0,0,0,0,0,0
    324	0745  00 00 00 00 00 00			     db	0,0,0,0,0,0
    325
    326	      =0064			 ROW_METEOR  EQU 100
    327	      =007D			 ROW_ALIEN   EQU 125
    328	      =004B			 ROW_SHIP    EQU 75
    329
    330					 ; Fase	3: Nave	mais alta, terreno mais	baixo
    331	      =0032			 ROW_SHIP_FASE3	   EQU 50      ; Nave na linha 50
    332	      =0096			 ROW_TERRAIN_FASE3 EQU 150     ; Terreno começa na linha 150
    333	      =0032			 ROW_ALIEN_FASE3   EQU 50      ; Aliens	mais acima (linhas 50-90)
    334
    335	      =7E2C			 meteor_pos_ini	EQU ROW_METEOR*320 + 300  ; posição inicial do meteoro (linha	100, x = 300)
    336	074B  7E2C			 meteor_pos dw meteor_pos_ini ;	posi??o	inicial	(linha 100, x =	300)
    337
    338	      =5DC0			 ship_pos_ini EQU ROW_SHIP*320
    339	074D  5DC0			 ship_pos dw ship_pos_ini ; posição inicial (linha 95, coluna	41)
    340	      =0005			 ship_speed EQU	5
    341
    342					 ; Sistema de tiro (3 tiros simultâneos)
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 7
MAIN.ASM



    343	074F  03			 shot_count db 3
    344	0750  0000 0000	0000		 shot_pos dw 0,	0, 0	   ; Posições	dos 3 tiros
    345	0756  00 00 00			 shot_active db	0, 0, 0	   ; Status dos	3 tiros	(0=inativo, 1=ativo)
    346
    347					 ; Sistema de aliens/meteoros (usa mesmo sistema para ambos)
    348	0759  05			 alien_count db	5
    349	075A  05*(0000)			 alien_array_pos dw 5 dup(0)  ;	Expandido para 5
    350	0764  05*(00)			 alien_array_active db 5 dup(0)	; Expandido para 5
    351	0769  0000			 alien_spawn_timer dw 0
    352	076B  003C			 alien_spawn_delay dw 60      ;	60 frames = ~1 segundo
    353	076D  0001			 alien_move_speed dw 1	      ;	Velocidade de movimento	aliens fase 1 (pixels por frame)
    354	076F  0001			 meteor_move_speed dw 1	      ;	Velocidade de movimento	meteoros fase 2	(pixels	por frame)
    355	0771  003C			 meteor_spawn_delay dw 60     ;	45 frames entre	spawns de meteoros
    356	0773  0003			 alien_fase3_move_speed	dw 3  ;	Velocidade maior para fase 3
    357	0775  002D			 alien_fase3_spawn_delay dw 45	; Spawn	mais rápido na	fase 3
    358
    359	      =0003			 LIFES_START EQU 3
    360	0777  03			 lives db LIFES_START  ; número de vidas
    361
    362	      =0140			 SCREEN_W    EQU 320
    363	      =00C8			 SCREEN_H    EQU 200
    364
    365	      =0018			 SPR_W	     EQU 24  ; para meteoro e alien
    366	      =0014			 SPR_H	     EQU 20
    367
    368	0778  07*(20) 20 5F 5F 5F +	 fase1	 db 7 dup(" ")," ___		      _	",13,10
    369	      20 20 20 20 20 20	20+
    370	      20 20 20 20 20 20	20+
    371	      20 20 20 20 5F 20	0D+
    372	      0A
    373	0799  07*(20) 7C 20 5F 5F +		 db 7 dup(" "),"| __|_ _ ___ ___     / |",13,10
    374	      7C 5F 20 5F 20 5F	5F+
    375	      5F 20 5F 5F 5F 20	20+
    376	      20 20 20 2F 20 7C	0D+
    377	      0A
    378	07BA  07*(20) 7C 20 5F 2F +		 db 7 dup(" "),"| _/ _`	(_-</ -_)    | |",13,10
    379	      20 5F 60 20 28 5F	2D+
    380	      3C 2F 20 2D 5F 29	20+
    381	      20 20 20 7C 20 7C	0D+
    382	      0A
    383	07DB  07*(20) 7C 5F 7C 5C +		 db 7 dup(" "),"|_|\__,_/__/\___|    |_|",13,10
    384	      5F 5F 2C 5F 2F 5F	5F+
    385	      2F 5C 5F 5F 5F 7C	20+
    386	      20 20 20 7C 5F 7C	0D+
    387	      0A
    388	07FC  07*(20) 20 20 20 20 +		 db 7 dup(" "),"			",13,10
    389	      20 20 20 20 20 20	20+
    390	      20 20 20 20 20 20	20+
    391	      20 20 20 20 20 20	0D+
    392	      0A
    393	081D  07*(20) 20 20 20 20 +		 db 7 dup(" "),"			",13,10
    394	      20 20 20 20 20 20	20+
    395	      20 20 20 20 20 20	20+
    396	      20 20 20 20 20 20	0D+
    397	      0A
    398
    399	083E  07*(20) 20 5F 5F 5F +	 fase2	 db 7 dup(" ")," ___		    ___	",13,10
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 8
MAIN.ASM



    400	      20 20 20 20 20 20	20+
    401	      20 20 20 20 20 20	20+
    402	      20 20 5F 5F 5F 20	0D+
    403	      0A
    404	085F  07*(20) 7C 20 5F 5F +		 db 7 dup(" "),"| __|_ _ ___ ___   |_  )",13,10
    405	      7C 5F 20 5F 20 5F	5F+
    406	      5F 20 5F 5F 5F 20	20+
    407	      20 7C 5F 20 20 29	0D+
    408	      0A
    409	0880  07*(20) 7C 20 5F 2F +		 db 7 dup(" "),"| _/ _`	(_-</ -_)   / /	",13,10
    410	      20 5F 60 20 28 5F	2D+
    411	      3C 2F 20 2D 5F 29	20+
    412	      20 20 2F 20 2F 20	0D+
    413	      0A
    414	08A1  07*(20) 7C 5F 7C 5C +		 db 7 dup(" "),"|_|\__,_/__/\___|  /___|",13,10
    415	      5F 5F 2C 5F 2F 5F	5F+
    416	      2F 5C 5F 5F 5F 7C	20+
    417	      20 2F 5F 5F 5F 7C	0D+
    418	      0A
    419	08C2  07*(20) 20 20 20 20 +		 db 7 dup(" "),"			",13,10
    420	      20 20 20 20 20 20	20+
    421	      20 20 20 20 20 20	20+
    422	      20 20 20 20 20 20	0D+
    423	      0A
    424	08E3  07*(20) 20 20 20 20 +		 db 7 dup(" "),"			",13,10
    425	      20 20 20 20 20 20	20+
    426	      20 20 20 20 20 20	20+
    427	      20 20 20 20 20 20	0D+
    428	      0A
    429
    430	0904  07*(20) 20 5F 5F 5F +	 fase3	 db 7 dup(" ")," ___		    ____",13,10
    431	      20 20 20 20 20 20	20+
    432	      20 20 20 20 20 20	20+
    433	      20 20 5F 5F 5F 5F	0D+
    434	      0A
    435	0925  07*(20) 7C 20 5F 5F +		 db 7 dup(" "),"| __|_ _ ___ ___   |__ /",13,10
    436	      7C 5F 20 5F 20 5F	5F+
    437	      5F 20 5F 5F 5F 20	20+
    438	      20 7C 5F 5F 20 2F	0D+
    439	      0A
    440	0946  07*(20) 7C 20 5F 2F +		 db 7 dup(" "),"| _/ _`	(_-</ -_)   |_ \",13,10
    441	      20 5F 60 20 28 5F	2D+
    442	      3C 2F 20 2D 5F 29	20+
    443	      20 20 7C 5F 20 5C	0D+
    444	      0A
    445	0967  07*(20) 7C 5F 7C 5C +		 db 7 dup(" "),"|_|\__,_/__/\___|  |___/",13,10
    446	      5F 5F 2C 5F 2F 5F	5F+
    447	      2F 5C 5F 5F 5F 7C	20+
    448	      20 7C 5F 5F 5F 2F	0D+
    449	      0A
    450	0988  07*(20) 20 20 20 20 +		 db 7 dup(" "),"			",13,10
    451	      20 20 20 20 20 20	20+
    452	      20 20 20 20 20 20	20+
    453	      20 20 20 20 20 20	0D+
    454	      0A
    455	09A9  07*(20) 20 20 20 20 +		 db 7 dup(" "),"			",13,10
    456	      20 20 20 20 20 20	20+
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 9
MAIN.ASM



    457	      20 20 20 20 20 20	20+
    458	      20 20 20 20 20 20	0D+
    459	      0A
    460
    461	      =00C6			 fase_string_length equ	$-fase3
    462
    463	09CA  0778r 083Er 0904r		 fase_vec dw offset fase1, offset fase2, offset	fase3
    464
    465					 ; ASCII art para Game Over
    466	09D0  05*(20) 20 20 20 20 +	 game_over_msg	 db 5 dup(" "),"			  ",13,10
    467	      20 20 20 20 20 20	20+
    468	      20 20 20 20 20 20	20+
    469	      20 20 20 20 20 20	20+
    470	      20 0D 0A
    471	09F1  05*(20) 20 20 20 5F +			 db 5 dup(" "),"   ___	 _   __	 __ ___	 ",13,10
    472	      5F 5F 20 20 20 5F	20+
    473	      20 20 5F 5F 20 20	5F+
    474	      5F 20 5F 5F 5F 20	20+
    475	      0D 0A
    476	0A11  05*(20) 20 20 2F 20 +			 db 5 dup(" "),"  / __|	/_\ |  \/  | __| ",13,10
    477	      5F 5F 7C 20 2F 5F	5C+
    478	      20 7C 20 20 5C 2F	20+
    479	      20 7C 20 5F 5F 7C	20+
    480	      0D 0A
    481	0A31  05*(20) 20 7C 20 28 +			 db 5 dup(" ")," | (_ |/ _ \| |\/| | _|	 ",13,10
    482	      5F 20 7C 2F 20 5F	20+
    483	      5C 7C 20 7C 5C 2F	7C+
    484	      20 7C 20 5F 7C 20	20+
    485	      0D 0A
    486	0A51  05*(20) 20 20 5C 5F +			 db 5 dup(" "),"  \___/_/ \_\_|_ |_|___| ",13,10
    487	      5F 5F 2F 5F 2F 20	5C+
    488	      5F 5C 5F 7C 5F 20	7C+
    489	      5F 7C 5F 5F 5F 7C	20+
    490	      0D 0A
    491	0A71  05*(20) 20 20 2F 20 +			 db 5 dup(" "),"  / _ \	\ / / __| _ \	 ",13,10
    492	      5F 20 5C 20 5C 20	2F+
    493	      20 2F 20 5F 5F 7C	20+
    494	      5F 20 5C 20 20 20	20+
    495	      0D 0A
    496	0A91  05*(20) 20 7C 20 28 +			 db 5 dup(" ")," | (_) \ V /| _||   /	 ",13,10
    497	      5F 29 20 5C 20 56	20+
    498	      2F 7C 20 5F 7C 7C	20+
    499	      20 20 2F 20 20 20	20+
    500	      0D 0A
    501	0AB1  05*(20) 20 20 5C 5F +			 db 5 dup(" "),"  \___/	\_/ |___|_|_\	 ",13,10
    502	      5F 5F 2F 20 5C 5F	2F+
    503	      20 7C 5F 5F 5F 7C	5F+
    504	      7C 5F 5C 20 20 20	20+
    505	      0D 0A
    506	0AD1  05*(20) 20 20 20 20 +			 db 5 dup(" "),"			  ",13,10
    507	      20 20 20 20 20 20	20+
    508	      20 20 20 20 20 20	20+
    509	      20 20 20 20 20 20	20+
    510	      20 0D 0A
    511
    512	      =0122			 game_over_msg_length equ $-game_over_msg
    513
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 10
MAIN.ASM



    514					 ; ASCII art para Vencedor
    515	0AF2  02*(20) 20 20 20 20 +	 vencedor_msg	 db 2 dup(" "),"				    ",13,10
    516	      20 20 20 20 20 20	20+
    517	      20 20 20 20 20 20	20+
    518	      20 20 20 20 20 20	20+
    519	      20 20 20 20 20 20	20+
    520	      20 20 20 20 0D 0A
    521	0B1A  02*(20) 20 5F 5F 20 +			 db 2 dup(" ")," __   __		  _	    ",13,10
    522	      20 20 5F 5F 20 20	20+
    523	      20 20 20 20 20 20	20+
    524	      20 20 20 20 20 20	20+
    525	      20 5F 20 20 20 20	20+
    526	      20 20 20 20 0D 0A
    527	0B42  02*(20) 20 5C 20 5C +			 db 2 dup(" ")," \ \ / /__ _ _	__ ___ __| |___	_ _ ",13,10
    528	      20 2F 20 2F 5F 5F	20+
    529	      5F 20 5F 20 20 5F	5F+
    530	      20 5F 5F 5F 20 5F	5F+
    531	      7C 20 7C 5F 5F 5F	20+
    532	      5F 20 5F 20 0D 0A
    533	0B6A  02*(20) 20 20 5C 20 +			 db 2 dup(" "),"  \ V /	-_) ' \/ _/ -_)	_` / _ \ '_|",13,10
    534	      56 20 2F 20 2D 5F	29+
    535	      20 27 20 5C 2F 20	5F+
    536	      2F 20 2D 5F 29 20	5F+
    537	      60 20 2F 20 5F 20	5C+
    538	      20 27 5F 7C 0D 0A
    539	0B92  02*(20) 20 20 20 5C +			 db 2 dup(" "),"   \_/\___|_||_\__\___\__,_\___/_|  ",13,10
    540	      5F 2F 5C 5F 5F 5F	7C+
    541	      5F 7C 7C 5F 5C 5F	5F+
    542	      5C 5F 5F 5F 5C 5F	5F+
    543	      2C 5F 5C 5F 5F 5F	2F+
    544	      5F 7C 20 20 0D 0A
    545	0BBA  02*(20) 20 20 20 20 +			 db 2 dup(" "),"				    ",13,10
    546	      20 20 20 20 20 20	20+
    547	      20 20 20 20 20 20	20+
    548	      20 20 20 20 20 20	20+
    549	      20 20 20 20 20 20	20+
    550	      20 20 20 20 0D 0A
    551
    552	      =00F0			 vencedor_msg_length equ $-vencedor_msg
    553
    554
    555					 ; Mensagem para pressionar tecla
    556	0BE2  50 72 65 73 73 69	6F+	 press_key_msg db "Pressione qualquer tecla",13,10,0
    557	      6E 65 20 71 75 61	6C+
    558	      71 75 65 72 20 74	65+
    559	      63 6C 61 0D 0A 00
    560	      =001B			 press_key_msg_length equ $-press_key_msg
    561
    562					 ; Mensagem de score final
    563	0BFD  53 43 4F 52 45 20	46+	 final_score_msg db "SCORE FINAL: ",0
    564	      49 4E 41 4C 3A 20	00
    565	      =000E			 final_score_msg_length	equ $-final_score_msg
    566
    567	      =003C			 SECONDS_START	EQU 60
    568
    569	0C0B  3C			 time db SECONDS_START
    570	0C0C  00			 timeout db 0
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 11
MAIN.ASM



    571	0C0D  30 30			 time_buffer db	'00'
    572	      =0002			 time_buffer_len equ $-time_buffer
    573
    574
    575	0C0F  54 45 4D 50 4F 3A		 time_str db "TEMPO:"
    576	      =0006			 time_str_len equ $-time_str
    577
    578	0C15  0000			 score dw 0
    579	0C17  30 30 30 30 30		 score_buffer db '00000'
    580	      =0005			 score_buffer_len equ $-score_buffer
    581
    582	0C1C  53 43 4F 52 45 3A		 score_str db "SCORE:"
    583	      =0006			 score_str_len equ $-score_str
    584
    585					 ; Terreno da fase 1
    586	0C22  0140*(00)			 terrain_fase1 db 320 dup(0)
    587	0D62  0140*(00)			     db	320 dup(0)
    588	0EA2  A8*(00) 03*(06) 95* +	     db	168 dup(0),3 dup (6),149 dup(0)
    589	      (00)
    590	0FE2  A6*(00) 06*(06) 94* +	     db	166 dup(0),6 dup (6),148 dup(0)
    591	      (00)
    592	1122  22*(00) 04*(06) 07* +	     db	34 dup(0),4 dup	(6),7 dup(0),6 dup (6),63 dup(0),2 dup (6),25 dup(0),6 dup (6),18   +
    593	      (00) 06*(06) 3F*(00)+  dup(0),8 dup (6),87 dup(0),9 dup (6),51 dup(0)
    594	      02*(06) 19*(00) 06* +
    595	      (06) 12*(00) 08*(06)+
    596	      57*(00) 09*(06) 33* +
    597	      (00)
    598	1262  21*(00) 06*(06) 05* +	     db	33 dup(0),6 dup	(6),5 dup(0),9 dup (6),37 dup(0),9 dup (6),12 dup(0),7 dup (6),20   +
    599	      (00) 09*(06) 25*(00)+  dup(0),10 dup (6),17 dup(0),9 dup (6),15 dup(0),5 dup (6),40 dup(0),5 dup (6),19 dup(0),11	dup +
    600	      09*(06) 0C*(00) 07* +  (6),15 dup(0),4 dup (6),32	dup(0)
    601	      (06) 14*(00) 0A*(06)+
    602	      11*(00) 09*(06) 0F* +
    603	      (00) 05*(06) 28*(00)+
    604	      05*(06) 13*(00) 0B* +
    605	      (06) 0F*(00) 04*(06)+
    606	      20*(00)
    607	13A2  0C*(00) 04*(06) 10* +	     db	12 dup(0),4 dup	(6),16 dup(0),7	dup (6),4 dup(0),11 dup	(6),17 dup(0),3	dup (6),15  +
    608	      (00) 07*(06) 04*(00)+  dup(0),11 dup (6),10 dup(0),10 dup	(6),15 dup(0),14 dup (6),15 dup(0),11 dup (6),13 dup(0),7   +
    609	      0B*(06) 11*(00) 03* +  dup (6),8 dup(0),6	dup (6),23 dup(0),9 dup	(6),15 dup(0),15 dup (6),12 dup(0),7 dup (6),30	dup +
    610	      (06) 0F*(00) 0B*(06)+  (0)
    611	      0A*(00) 0A*(06) 0F* +
    612	      (00) 0E*(06) 0F*(00)+
    613	      0B*(06) 0D*(00) 07* +
    614	      (06) 08*(00) 06*(06)+
    615	      17*(00) 09*(06) 0F* +
    616	      (00) 0F*(06) 0C*(00)+
    617	      07*(06) 1E*(00)
    618	14E2  0B*(00) 07*(06) 0E* +	     db	11 dup(0),7 dup	(6),14 dup(0),23 dup (6),16 dup(0),3 dup (6),15	dup(0),11 dup (6),9 +
    619	      (00) 17*(06) 10*(00)+  dup(0),11 dup (6),13 dup(0),17 dup	(6),14 dup(0),12 dup (6),11 dup(0),9 dup (6),5 dup(0),9	dup +
    620	      03*(06) 0F*(00) 0B* +  (6),20 dup(0),12 dup (6),13 dup(0),17 dup (6),10 dup(0),9 dup (6),29 dup(0)
    621	      (06) 09*(00) 0B*(06)+
    622	      0D*(00) 11*(06) 0E* +
    623	      (00) 0C*(06) 0B*(00)+
    624	      09*(06) 05*(00) 09* +
    625	      (06) 14*(00) 0C*(06)+
    626	      0D*(00) 11*(06) 0A* +
    627	      (00) 09*(06) 1D*(00)
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 12
MAIN.ASM



    628	1622  01*(06) 09*(00) 0A* +	     db	1 dup (6),9 dup(0),10 dup (6),10 dup(0),26 dup (6),15 dup(0),5 dup (6),12 dup(0),34 +
    629	      (06) 0A*(00) 1A*(06)+  dup (6),8 dup(0),21 dup (6),12 dup(0),14 dup (6),9	dup(0),11 dup (6),2 dup(0),13 dup (6),16 dup+
    630	      0F*(00) 05*(06) 0C* +  (0),17 dup	(6),8 dup(0),20	dup (6),8 dup(0),11 dup	(6),8 dup(0),3 dup (6),8 dup(0),6 dup (6),2 +
    631	      (00) 22*(06) 08*(00)+  dup(0),1 dup (6)
    632	      15*(06) 0C*(00) 0E* +
    633	      (06) 09*(00) 0B*(06)+
    634	      02*(00) 0D*(06) 10* +
    635	      (00) 11*(06) 08*(00)+
    636	      14*(06) 08*(00) 0B* +
    637	      (06) 08*(00) 03*(06)+
    638	      08*(00) 06*(06) 02* +
    639	      (00) 01*(06)
    640	1762  02*(06) 07*(00) 0C* +	     db	2 dup (6),7 dup(0),12 dup (6),8	dup(0),31 dup (6),10 dup(0),6 dup (6),10 dup(0),65  +
    641	      (06) 08*(00) 1F*(06)+  dup (6),11	dup(0),17 dup (6),7 dup(0),28 dup (6),12 dup(0),49 dup (6),5 dup(0),13 dup (6),5 dup+
    642	      0A*(00) 06*(06) 0A* +  (0),7 dup (6),4 dup(0),11 dup (6)
    643	      (00) 41*(06) 0B*(00)+
    644	      11*(06) 07*(00) 1C* +
    645	      (06) 0C*(00) 31*(06)+
    646	      05*(00) 0D*(06) 05* +
    647	      (00) 07*(06) 04*(00)+
    648	      0B*(06)
    649	18A2  03*(06) 05*(00) 0E* +	     db	3 dup (6),5 dup(0),14 dup (6),4	dup(0),36 dup (6),6 dup(0),10 dup (6),6	dup(0),68   +
    650	      (06) 04*(00) 24*(06)+  dup (6),9 dup(0),19 dup (6),5 dup(0),109 dup (6),3	dup(0),8 dup (6),3 dup(0),12 dup (6)
    651	      06*(00) 0A*(06) 06* +
    652	      (00) 44*(06) 09*(00)+
    653	      13*(06) 05*(00) 6D* +
    654	      (06) 03*(00) 08*(06)+
    655	      03*(00) 0C*(06)
    656	19E2  3F*(06) 04*(00) 0B* +	     db	63 dup (6),4 dup(0),11 dup (6),4 dup(0),71 dup (6),7 dup(0),23 dup (6),1 dup(0),122 +
    657	      (06) 04*(00) 47*(06)+  dup (6),1 dup(0),13 dup (6)
    658	      07*(00) 17*(06) 01* +
    659	      (00) 7A*(06) 01*(00)+
    660	      0D*(06)
    661	1B22  0140*(06)			     db	320 dup	(6)
    662	1C62  0140*(06)			     db	320 dup	(6)
    663	1DA2  0140*(06)			     db	320 dup	(6)
    664	1EE2  19*(06) 03*(05) 16* +	     db	25 dup(6),3 dup(05H),22	dup(6),2 dup(0DH),28 dup(6),4 dup(05H),24 dup(6),3 dup(0DH),+
    665	      (06) 02*(0D) 1C*(06)+  26	dup(6),2 dup(05H),30 dup(6),4 dup(0DH),23 dup(6),3 dup(05H),27 dup(6),2	dup(0DH),25 dup(6),4+
    666	      04*(05) 18*(06) 03* +  dup(05H),20 dup(6)
    667	      (0D) 1A*(06) 02*(05)+
    668	      1E*(06) 04*(0D) 17* +
    669	      (06) 03*(05) 1B*(06)+
    670	      02*(0D) 19*(06) 04* +
    671	      (05) 14*(06)
    672	1FF7  12*(06) 06*(0D) 10* +	     db	18 dup(6),6 dup(0DH),16	dup(6),8 dup(05H),20 dup(6),7 dup(0DH),18 dup(6),9 dup(05H),+
    673	      (06) 08*(05) 14*(06)+  22	dup(6),8 dup(0DH),19 dup(6),7 dup(05H),21 dup(6),10 dup(0DH),17	dup(6),9 dup(05H),20 dup(6),+
    674	      07*(0D) 12*(06) 09* +  8 dup(0DH),18 dup(6)
    675	      (05) 16*(06) 08*(0D)+
    676	      13*(06) 07*(05) 15* +
    677	      (06) 0A*(0D) 11*(06)+
    678	      09*(05) 14*(06) 08* +
    679	      (0D) 12*(06)
    680	20FC  0C*(06) 0C*(05) 0E* +	     db	12 dup(6),12 dup(05H),14 dup(6),14 dup(0DH),16 dup(6),11 dup(05H),15 dup(6),13 dup  +
    681	      (06) 0E*(0D) 10*(06)+  (0DH),18 dup(6),12	dup(05H),16 dup(6),14 dup(0DH),17 dup(6),15 dup(05H),14	dup(6),13 dup(0DH), +
    682	      0B*(05) 0F*(06) 0D* +  15	dup(6),12 dup(05H),13 dup(6)
    683	      (0D) 12*(06) 0C*(05)+
    684	      10*(06) 0E*(0D) 11* +
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 13
MAIN.ASM



    685	      (06) 0F*(05) 0E*(06)+
    686	      0D*(0D) 0F*(06) 0C* +
    687	      (05) 0D*(06)
    688	2206  08*(06) 12*(0D) 0A* +	     db	8 dup(6),18 dup(0DH),10	dup(6),20 dup(05H),12 dup(6),17	dup(0DH),11 dup(6),19 dup   +
    689	      (06) 14*(05) 0C*(06)+  (05H),14 dup(6),18	dup(0DH),13 dup(6),20 dup(05H),12 dup(6),19 dup(0DH),11	dup(6),18 dup(05H), +
    690	      11*(0D) 0B*(06) 13* +  10	dup(6),17 dup(0DH),9 dup(6)
    691	      (05) 0E*(06) 12*(0D)+
    692	      0D*(06) 14*(05) 0C* +
    693	      (06) 13*(0D) 0B*(06)+
    694	      12*(05) 0A*(06) 11* +
    695	      (0D) 09*(06)
    696	231A  04*(06) 19*(05) 06* +	     db	4 dup(6),25 dup(05H),6 dup(6),28 dup(0DH),8 dup(6),24 dup(05H),7 dup(6),26 dup(0DH),+
    697	      (06) 1C*(0D) 08*(06)+  9 dup(6),25 dup(05H),8 dup(6),27 dup(0DH),7 dup(6),26 dup(05H),6 dup(6),24	dup(0DH),5 dup(6)
    698	      18*(05) 07*(06) 1A* +
    699	      (0D) 09*(06) 19*(05)+
    700	      08*(06) 1B*(0D) 07* +
    701	      (06) 1A*(05) 06*(06)+
    702	      18*(0D) 05*(06)
    703	2423  0140*(05)			     db	320 dup	(05H)
    704	2563  0140*(0D)			     db	320 dup	(0DH)
    705	26A3  0140*(05)			     db	320 dup	(05H)
    706	27E3  0140*(0D)			     db	320 dup	(0DH)
    707	2923  0140*(05)			     db	320 dup	(05H)
    708	2A63  0140*(0D)			     db	320 dup	(0DH)
    709	2BA3  0140*(05)			     db	320 dup	(05H)
    710	2CE3  0140*(0D)			     db	320 dup	(0DH)
    711	2E23  0140*(05)			     db	320 dup	(05H)
    712	2F63  0140*(0D)			     db	320 dup	(0DH)
    713	30A3  0140*(05)			     db	320 dup	(05H)
    714	31E3  0140*(0D)			     db	320 dup	(0DH)
    715	3323  0140*(05)			     db	320 dup	(05H)
    716	3463  0140*(0D)			     db	320 dup	(0DH)
    717	35A3  0140*(05)			     db	320 dup	(05H)
    718	36E3  0140*(0D)			     db	320 dup	(0DH)
    719	3823  0140*(05)			     db	320 dup	(05H)
    720	3963  0140*(0D)			     db	320 dup	(0DH)
    721	3AA3  0140*(05)			     db	320 dup	(05H)
    722	3BE3  0140*(0D)			     db	320 dup	(0DH)
    723	3D23  0140*(05)			     db	320 dup	(05H)
    724	3E63  0140*(0D)			     db	320 dup	(0DH)
    725	3FA3  0140*(05)			     db	320 dup	(05H)
    726	40E3  0140*(0D)			     db	320 dup	(0DH)
    727	4223  0140*(05)			     db	320 dup	(05H)
    728	4363  0140*(0D)			     db	320 dup	(0DH)
    729	44A3  0140*(05)			     db	320 dup	(05H)
    730	45E3  0140*(0D)			     db	320 dup	(0DH)
    731	4723  0140*(05)			     db	320 dup	(05H)
    732	4863  0140*(0D)			     db	320 dup	(0DH)
    733	49A3  0140*(05)			     db	320 dup	(05H)
    734	4AE3  0140*(0D)			     db	320 dup	(0DH)
    735	4C23  0140*(05)			     db	320 dup	(05H)
    736	4D63  0140*(0D)			     db	320 dup	(0DH)
    737	4EA3  0140*(05)			     db	320 dup	(05H)
    738	4FE3  0140*(0D)			     db	320 dup	(0DH)
    739	5123  0140*(05)			     db	320 dup	(05H)
    740	5263  0140*(0D)			     db	320 dup	(0DH)
    741	53A3  0140*(05)			     db	320 dup	(05H)
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 14
MAIN.ASM



    742	54E3  0140*(0D)			     db	320 dup	(0DH)
    743	5623  0140*(05)			     db	320 dup	(05H)
    744	5763  0140*(0D)			     db	320 dup	(0DH)
    745	58A3  0140*(05)			     db	320 dup	(05H)
    746	59E3  0140*(0D)			     db	320 dup	(0DH)
    747	5B23  0140*(05)			     db	320 dup	(05H)
    748	5C63  0140*(0D)			     db	320 dup	(0DH)
    749	5DA3  0140*(05)			     db	320 dup	(05H)
    750	5EE3  0140*(0D)			     db	320 dup	(0DH)
    751	6023  0140*(05)			     db	320 dup	(05H)
    752	6163  0140*(0D)			     db	320 dup	(0DH)
    753	62A3  0140*(05)			     db	320 dup	(05H)
    754	63E3  0140*(0D)			     db	320 dup	(0DH)
    755	6523  0140*(05)			     db	320 dup	(05H)
    756	6663  0140*(0D)			     db	320 dup	(0DH)
    757	67A3  0140*(05)			     db	320 dup	(05H)
    758	68E3  0140*(0D)			     db	320 dup	(0DH)
    759	6A23  0140*(05)			     db	320 dup	(05H)
    760
    761					 ; Terreno da fase 2 - mais desafiador com mais	obstáculos
    762	6B63  0140*(00)			 terrain_fase2 db 320 dup(0)
    763	6CA3  0140*(00)			     db	320 dup(0)
    764	6DE3  78*(00) 08*(04) C0* +	     db	120 dup(0),8 dup (4),192 dup(0)
    765	      (00)
    766	6F23  73*(00) 0C*(04) C1* +	     db	115 dup(0),12 dup (4),193 dup(0)
    767	      (00)
    768	7063  32*(00) 06*(04) 0A* +	     db	50 dup(0),6 dup	(4),10 dup(0),8	dup (4),90 dup(0),4 dup	(4),30 dup(0),8	dup (4),100 +
    769	      (00) 08*(04) 5A*(00)+  dup(0),4 dup (4),24 dup(0)
    770	      04*(04) 1E*(00) 08* +
    771	      (04) 64*(00) 04*(04)+
    772	      18*(00)
    773	71B1  2D*(00) 08*(04) 08* +	     db	45 dup(0),8 dup	(4),8 dup(0),12	dup (4),80 dup(0),6 dup	(4),25 dup(0),12 dup (4),95 +
    774	      (00) 0C*(04) 50*(00)+  dup(0),6 dup (4),23 dup(0)
    775	      06*(04) 19*(00) 0C* +
    776	      (04) 5F*(00) 06*(04)+
    777	      17*(00)
    778	72F1  28*(00) 0A*(04) 0F* +	     db	40 dup(0),10 dup (4),15	dup(0),8 dup (4),70 dup(0),8 dup (4),20	dup(0),15 dup (4),85+
    779	      (00) 08*(04) 46*(00)+  dup(0),8 dup (4),21 dup(0)
    780	      08*(04) 14*(00) 0F* +
    781	      (04) 55*(00) 08*(04)+
    782	      15*(00)
    783	741D  23*(00) 0C*(04) 0C* +	     db	35 dup(0),12 dup (4),12	dup(0),10 dup (4),60 dup(0),10 dup (4),18 dup(0),18 dup	(4),+
    784	      (00) 0A*(04) 3C*(00)+  75	dup(0),10 dup (4),20 dup(0)
    785	      0A*(04) 12*(00) 12* +
    786	      (04) 4B*(00) 0A*(04)+
    787	      14*(00)
    788	7535  1E*(00) 0F*(04) 0A* +	     db	30 dup(0),15 dup (4),10	dup(0),12 dup (4),50 dup(0),12 dup (4),15 dup(0),20 dup	(4),+
    789	      (00) 0C*(04) 32*(00)+  65	dup(0),12 dup (4),19 dup(0)
    790	      0C*(04) 0F*(00) 14* +
    791	      (04) 41*(00) 0C*(04)+
    792	      13*(00)
    793	7639  19*(00) 12*(04) 08* +	     db	25 dup(0),18 dup (4),8 dup(0),15 dup (4),40 dup(0),15 dup (4),12 dup(0),25 dup (4), +
    794	      (00) 0F*(04) 28*(00)+  55	dup(0),15 dup (4),17 dup(0)
    795	      0F*(04) 0C*(00) 19* +
    796	      (04) 37*(00) 0F*(04)+
    797	      11*(00)
    798	772E  14*(00) 14*(04) 06* +	     db	20 dup(0),20 dup (4),6 dup(0),18 dup (4),30 dup(0),18 dup (4),10 dup(0),30 dup (4), +
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 15
MAIN.ASM



    799	      (00) 12*(04) 1E*(00)+  45	dup(0),18 dup (4),15 dup(0)
    800	      12*(04) 0A*(00) 1E* +
    801	      (04) 2D*(00) 12*(04)+
    802	      0F*(00)
    803	7814  14*(00) 14*(04) 06* +	     db	20 dup(0),20 dup (4),6 dup(0),18 dup (4),30 dup(0),18 dup (4),10 dup(0),30 dup (4), +
    804	      (00) 12*(04) 1E*(00)+  45	dup(0),18 dup (4),15 dup(0)
    805	      12*(04) 0A*(00) 1E* +
    806	      (04) 2D*(00) 12*(04)+
    807	      0F*(00)
    808	78FA  14*(00) 14*(04) 06* +	     db	20 dup(0),20 dup (4),6 dup(0),18 dup (4),30 dup(0),18 dup (4),10 dup(0),30 dup (4), +
    809	      (00) 12*(04) 1E*(00)+  45	dup(0),18 dup (4),15 dup(0)
    810	      12*(04) 0A*(00) 1E* +
    811	      (04) 2D*(00) 12*(04)+
    812	      0F*(00)
    813	79E0  14*(00) 14*(04) 06* +	     db	20 dup(0),20 dup (4),6 dup(0),18 dup (4),30 dup(0),18 dup (4),10 dup(0),30 dup (4), +
    814	      (00) 12*(04) 1E*(00)+  45	dup(0),18 dup (4),15 dup(0)
    815	      12*(04) 0A*(00) 1E* +
    816	      (04) 2D*(00) 12*(04)+
    817	      0F*(00)
    818	7AC6  14*(00) 14*(04) 06* +	     db	20 dup(0),20 dup (4),6 dup(0),18 dup (4),30 dup(0),18 dup (4),10 dup(0),30 dup (4), +
    819	      (00) 12*(04) 1E*(00)+  45	dup(0),18 dup (4),15 dup(0)
    820	      12*(04) 0A*(00) 1E* +
    821	      (04) 2D*(00) 12*(04)+
    822	      0F*(00)
    823	7BAC  14*(00) 14*(04) 06* +	     db	20 dup(0),20 dup (4),6 dup(0),18 dup (4),30 dup(0),18 dup (4),10 dup(0),30 dup (4), +
    824	      (00) 12*(04) 1E*(00)+  45	dup(0),18 dup (4),15 dup(0)
    825	      12*(04) 0A*(00) 1E* +
    826	      (04) 2D*(00) 12*(04)+
    827	      0F*(00)
    828	7C92  0F*(00) 19*(04) 04* +	     db	15 dup(0),25 dup (4),4 dup(0),20 dup (4),20 dup(0),20 dup (4),8	dup(0),35 dup (4),35+
    829	      (00) 14*(04) 14*(00)+  dup(0),20 dup (4),13 dup(0)
    830	      14*(04) 08*(00) 23* +
    831	      (04) 23*(00) 14*(04)+
    832	      0D*(00)
    833	7D69  0F*(00) 19*(04) 04* +	     db	15 dup(0),25 dup (4),4 dup(0),20 dup (4),20 dup(0),20 dup (4),8	dup(0),35 dup (4),35+
    834	      (00) 14*(04) 14*(00)+  dup(0),20 dup (4),13 dup(0)
    835	      14*(04) 08*(00) 23* +
    836	      (04) 23*(00) 14*(04)+
    837	      0D*(00)
    838	7E40  0F*(00) 19*(04) 04* +	     db	15 dup(0),25 dup (4),4 dup(0),20 dup (4),20 dup(0),20 dup (4),8	dup(0),35 dup (4),35+
    839	      (00) 14*(04) 14*(00)+  dup(0),20 dup (4),13 dup(0)
    840	      14*(04) 08*(00) 23* +
    841	      (04) 23*(00) 14*(04)+
    842	      0D*(00)
    843	7F17  0F*(00) 19*(04) 04* +	     db	15 dup(0),25 dup (4),4 dup(0),20 dup (4),20 dup(0),20 dup (4),8	dup(0),35 dup (4),35+
    844	      (00) 14*(04) 14*(00)+  dup(0),20 dup (4),13 dup(0)
    845	      14*(04) 08*(00) 23* +
    846	      (04) 23*(00) 14*(04)+
    847	      0D*(00)
    848	7FEE  0F*(00) 19*(04) 04* +	     db	15 dup(0),25 dup (4),4 dup(0),20 dup (4),20 dup(0),20 dup (4),8	dup(0),35 dup (4),35+
    849	      (00) 14*(04) 14*(00)+  dup(0),20 dup (4),13 dup(0)
    850	      14*(04) 08*(00) 23* +
    851	      (04) 23*(00) 14*(04)+
    852	      0D*(00)
    853	80C5  0F*(00) 19*(04) 04* +	     db	15 dup(0),25 dup (4),4 dup(0),20 dup (4),20 dup(0),20 dup (4),8	dup(0),35 dup (4),35+
    854	      (00) 14*(04) 14*(00)+  dup(0),20 dup (4),13 dup(0)
    855	      14*(04) 08*(00) 23* +
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 16
MAIN.ASM



    856	      (04) 23*(00) 14*(04)+
    857	      0D*(00)
    858	819C  0140*(04)			     db	320 dup	(4)
    859	82DC  0140*(04)			     db	320 dup	(4)
    860	841C  0140*(04)			     db	320 dup	(4)
    861	855C  1E*(04) 04*(0C) 19* +	     db	30 dup(4),4 dup(0CH),25	dup(4),3 dup(02H),35 dup(4),5 dup(0CH),30 dup(4),4 dup(02H),+
    862	      (04) 03*(02) 23*(04)+  32	dup(4),3 dup(0CH),35 dup(4),5 dup(02H),28 dup(4),4 dup(0CH),30 dup(4)
    863	      05*(0C) 1E*(04) 04* +
    864	      (02) 20*(04) 03*(0C)+
    865	      23*(04) 05*(02) 1C* +
    866	      (04) 04*(0C) 1E*(04)
    867	866D  1E*(04) 04*(0C) 19* +	     db	30 dup(4),4 dup(0CH),25	dup(4),3 dup(02H),35 dup(4),5 dup(0CH),30 dup(4),4 dup(02H),+
    868	      (04) 03*(02) 23*(04)+  32	dup(4),3 dup(0CH),35 dup(4),5 dup(02H),28 dup(4),4 dup(0CH),30 dup(4)
    869	      05*(0C) 1E*(04) 04* +
    870	      (02) 20*(04) 03*(0C)+
    871	      23*(04) 05*(02) 1C* +
    872	      (04) 04*(0C) 1E*(04)
    873	877E  1E*(04) 04*(0C) 19* +	     db	30 dup(4),4 dup(0CH),25	dup(4),3 dup(02H),35 dup(4),5 dup(0CH),30 dup(4),4 dup(02H),+
    874	      (04) 03*(02) 23*(04)+  32	dup(4),3 dup(0CH),35 dup(4),5 dup(02H),28 dup(4),4 dup(0CH),30 dup(4)
    875	      05*(0C) 1E*(04) 04* +
    876	      (02) 20*(04) 03*(0C)+
    877	      23*(04) 05*(02) 1C* +
    878	      (04) 04*(0C) 1E*(04)
    879	888F  19*(04) 07*(02) 14* +	     db	25 dup(4),7 dup(02H),20	dup(4),9 dup(0CH),25 dup(4),8 dup(02H),22 dup(4),10 dup	    +
    880	      (04) 09*(0C) 19*(04)+  (0CH),27 dup(4),9 dup(02H),25 dup(4),11 dup(0CH),20 dup(4),10 dup(02H),23 dup(4)
    881	      08*(02) 16*(04) 0A* +
    882	      (0C) 1B*(04) 09*(02)+
    883	      19*(04) 0B*(0C) 14* +
    884	      (04) 0A*(02) 17*(04)
    885	898A  19*(04) 07*(02) 14* +	     db	25 dup(4),7 dup(02H),20	dup(4),9 dup(0CH),25 dup(4),8 dup(02H),22 dup(4),10 dup	    +
    886	      (04) 09*(0C) 19*(04)+  (0CH),27 dup(4),9 dup(02H),25 dup(4),11 dup(0CH),20 dup(4),10 dup(02H),23 dup(4)
    887	      08*(02) 16*(04) 0A* +
    888	      (0C) 1B*(04) 09*(02)+
    889	      19*(04) 0B*(0C) 14* +
    890	      (04) 0A*(02) 17*(04)
    891	8A85  19*(04) 07*(02) 14* +	     db	25 dup(4),7 dup(02H),20	dup(4),9 dup(0CH),25 dup(4),8 dup(02H),22 dup(4),10 dup	    +
    892	      (04) 09*(0C) 19*(04)+  (0CH),27 dup(4),9 dup(02H),25 dup(4),11 dup(0CH),20 dup(4),10 dup(02H),23 dup(4)
    893	      08*(02) 16*(04) 0A* +
    894	      (0C) 1B*(04) 09*(02)+
    895	      19*(04) 0B*(0C) 14* +
    896	      (04) 0A*(02) 17*(04)
    897	8B80  14*(04) 0A*(0C) 12* +	     db	20 dup(4),10 dup(0CH),18 dup(4),12 dup(02H),20 dup(4),11 dup(0CH),19 dup(4),13 dup  +
    898	      (04) 0C*(02) 14*(04)+  (02H),22 dup(4),12	dup(0CH),21 dup(4),14 dup(02H),18 dup(4),13 dup(0CH),19	dup(4)
    899	      0B*(0C) 13*(04) 0D* +
    900	      (02) 16*(04) 0C*(0C)+
    901	      15*(04) 0E*(02) 12* +
    902	      (04) 0D*(0C) 13*(04)
    903	8C72  14*(04) 0A*(0C) 12* +	     db	20 dup(4),10 dup(0CH),18 dup(4),12 dup(02H),20 dup(4),11 dup(0CH),19 dup(4),13 dup  +
    904	      (04) 0C*(02) 14*(04)+  (02H),22 dup(4),12	dup(0CH),21 dup(4),14 dup(02H),18 dup(4),13 dup(0CH),19	dup(4)
    905	      0B*(0C) 13*(04) 0D* +
    906	      (02) 16*(04) 0C*(0C)+
    907	      15*(04) 0E*(02) 12* +
    908	      (04) 0D*(0C) 13*(04)
    909	8D64  14*(04) 0A*(0C) 12* +	     db	20 dup(4),10 dup(0CH),18 dup(4),12 dup(02H),20 dup(4),11 dup(0CH),19 dup(4),13 dup  +
    910	      (04) 0C*(02) 14*(04)+  (02H),22 dup(4),12	dup(0CH),21 dup(4),14 dup(02H),18 dup(4),13 dup(0CH),19	dup(4)
    911	      0B*(0C) 13*(04) 0D* +
    912	      (02) 16*(04) 0C*(0C)+
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 17
MAIN.ASM



    913	      15*(04) 0E*(02) 12* +
    914	      (04) 0D*(0C) 13*(04)
    915	8E56  0F*(04) 0F*(02) 0D* +	     db	15 dup(4),15 dup(02H),13 dup(4),18 dup(0CH),15 dup(4),16 dup(02H),14 dup(4),19 dup  +
    916	      (04) 12*(0C) 0F*(04)+  (0CH),17 dup(4),17	dup(02H),16 dup(4),20 dup(0CH),13 dup(4),18 dup(02H),15	dup(4)
    917	      10*(02) 0E*(04) 13* +
    918	      (0C) 11*(04) 11*(02)+
    919	      10*(04) 14*(0C) 0D* +
    920	      (04) 12*(02) 0F*(04)
    921	8F47  0A*(04) 14*(0C) 08* +	     db	10 dup(4),20 dup(0CH),8	dup(4),25 dup(02H),10 dup(4),21	dup(0CH),9 dup(4),26 dup    +
    922	      (04) 19*(02) 0A*(04)+  (02H),12 dup(4),22	dup(0CH),11 dup(4),27 dup(02H),8 dup(4),23 dup(0CH),10 dup(4)
    923	      15*(0C) 09*(04) 1A* +
    924	      (02) 0C*(04) 16*(0C)+
    925	      0B*(04) 1B*(02) 08* +
    926	      (04) 17*(0C) 0A*(04)
    927	9039  0140*(0C)			     db	320 dup	(0CH)
    928	9179  0140*(02)			     db	320 dup	(02H)
    929	92B9  0140*(0C)			     db	320 dup	(0CH)
    930	93F9  0140*(02)			     db	320 dup	(02H)
    931	9539  0140*(0C)			     db	320 dup	(0CH)
    932	9679  0140*(02)			     db	320 dup	(02H)
    933	97B9  0140*(0C)			     db	320 dup	(0CH)
    934	98F9  0140*(02)			     db	320 dup	(02H)
    935	9A39  0140*(0C)			     db	320 dup	(0CH)
    936	9B79  0140*(02)			     db	320 dup	(02H)
    937	9CB9  0140*(0C)			     db	320 dup	(0CH)
    938	9DF9  0140*(02)			     db	320 dup	(02H)
    939	9F39  0140*(0C)			     db	320 dup	(0CH)
    940	A079  0140*(02)			     db	320 dup	(02H)
    941	A1B9  0140*(0C)			     db	320 dup	(0CH)
    942
    943
    944	A2F9  00 00 04 04 04 04	04+  base    db	0, 0, 4, 4, 4, 4, 4, 4,	4, 4, 4, 4, 4, 4, 0, 0,	7, 7, 7, 7, 7, 7, 7, 7,	7, 7, 7, 7, +
    945	      04 04 04 04 04 04	04+  7,	7, 7, 7	, 0, 0
    946	      00 00 07 07 07 07	07+
    947	      07 07 07 07 07 07	07+
    948	      07 07 07 07 00 00
    949	A31B  00 00 00 00 00 00	00+	     db	0, 0, 0, 0, 0, 0, 0, 0,	0, 0, 0, 0, 0, 0, 0, 0,	7, 7, 0BH, 0BH,	0BH, 0BH, 0BH, 0BH, +
    950	      00 00 00 00 00 00	00+  0BH, 0BH, 0BH, 0BH, 0BH, 0BH, 7, 7, 0, 0
    951	      00 00 07 07 0B 0B	0B+
    952	      0B 0B 0B 0B 0B 0B	0B+
    953	      0B 0B 07 07 00 00
    954	A33D  04 04 04 04 04 04	00+	     db	4, 4, 4, 4, 4, 4, 0, 0,	0, 0, 4, 4, 4, 4, 4, 4,	7, 7, 0BH, 0BH,	0BH, 0BH, 0BH, 0BH, +
    955	      00 00 00 04 04 04	04+  0BH, 0BH, 0BH, 0BH, 0BH, 0BH, 7, 7, 0, 0
    956	      04 04 07 07 0B 0B	0B+
    957	      0B 0B 0B 0B 0B 0B	0B+
    958	      0B 0B 07 07 00 00
    959	A35F  04 04 04 04 04 04	00+	     db	4, 4, 4, 4, 4, 4, 0, 0,	0, 0, 4, 4, 4, 4, 4, 4,	7, 7, 0BH, 0BH,	0BH, 0BH, 0BH, 0BH, +
    960	      00 00 00 04 04 04	04+  0BH, 0BH, 0BH, 0BH, 0BH, 0BH, 7, 7, 0, 0
    961	      04 04 07 07 0B 0B	0B+
    962	      0B 0B 0B 0B 0B 0B	0B+
    963	      0B 0B 07 07 00 00
    964	A381  04 04 04 04 04 04	00+	     db	4, 4, 4, 4, 4, 4, 0, 0,	0, 0, 4, 4, 4, 4, 4, 4,	7, 7, 0BH, 0BH,	0BH, 0BH, 0BH, 0BH, +
    965	      00 00 00 04 04 04	04+  0BH, 0BH, 0BH, 0BH, 0BH, 0BH, 7, 7, 0, 0
    966	      04 04 07 07 0B 0B	0B+
    967	      0B 0B 0B 0B 0B 0B	0B+
    968	      0B 0B 07 07 00 00
    969	A3A3  04 04 04 04 04 04	00+	     db	4, 4, 4, 4, 4, 4, 0, 0,	0, 0, 4, 4, 4, 4, 4, 4,	7, 7, 0BH, 0BH,	0BH, 0BH, 0BH, 0BH, +
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 18
MAIN.ASM



    970	      00 00 00 04 04 04	04+  0BH, 0BH, 0BH, 0BH, 0BH, 0BH, 7, 7, 0, 0
    971	      04 04 07 07 0B 0B	0B+
    972	      0B 0B 0B 0B 0B 0B	0B+
    973	      0B 0B 07 07 00 00
    974	A3C5  00 00 04 04 04 04	04+	     db	0, 0, 4, 4, 4, 4, 4, 4,	4, 4, 4, 4, 4, 4, 0, 0,	7, 7, 0BH, 0BH,	0BH, 0BH, 0BH, 0BH, +
    975	      04 04 04 04 04 04	04+  0BH, 0BH, 0BH, 0BH, 0BH, 0BH, 7, 7, 0, 0
    976	      00 00 07 07 0B 0B	0B+
    977	      0B 0B 0B 0B 0B 0B	0B+
    978	      0B 0B 07 07 00 00
    979	A3E7  00 00 00 00 00 00	00+	     db	0, 0, 0, 0, 0, 0, 0, 0,	0, 0, 0, 0, 0, 0, 0, 0,	7, 7, 7, 7, 7, 7, 7, 7,	7, 7, 7, 7, +
    980	      00 00 00 00 00 00	00+  7,	7, 7, 7, 0, 0
    981	      00 00 07 07 07 07	07+
    982	      07 07 07 07 07 07	07+
    983	      07 07 07 07 00 00
    984
    985
    986	A409  07 07 04 04 04 04	04+  topo    db	7, 7, 4, 4, 4, 4, 4, 4,	4, 4, 4, 4, 4, 4, 7, 7,	7, 7, 4, 4, 4, 4, 4, 4,	4, 4, 4, 4, +
    987	      04 04 04 04 04 04	04+  4,	4, 7, 7, 0, 0
    988	      07 07 07 07 04 04	04+
    989	      04 04 04 04 04 04	04+
    990	      04 04 07 07 00 00
    991	A42B  07 07 07 07 07 07	07+	     db	7, 7, 7, 7, 7, 7, 7, 7,	7, 7, 7, 7, 7, 7, 7, 7,	7, 7, 7, 7, 7, 7, 7, 7,	7, 7, 7, 7, +
    992	      07 07 07 07 07 07	07+  7,	7, 7, 7, 0, 0
    993	      07 07 07 07 07 07	07+
    994	      07 07 07 07 07 07	07+
    995	      07 07 07 07 00 00
    996	A44D  04 04 04 04 04 04	07+	     db	4, 4, 4, 4, 4, 4, 7, 7,	7, 7, 4, 4, 4, 4, 4, 4,	4, 4, 4, 4, 4, 4, 7, 7,	7, 7, 4, 4, +
    997	      07 07 07 04 04 04	04+  4,	4, 4, 4, 0, 0
    998	      04 04 04 04 04 04	04+
    999	      04 07 07 07 07 04	04+
   1000	      04 04 04 04 00 00
   1001	A46F  04 04 04 04 04 04	07+	     db	4, 4, 4, 4, 4, 4, 7, 7,	7, 7, 4, 4, 4, 4, 4, 4,	4, 4, 4, 4, 4, 4, 7, 7,	7, 7, 4, 4, +
   1002	      07 07 07 04 04 04	04+  4,	4, 4, 4, 0, 0
   1003	      04 04 04 04 04 04	04+
   1004	      04 07 07 07 07 04	04+
   1005	      04 04 04 04 00 00
   1006	A491  04 04 04 04 04 04	07+	     db	4, 4, 4, 4, 4, 4, 7, 7,	7, 7, 4, 4, 4, 4, 4, 4,	4, 4, 4, 4, 4, 4, 7, 7,	7, 7, 4, 4, +
   1007	      07 07 07 04 04 04	04+  4,	4, 4, 4, 0, 0
   1008	      04 04 04 04 04 04	04+
   1009	      04 07 07 07 07 04	04+
   1010	      04 04 04 04 00 00
   1011	A4B3  04 04 04 04 04 04	07+	     db	4, 4, 4, 4, 4, 4, 7, 7,	7, 7, 4, 4, 4, 4, 4, 4,	4, 4, 4, 4, 4, 4, 7, 7,	7, 7, 4, 4, +
   1012	      07 07 07 04 04 04	04+  4,	4, 4, 4, 0, 0
   1013	      04 04 04 04 04 04	04+
   1014	      04 07 07 07 07 04	04+
   1015	      04 04 04 04 00 00
   1016	A4D5  07 07 04 04 04 04	04+	     db	7, 7, 4, 4, 4, 4, 4, 4,	4, 4, 4, 4, 4, 4, 7, 7,	7, 7, 4, 4, 4, 4, 4, 4,	4, 4, 4, 4, +
   1017	      04 04 04 04 04 04	04+  4,	4, 7, 7, 0, 0
   1018	      07 07 07 07 04 04	04+
   1019	      04 04 04 04 04 04	04+
   1020	      04 04 07 07 00 00
   1021	A4F7  07 07 07 07 07 07	07+	     db	7, 7, 7, 7, 7, 7, 7, 7,	7, 7, 7, 7, 7, 7, 7, 7,	7, 7, 7, 7, 7, 7, 7, 7,	7, 7, 7, 7, +
   1022	      07 07 07 07 07 07	07+  7,	7, 7, 7, 0, 0
   1023	      07 07 07 07 07 07	07+
   1024	      07 07 07 07 07 07	07+
   1025	      07 07 07 07 00 00
   1026
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 19
MAIN.ASM



   1027					 ; Vetor de terrenos para cada fase (fase3 não	usa terreno fixo)
   1028	A519  0C22r 6B63r 0000		 terrain_vec dw	offset terrain_fase1, offset terrain_fase2, 0
   1029
   1030	A51F  0000			 terrain_pos dw	0  ; Offset de scroll horizontal (0-319)
   1031
   1032					 ; Estrutura para torres da fase 3 (geração procedural)
   1033	      =000C			 MAX_TOWERS EQU	12
   1034	A521  0C*(00)			 tower_heights db MAX_TOWERS dup(0)  ; Altura de cada torre (em	andares)
   1035	A52D  0C*(0000)			 tower_x_pos   dw MAX_TOWERS dup(0)  ; Posição X de cada torre
   1036	A545  0C*(00)			 tower_active  db MAX_TOWERS dup(0)  ; Torre ativa? (0=não, 1=sim)
   1037	A551  0140			 next_tower_x  dw 320		     ; Próxima	posição X para gerar torre
   1038	A553  0000			 tower_spawn_counter dw	0	     ; Contador	para spawnar novas torres
   1039	      =0022			 tower_min_spacing   EQU 34	     ; Espaçamento = 34 frames	(mesma largura das torres)
   1040
   1041					 ; Variáveis temporárias para	clipping de torre
   1042	A555  0000			 tower_sprite_offset dw	0	     ; Offset no sprite	(pixels	a pular)
   1043	A557  0022			 tower_render_width  dw	BASE_WIDTH   ; Largura a renderizar
   1044
   1045					 ; Dimensões dos andares
   1046	      =0022			 BASE_WIDTH  EQU 34  ; Largura de um andar (em pixels)
   1047	      =0008			 BASE_HEIGHT EQU 8   ; Altura de um andar (em pixels)
   1048
   1049
   1050	A559			     .code
   1051	0000			     MAIN:
   1052	0000  B8 0000s			 mov AX, @data
   1053	0003  8E D8			 mov DS, AX
   1054	0005  B8 A000			 mov AX, 0A000H
   1055	0008  8E C0			 mov ES, AX
   1056	000A  33 FF			 xor DI, DI
   1057
   1058	000C  E8 00B4			 call N_ALE
   1059	000F  E8 0124			 call INIT_ALIEN_RANDOM
   1060
   1061					 ; Define o modo de video
   1062	0012  32 E4			 xor ah, ah
   1063	0014  32 FF			 xor bh, bh
   1064	0016  B0 13			 mov al, 13h
   1065	0018  CD 10			 int 10h
   1066
   1067	001A			     LOOP_MENU:
   1068					 ; Exibe titulo	e botoes do menu
   1069	001A  E8 00CA			 call PRINT_TITLE_MENU
   1070	001D  E8 006C			 call PRINT_BUTTONS
   1071
   1072	0020  E8 0244			 call MOVE_MENU
   1073					 ; Recebe entrada do usu??rio
   1074	0023  B4 01			 mov ah, 1H
   1075	0025  CD 16			 int 16H
   1076	0027  74 F1			 jz LOOP_MENU
   1077
   1078					 ; Chama a fun????o de navega????o
   1079	0029  E8 0268			 call HANDLE_INPUT
   1080
   1081					 ; Condi????o para iniciar o jogo
   1082	002C  80 FC 1C			 cmp ah, 1CH
   1083	002F  74 06			 je SELECT_OPTION
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 20
MAIN.ASM



   1084
   1085					 ; Retorno ao loop do menu
   1086	0031  32 E4			 xor ah, ah
   1087	0033  CD 16			 int 16H
   1088	0035  EB E3			 jmp LOOP_MENU
   1089	0037			     SELECT_OPTION:
   1090	0037  32 E4			 xor ah, ah
   1091	0039  CD 16			 int 16H
   1092
   1093	003B  8A 26 0002r		 mov ah, menu
   1094	003F  80 FC 01			 cmp ah, 1
   1095	0042  74 44			 je FINISH
   1096
   1097	0044  E8 051D			 call RESET_GAME  ; Reseta score, vidas	e fase
   1098
   1099	0047  E8 028F			 call RENDER_FASE  ; Mostra a tela da fase
   1100
   1101					 ; Aguarda um pouco para ver a fase
   1102	004A  33 C9			 xor cx, cx
   1103	004C  BA FFFF			 mov dx, 0FFFFH
   1104	004F  B4 86			 mov ah, 86H
   1105	0051  CD 15			 int 15h
   1106
   1107					 ; Limpa completamente a tela antes de iniciar o jogo
   1108	0053  E8 026B			 call CLEAR_SCREEN
   1109
   1110	0056  E8 04EA			 call RESET_SHIP
   1111
   1112	0059				 GAME_LOOP:
   1113	0059  E8 0630			 call RENDER_TERRAIN  ;	Renderiza o terreno primeiro
   1114	005C  E8 03A0			 call RENDER_STATUS   ;	Renderiza score, vidas e tempo
   1115	005F  E8 03A7			 call UPDATE_TIME
   1116	0062  E8 0425			 call UPDATE_SHIP
   1117	0065  E8 0578			 call UPDATE_SHOT     ;	Atualiza os tiros
   1118	0068  E8 0A26			 call UPDATE_ALIENS   ;	Atualiza aliens
   1119	006B  E8 0BCC			 call CHECK_ALIEN_SHOT_COLLISION   ; Colisão tiros vs aliens
   1120	006E  E8 0C97			 call CHECK_ALIEN_SHIP_COLLISION   ; Colisão nave vs aliens
   1121
   1122					 ; Verifica condições	de fim de jogo
   1123	0071  E8 093C			 call CHECK_GAME_END
   1124	0074  3C 01			 cmp al, 1	      ;	Game Over?
   1125	0076  74 06			 je GAME_OVER_END
   1126	0078  3C 02			 cmp al, 2	      ;	Vitória?
   1127	007A  74 07			 je VICTORY_END
   1128
   1129	007C  EB DB			 jmp GAME_LOOP
   1130
   1131	007E			     GAME_OVER_END:
   1132	007E  E8 0874			 call SHOW_GAME_OVER
   1133	0081  EB 97			 jmp LOOP_MENU	      ;	Volta ao menu principal
   1134
   1135	0083			     VICTORY_END:
   1136	0083  E8 08B2			 call SHOW_VICTORY
   1137	0086  EB 92			 jmp LOOP_MENU	      ;	Volta ao menu principal
   1138
   1139	0088			     FINISH:
   1140	0088  E8 0229			 CALL END_GAME
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 21
MAIN.ASM



   1141
   1142	008B  C3			 ret
   1143
   1144				     ; Procedimento para exibir	os botoes INICIAR e SAIR
   1145				     ; se menu == 0 o bot?o jogar fica vermelho
   1146				     ; se menu == 1 o botao sair fica vermelho
   1147	008C			     PRINT_BUTTONS proc
   1148	008C  50			 push ax
   1149	008D  B3 0F			 mov bl, 0FH
   1150	008F  8A 26 0002r		 mov ah, menu
   1151	0093  80 FC 00			 cmp ah, 0
   1152	0096  75 02			 jne START_BTN
   1153	0098  B3 0C			 mov bl, 0CH
   1154
   1155	009A			     START_BTN:
   1156					 ; Exibe o bot??o INICIAR
   1157	009A  BD 0004r			 mov bp, offset	btn_iniciar
   1158	009D  B9 0051			 mov cx, btn_iniciar_length ; tamanho
   1159	00A0  32 D2			 xor dl, dl ; coluna = 0
   1160	00A2  B6 12			 mov dh, 18 ; linha = 18
   1161	00A4  E8 002B			 call PRINT_STRING
   1162
   1163	00A7  B3 0F			 mov bl, 0FH
   1164	00A9  8A 26 0002r		 mov ah, menu
   1165	00AD  80 FC 01			 cmp ah, 1
   1166	00B0  75 02			 jne EXIT_BTN
   1167	00B2  B3 0C			 mov bl, 0CH
   1168
   1169	00B4			     EXIT_BTN:
   1170	00B4  BD 0055r			 mov bp, offset	btn_sair
   1171	00B7  B9 0051			 mov cx, btn_sair_length ; tamanho
   1172	00BA  32 D2			 xor dl, dl ; coluna = 0
   1173	00BC  B6 15			 mov dh, 21 ; linha = 21
   1174	00BE  E8 0011			 call PRINT_STRING
   1175
   1176	00C1  58			 pop ax
   1177	00C2  C3			 ret
   1178	00C3			     PRINT_BUTTONS endp
   1179
   1180				     ; gera um valor aleatorio do clock	com 1AH
   1181	00C3			     N_ALE proc
   1182	00C3  50			 push ax
   1183	00C4  51			 push cx
   1184	00C5  52			 push dx
   1185
   1186	00C6  33 C0			 xor ax, ax
   1187	00C8  CD 1A			 int 1AH
   1188	00CA  89 16 0000r		 mov ale, dx
   1189
   1190	00CE  5A			 pop dx
   1191	00CF  59			 pop cx
   1192	00D0  58			 pop ax
   1193	00D1  C3			 ret
   1194	00D2			     N_ALE endp
   1195
   1196				     ;	Desenha	CX caracteres a	partir de ES:BP	na posi??o (linha DH, coluna DL).
   1197				     ;	Usa a cor/atributo em BL (p.ex.: 0Fh = branco, 0Ch = vermelho-claro).
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 22
MAIN.ASM



   1198				     ;	Atualiza o cursor ap?s imprimir	(modo AL=1).
   1199				     ;	ES deve	apontar	para o segmento	onde est? a string (comumente ES=DS).
   1200				     ;	BP deve	conter o offset	da string dentro de ES.
   1201	00D2			     PRINT_STRING PROC
   1202	00D2  50			 push AX
   1203	00D3  53			 push BX
   1204	00D4  1E			 push DS
   1205	00D5  06			 push ES
   1206	00D6  56			 push SI
   1207	00D7  55			 push BP
   1208
   1209	00D8  B4 13			 mov ah, 13h
   1210	00DA  B0 01			 mov al, 1
   1211
   1212	00DC  32 FF			 xor bh, bh
   1213	00DE  CD 10			 int 10h  ; escreve string
   1214
   1215	00E0  5D			 pop BP
   1216	00E1  5E			 pop SI
   1217	00E2  07			 pop ES
   1218	00E3  1F			 pop DS
   1219	00E4  5B			 pop BX
   1220	00E5  58			 pop AX
   1221	00E6  C3			 ret
   1222	00E7			     PRINT_STRING ENDP
   1223
   1224	00E7			     PRINT_TITLE_MENU proc
   1225	00E7  8C D8			 mov ax, ds
   1226	00E9  8E C0			 mov es, ax
   1227
   1228					 ; ajusta resgitradores	pro PRINT_STRING
   1229	00EB  BD 00A6r			 mov bp, offset	string
   1230	00EE  B9 00C8			 mov cx, string_length ; tamanho
   1231	00F1  B3 02			 mov bl, 02H ; Cor verde (se bit 1 de AL estiver limpo,	usamos BL)
   1232	00F3  BA 03C0			 mov dx, 320*3 ; linha / coluna
   1233	00F6  E8 FFD9			 call PRINT_STRING
   1234
   1235	00F9  C3			 ret
   1236	00FA			     PRINT_TITLE_MENU endp
   1237
   1238				     ; Renderiza sprite	da nave
   1239				     ; AX = posição na tela
   1240				     ; SI = offset do sprite
   1241	00FA			     RENDER_SPRITE proc
   1242	00FA  53			 push bx
   1243	00FB  51			 push cx
   1244	00FC  52			 push dx
   1245	00FD  57			 push di
   1246	00FE  06			 push es
   1247	00FF  1E			 push ds
   1248	0100  50			 push ax
   1249
   1250	0101  B8 0000s			 mov ax, @data
   1251	0104  8E D8			 mov ds, ax
   1252
   1253	0106  B8 A000			 mov ax, 0A000h
   1254	0109  8E C0			 mov es, ax
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 23
MAIN.ASM



   1255
   1256	010B  58			 pop ax
   1257	010C  8B F8			 mov di, ax
   1258	010E  BA 0014			 mov dx, SPR_H
   1259	0111  50			 push ax
   1260
   1261	0112			     DRAW_SHIP_LINE:
   1262	0112  B9 0018			 mov cx, SPR_W
   1263	0115  F3> A4			 rep movsb
   1264	0117  81 C7 0128		 add di, SCREEN_W - SPR_W
   1265	011B  4A			 dec dx
   1266	011C  75 F4			 jnz DRAW_SHIP_LINE
   1267
   1268	011E  58			 pop ax
   1269	011F  1F			 pop ds
   1270	0120  07			 pop es
   1271	0121  5F			 pop di
   1272	0122  5A			 pop dx
   1273	0123  59			 pop cx
   1274	0124  5B			 pop bx
   1275	0125  C3			 ret
   1276	0126			     RENDER_SPRITE endp
   1277
   1278				     ; usando o	valor aleatorio	gerado em N_ALE
   1279	0126			     RANDOM_UINT16 proc
   1280	0126  52			 push dx
   1281
   1282	0127  B8 6255			 mov ax, 25173
   1283	012A  F7 26 0000r		 mul ale
   1284	012E  05 3619			 add ax, 13849
   1285	0131  A3 0000r			 mov ale, ax
   1286
   1287	0134  5A			 pop dx
   1288	0135  C3			 ret
   1289	0136			     endp
   1290
   1291				     ; Inicializa posi??o e dire??o aleat?rias do alien
   1292				     ; Requer: RANDOM_UINT16 (retorna AX pseudo-aleat?rio)
   1293				     ; Usa: y fixo = 100 (troque se quiser), largura sprite = 14 (logo x<=306)
   1294
   1295	0136			     INIT_ALIEN_RANDOM proc
   1296	0136  50			 push ax
   1297	0137  53			 push bx
   1298	0138  51			 push cx
   1299	0139  52			 push dx
   1300
   1301					 ; x aleat?rio em [0..306]
   1302	013A  E8 FFE9			 call RANDOM_UINT16	    ; AX = rand
   1303	013D  33 D2			 xor dx, dx
   1304	013F  BB 0133			 mov bx, 307		    ; divisor
   1305	0142  F7 F3			 div bx			    ; AX/307
   1306	0144  8B CA			 mov cx, dx		    ; CX = x (0..306)
   1307
   1308					 ; y*320 (y = 125)
   1309	0146  BB 007D			 mov bx, 125
   1310	0149  8B C3			 mov ax, bx
   1311	014B  D1 E3 D1 E3 D1 E3	D1+	 shl bx, 6		    ; y<<6
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 24
MAIN.ASM



   1312	      E3 D1 E3 D1 E3
   1313	0157  D1 E0 D1 E0 D1 E0	D1+	 shl ax, 8		    ; y<<8
   1314	      E0 D1 E0 D1 E0 D1	E0+
   1315	      D1 E0
   1316	0167  03 D8			 add bx, ax		    ; bx = y*320
   1317
   1318					 ; alien_pos = y*320 + x
   1319	0169  03 D9			 add bx, cx
   1320	016B  89 1E 0545r		 mov alien_pos,	bx
   1321
   1322	016F  5A			 pop dx
   1323	0170  59			 pop cx
   1324	0171  5B			 pop bx
   1325	0172  58			 pop ax
   1326	0173  C3			 ret
   1327	0174			     INIT_ALIEN_RANDOM endp
   1328
   1329				     ; DI = posi??o linear do canto esquerdo do	sprite
   1330	0174			     CLEAR_SPRITE proc
   1331	0174  50			 push ax
   1332	0175  51			 push cx
   1333	0176  57			 push di
   1334	0177  06			 push es
   1335
   1336	0178  B8 A000			 mov ax, 0A000h
   1337	017B  8E C0			 mov es, ax
   1338	017D  B9 0014			 mov cx, SPR_H
   1339
   1340	0180			     CLEAR_LINE:
   1341	0180  51			 push cx
   1342	0181  B9 0018			 mov cx, SPR_W
   1343	0184  32 C0			 xor al, al	     ; cor 0 (preto)
   1344	0186  F3> AA			 rep stosb
   1345	0188  81 C7 0128		 add di, SCREEN_W - SPR_W
   1346	018C  59			 pop cx
   1347	018D  E2 F1			 loop CLEAR_LINE
   1348
   1349	018F  07			 pop es
   1350	0190  5F			 pop di
   1351	0191  59			 pop cx
   1352	0192  58			 pop ax
   1353	0193  C3			 ret
   1354	0194			     CLEAR_SPRITE endp
   1355
   1356				     ; MOVE_WRAP_LEFT_AND_DRAW
   1357				     ; Entradas:
   1358				     ;	 BX = &pos_var		 (ex.: OFFSET meteor_pos)
   1359				     ;	 SI = offset sprite	 (ex.: OFFSET meteor_sprite)
   1360				     ;	 AX = pos_inicial	 (ex.: meteor_pos_ini)
   1361				     ;	 DX = limite_esquerdo	 (ex.: 4)
   1362				     ; Efeito:
   1363				     ;	 - limpa, move 1 px p/ esquerda	(wrap p/ direita se necessário), redesenha
   1364	0194			     MOVE_WRAP_LEFT_AND_DRAW proc
   1365	0194  50			 push ax
   1366	0195  53			 push bx
   1367	0196  51			 push cx
   1368	0197  52			 push dx
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 25
MAIN.ASM



   1369	0198  56			 push si
   1370	0199  57			 push di
   1371	019A  55			 push bp
   1372
   1373	019B  8B E8			 mov bp, ax		 ; BP =	posição inicial (para	wrap)
   1374	019D  8B FA			 mov di, dx		 ; DI =	limite esquerdo
   1375
   1376
   1377
   1378					 ; Verifica limites: x = pos % 320
   1379	019F  8B 07			 mov ax, [bx]
   1380	01A1  33 D2			 xor dx, dx
   1381	01A3  B9 0140			 mov cx, 320
   1382	01A6  F7 F1			 div cx			 ; DX =	x (coordenada X)
   1383
   1384	01A8  3B D7			 cmp dx, di		 ; compara com limite esquerdo
   1385	01AA  77 09			 ja  MOVE_LEFT_MENU
   1386
   1387					 ; wrap	para a direita
   1388	01AC  8B 3F			 mov di, [bx]
   1389	01AE  E8 FFC3			 call CLEAR_SPRITE
   1390
   1391	01B1  8B C5			 mov ax, bp		 ; AX =	posição inicial
   1392	01B3  89 07			 mov [bx], ax
   1393
   1394					 ; jmp DRAW_SPRITE
   1395
   1396	01B5			     MOVE_LEFT_MENU:
   1397					 ; move	para a esquerda	usando MOVE_LEFT_PROC
   1398					 ; configura parâmetros para MOVE_LEFT_PROC
   1399	01B5  53			 push bx		     ; salva BX	original
   1400	01B6  57			 push di		     ; salva DI	original
   1401
   1402					 ; BX =	ponteiro para posição	(já está correto)
   1403	01B7  B9 0001			 mov cx, 1		     ; velocidade = 1 pixel
   1404	01BA  8B D7			 mov dx, di		     ; limite esquerdo
   1405	01BC  E8 0844			 call MOVE_LEFT_PROC
   1406
   1407	01BF  5F			 pop di			     ; restaura	DI
   1408	01C0  5B			 pop bx			     ; restaura	BX
   1409
   1410	01C1			     DRAW_SPRITE:
   1411					 ; Renderiza sprite na nova posição
   1412	01C1  8B 07			 mov ax, [bx]		 ; AX =	nova posição
   1413					 ; SI já contém o offset do sprite
   1414	01C3  E8 FF34			 call RENDER_SPRITE
   1415
   1416	01C6  5D			 pop bp
   1417	01C7  5F			 pop di
   1418	01C8  5E			 pop si
   1419	01C9  5A			 pop dx
   1420	01CA  59			 pop cx
   1421	01CB  5B			 pop bx
   1422	01CC  58			 pop ax
   1423	01CD  C3			 ret
   1424	01CE			     MOVE_WRAP_LEFT_AND_DRAW endp
   1425
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 26
MAIN.ASM



   1426				     ; MOVE_BOUNCE_X_AND_DRAW
   1427				     ; Entradas:
   1428				     ;	 BX = &pos_var		 (ex.: OFFSET alien_pos)
   1429				     ;	 BP = &dir_flag		 (ex.: OFFSET alien_dir)  ; byte: 0=esq, 1=dir
   1430				     ;	 SI = offset sprite	 (ex.: OFFSET alien_sprite)
   1431				     ;	 AX = L	(left bound)	 (ex.: ALIEN_L)
   1432				     ;	 DX = R	(right bound)	 (ex.: ALIEN_R)
   1433				     ; Efeito:
   1434				     ;	 - limpa as bordas, move 1 px na direção, redesenha
   1435	01CE			     MOVE_BOUNCE_X_AND_DRAW proc
   1436	01CE  50			 push ax
   1437	01CF  53			 push bx
   1438	01D0  51			 push cx
   1439	01D1  52			 push dx
   1440	01D2  56			 push si
   1441	01D3  57			 push di
   1442	01D4  55			 push bp
   1443
   1444	01D5  8B C8			 mov cx, ax		 ; CX =	limite esquerdo	(coordenada X)
   1445	01D7  8B FA			 mov di, dx		 ; DI =	limite direito (coordenada X)
   1446
   1447					 ; Verifica limites: x = pos % 320
   1448	01D9  8B 07			 mov ax, [bx]
   1449	01DB  33 D2			 xor dx, dx
   1450	01DD  BD 0140			 mov bp, 320
   1451	01E0  F7 F5			 div bp			 ; DX =	x atual	(coordenada X)
   1452
   1453					 ; Verifica bounce esquerdo
   1454	01E2  3B D1			 cmp dx, cx		 ; compara X atual com X limite	esquerdo
   1455	01E4  76 07			 jbe BOUNCE_LEFT
   1456
   1457					 ; Verifica bounce direito
   1458	01E6  3B D7			 cmp dx, di		 ; compara X atual com X limite	direito
   1459	01E8  73 08			 jae BOUNCE_RIGHT
   1460	01EA  EB 0B 90			 jmp MOVE_BOUNCE_MENU
   1461
   1462	01ED			     BOUNCE_LEFT:
   1463					 ; chegou na borda esquerda, muda direção para direita
   1464					 ; BP foi usado	para a chamada anterior	mas preciso recuperar o	ponteiro da direção
   1465					 ; Vou usar o parâmetro BP original que foi passado na	chamada
   1466	01ED  B0 01			 mov al, 1		 ; direção = direita
   1467	01EF  EB 03 90			 jmp SET_DIRECTION
   1468
   1469	01F2			     BOUNCE_RIGHT:
   1470					 ; chegou na borda direita, muda direção para	esquerda
   1471	01F2  B0 00			 mov al, 0		 ; direção = esquerda
   1472
   1473	01F4			     SET_DIRECTION:
   1474					 ; BP original está na	pilha, preciso acessar diferente
   1475					 ; Vou usar uma	abordagem mais simples - usar a	variável global alien_dir
   1476	01F4  A2 0547r			 mov alien_dir,	al	 ; atualiza direção global
   1477
   1478	01F7			     MOVE_BOUNCE_MENU:
   1479					 ; configura parâmetros para movimento
   1480	01F7  53			 push bx		 ; salva BX original
   1481	01F8  57			 push di		 ; salva DI original
   1482	01F9  51			 push cx		 ; salva CX original
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 27
MAIN.ASM



   1483
   1484	01FA  8A 16 0547r		 mov dl, alien_dir	 ; DL =	dir (0=esq, 1=dir)
   1485	01FE  80 FA 01			 cmp dl, 1
   1486	0201  74 0D			 jz  MOVE_RIGHT_BOUNCE
   1487
   1488					 ; move	para esquerda usando MOVE_LEFT_PROC
   1489	0203  8B C1			 mov ax, cx		 ; AX =	limite esquerdo	em coordenada X	(do stack)
   1490	0205  B9 0001			 mov cx, 1		 ; velocidade =	1 pixel
   1491	0208  8B D0			 mov dx, ax		 ; limite esquerdo em coordenada X
   1492	020A  E8 07F6			 call MOVE_LEFT_PROC
   1493	020D  EB 09 90			 jmp RESTORE_BOUNCE
   1494
   1495	0210			     MOVE_RIGHT_BOUNCE:
   1496					 ; move	para direita usando MOVE_RIGHT_PROC
   1497	0210  B9 0001			 mov cx, 1		 ; velocidade =	1 pixel
   1498	0213  8B D7			 mov dx, di		 ; limite direito em coordenada	X
   1499	0215  E8 0814			 call MOVE_RIGHT_PROC
   1500
   1501	0218			     RESTORE_BOUNCE:
   1502	0218  59			 pop cx			 ; restaura CX
   1503	0219  5F			 pop di			 ; restaura DI
   1504	021A  5B			 pop bx			 ; restaura BX
   1505
   1506	021B			     DRAW_BOUNCE:
   1507					 ; Renderiza sprite na nova posição
   1508	021B  8B 07			 mov ax, [bx]		 ; AX =	nova posição
   1509					 ; SI já contém o offset do sprite
   1510	021D  E8 FEDA			 call RENDER_SPRITE
   1511
   1512	0220  5D			 pop bp
   1513	0221  5F			 pop di
   1514	0222  5E			 pop si
   1515	0223  5A			 pop dx
   1516	0224  59			 pop cx
   1517	0225  5B			 pop bx
   1518	0226  58			 pop ax
   1519	0227  C3			 ret
   1520	0228			     MOVE_BOUNCE_X_AND_DRAW endp
   1521
   1522	0228			     MOVE_WRAP_RIGHT_AND_DRAW proc
   1523	0228  50			 push ax
   1524	0229  53			 push bx
   1525	022A  51			 push cx
   1526	022B  52			 push dx
   1527	022C  56			 push si
   1528	022D  57			 push di
   1529
   1530	022E  BE 074Dr			 mov si, offset	ship_pos
   1531	0231  8B 3C			 mov di, [si]
   1532					 ; Verifica limites: x = ship_pos % 320
   1533	0233  A1 074Dr			 mov ax, [ship_pos]
   1534	0236  33 D2			 xor dx, dx
   1535	0238  B9 0140			 mov cx, 320
   1536	023B  F7 F1			 div cx			      ;	DX = x
   1537					 ; se x	>= (320-SPR_W),	não anda para a direita
   1538	023D  BB 0128			 mov bx, 320 - SPR_W	     ; limite direito considerando largura da nave
   1539	0240  3B D3			 cmp dx, bx
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 28
MAIN.ASM



   1540	0242  72 0D			 jb MOVE_RIGHT_MENU
   1541					 ; wrap	para a esquerda
   1542	0244  8B 3E 074Dr		 mov di, ship_pos
   1543	0248  E8 FF29			 call CLEAR_SPRITE
   1544	024B  C7 06 074Dr 5DC0		 mov ship_pos, ship_pos_ini	       ; AX = L
   1545
   1546	0251			     MOVE_RIGHT_MENU:
   1547	0251  BB 074Dr			 mov bx, OFFSET	ship_pos     ; ponteiro	para posição da nave
   1548	0254  B9 0005			 mov cx, ship_speed	     ; velocidade da nave
   1549	0257  BA 0128			 mov dx, 320 - SPR_W	     ; limite direito
   1550	025A  E8 07CF			 call MOVE_RIGHT_PROC
   1551
   1552	025D			     DRAW_RIGHT:
   1553
   1554	025D  E8 02D1			 call RENDER_SHIP
   1555
   1556	0260  5F			 pop di
   1557	0261  5E			 pop si
   1558	0262  5A			 pop dx
   1559	0263  59			 pop cx
   1560	0264  5B			 pop bx
   1561	0265  58			 pop ax
   1562	0266  C3			 ret
   1563	0267			     MOVE_WRAP_RIGHT_AND_DRAW endp
   1564
   1565	0267			     MOVE_MENU PROC
   1566	0267  BB 074Br			 mov bx, OFFSET	meteor_pos
   1567	026A  BE 016Er			 mov si, OFFSET	meteor_sprite
   1568	026D  B8 7E2C			 mov ax, meteor_pos_ini	     ; posição inicial para wrap
   1569	0270  BA 0004			 mov dx, 4		     ; limite esquerdo
   1570	0273  E8 FF1E			 call MOVE_WRAP_LEFT_AND_DRAW
   1571
   1572	0276  BB 0545r			 mov bx, OFFSET	alien_pos
   1573	0279  BD 0547r			 mov bp, OFFSET	alien_dir
   1574	027C  BE 034Er			 mov si, OFFSET	alien_sprite
   1575	027F  B8 0004			 mov ax, 4			 ; limite esquerdo (coordenada X)
   1576	0282  BA 012A			 mov dx, 298			 ; limite direito (coordenada X)
   1577	0285  E8 FF46			 call MOVE_BOUNCE_X_AND_DRAW
   1578
   1579	0288  E8 FF9D			 call MOVE_WRAP_RIGHT_AND_DRAW
   1580					 ; Delay
   1581					 ; usa interrup??o 15h que faz o delay
   1582					 ; dx fica com o valor do deplay, quanto maior mais delay tera
   1583	028B  33 C9			 xor cx, cx
   1584	028D  BA 2710			 mov dx, 2710H
   1585	0290  B4 86			 mov ah, 86H
   1586	0292  CD 15			 int 15h
   1587	0294			     MOVE_MENU ENDP
   1588
   1589
   1590	0294			     HANDLE_INPUT PROC
   1591	0294  80 FC 48			 cmp ah, 48H
   1592	0297  74 08			 je ARROW_UP
   1593
   1594	0299  80 FC 50			 cmp ah, 50H
   1595	029C  74 0C			 je ARROW_DOWN
   1596
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 29
MAIN.ASM



   1597	029E  EB 13 90			 jmp END_HANDLE
   1598
   1599	02A1			     ARROW_UP:
   1600	02A1  32 E4			 xor ah, ah
   1601	02A3  88 26 0002r		 mov menu, ah
   1602
   1603	02A7  EB 07 90			 jmp RENDER_BUTTONS
   1604
   1605	02AA			     ARROW_DOWN:
   1606	02AA  B4 01			 mov ah, 1
   1607	02AC  88 26 0002r		 mov menu, ah
   1608
   1609	02B0			     RENDER_BUTTONS:
   1610	02B0  E8 FDD9			 call PRINT_BUTTONS
   1611
   1612	02B3			     END_HANDLE:
   1613	02B3  C3			 ret
   1614	02B4			     ENDP
   1615
   1616	02B4			     END_GAME proc
   1617					 ; Back	to text	mode
   1618	02B4  32 E4			 xor ah, ah
   1619	02B6  B0 03			 mov al, 3h
   1620	02B8  CD 10			 int 10h
   1621
   1622					 ; Ends	program
   1623	02BA  B4 4C			 mov ah, 4ch
   1624	02BC  32 C0			 xor al, al
   1625	02BE  CD 21			 int 21h
   1626	02C0  C3			 ret
   1627	02C1			     endp
   1628
   1629	02C1			     CLEAR_SCREEN proc
   1630	02C1  50			 push ax
   1631	02C2  51			 push cx
   1632	02C3  06			 push es
   1633	02C4  57			 push di
   1634
   1635	02C5  B8 A000			 mov ax,0A000h
   1636	02C8  8E C0			 mov es,ax
   1637	02CA  33 FF			 xor di, di
   1638	02CC  B9 7D00			 mov cx, 32000d
   1639	02CF  FC			 cld
   1640	02D0  33 C0			 xor ax, ax
   1641	02D2  F3> AB			 rep stosw
   1642
   1643	02D4  5F			 pop di
   1644	02D5  07			 pop es
   1645	02D6  59			 pop cx
   1646	02D7  58			 pop ax
   1647	02D8  C3			 ret
   1648	02D9			     endp
   1649
   1650	02D9			     RENDER_FASE proc
   1651	02D9  50			 push ax
   1652	02DA  53			 push bx
   1653	02DB  51			 push cx
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 30
MAIN.ASM



   1654	02DC  52			 push dx
   1655	02DD  55			 push bp
   1656
   1657	02DE  E8 FFE0			 call CLEAR_SCREEN
   1658
   1659					 ; Ajusta posição da nave baseado na fase
   1660	02E1  A0 0003r			 mov al, fase
   1661	02E4  3C 03			 cmp al, 3
   1662	02E6  75 09			 jne SHIP_POS_NORMAL_RENDER
   1663	02E8  C7 06 074Dr 3E80		 mov ship_pos, ROW_SHIP_FASE3*320
   1664	02EE  EB 07 90			 jmp SHIP_POS_SET_RENDER
   1665	02F1			     SHIP_POS_NORMAL_RENDER:
   1666	02F1  C7 06 074Dr 5DC0		 mov ship_pos, ship_pos_ini
   1667	02F7			     SHIP_POS_SET_RENDER:
   1668
   1669					 ; Print Sector
   1670	02F7  33 C0			 xor ax, ax
   1671	02F9  A0 0003r			 mov al, fase
   1672
   1673	02FC  3C 04			 cmp al, 4
   1674	02FE  75 00			 jne SUM_POINTS
   1675	0300			     SUM_POINTS:
   1676	0300  FE C8			 dec al	; number vector	index
   1677
   1678	0302  33 C0			 xor ax, ax
   1679	0304  A0 0003r			 mov al, fase
   1680	0307  FE C8			 dec al	; number vector	index
   1681	0309  D0 E0			 shl al, 1 ; multiply by 2 (since num_vec values are dw)
   1682	030B  BB 09CAr			 mov bx, offset	fase_vec ; get the vector
   1683	030E  03 D8			 add bx, ax ; add the index to the vector ptr
   1684	0310  8B 2F			 mov bp, [bx] ;	set BP to base address of number
   1685	0312  B9 00C6			 mov cx, fase_string_length
   1686	0315  32 D2			 xor dl, dl; line
   1687	0317  B6 0A			 mov dh, 10
   1688
   1689	0319  B3 0B			 mov bl, 0BH ; Cor verde (se bit 1 de AL estiver limpo,	usamos BL)
   1690	031B  E8 FDB4			 call PRINT_STRING
   1691
   1692	031E  33 C9			 xor cx, cx
   1693	0320  B9 001E			 mov cx, 1Eh
   1694	0323  BA 2710			 mov dx, 2710H
   1695	0326  B4 86			 mov ah, 86H
   1696	0328  CD 15			 int 15h
   1697
   1698	032A  E8 FF94			 call CLEAR_SCREEN
   1699
   1700	032D  5D			 pop bp
   1701	032E  5A			 pop dx
   1702	032F  59			 pop cx
   1703	0330  5B			 pop bx
   1704	0331  58			 pop ax
   1705	0332  C3			 ret
   1706	0333			     endp
   1707
   1708	0333			     RENDER_TIME proc
   1709	0333  55			 push bp
   1710	0334  53			 push bx
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 31
MAIN.ASM



   1711	0335  51			 push cx
   1712	0336  52			 push dx
   1713
   1714	0337  BD 0C0Fr			 mov bp, offset	time_str
   1715	033A  B9 0006			 mov cx, time_str_len
   1716	033D  B3 0F			 mov bl, 0FH ; white
   1717	033F  32 F6			 xor dh, dh
   1718	0341  B2 1E			 mov dl, 30
   1719	0343  E8 FD8C			 call PRINT_STRING
   1720
   1721	0346  33 C0			 xor ax, ax
   1722	0348  A0 0C0Br			 mov al, time
   1723	034B  BE 0C0Dr			 mov si, offset	time_buffer
   1724	034E  83 C6 01			 add si, time_buffer_len - 1
   1725	0351  B9 0002			 mov cx, 2
   1726	0354  E8 0014			 call CONVERT_UINT16
   1727
   1728	0357  BD 0C0Dr			 mov bp, offset	time_buffer
   1729	035A  B9 0002			 mov cx, time_buffer_len
   1730	035D  B3 02			 mov bl, 02H ; green
   1731	035F  32 F6			 xor dh, dh
   1732	0361  B2 24			 mov dl, 36
   1733	0363  E8 FD6C			 call PRINT_STRING
   1734
   1735	0366  5A			 pop dx
   1736	0367  59			 pop cx
   1737	0368  5B			 pop bx
   1738	0369  5D			 pop bp
   1739
   1740	036A  C3			 ret
   1741	036B			     endp
   1742
   1743
   1744				     ; AX = uint16 value to output
   1745				     ; SI = offset of end off string buffer
   1746				     ; CX = number of digits to	write
   1747	036B			     CONVERT_UINT16 proc
   1748	036B  56			 push si
   1749	036C  50			 push ax
   1750	036D  53			 push bx
   1751	036E  51			 push cx
   1752	036F  52			 push dx
   1753
   1754	0370  BB 000A			 mov bx, 10
   1755
   1756	0373			     LOOP_DIV:
   1757	0373  33 D2			 xor dx, dx
   1758	0375  F7 F3			 div bx
   1759
   1760	0377  80 C2 30			 add dl, '0'
   1761	037A  88 14			 mov byte ptr ds:[si], dl
   1762	037C  4E			 dec si
   1763
   1764	037D  49			 dec cx
   1765	037E  75 F3			 jnz LOOP_DIV
   1766
   1767	0380  5A			 pop dx
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 32
MAIN.ASM



   1768	0381  59			 pop cx
   1769	0382  5B			 pop bx
   1770	0383  58			 pop ax
   1771	0384  5E			 pop si
   1772	0385  C3			 ret
   1773	0386			     endp
   1774
   1775				     ; Renderiza o score na parte superior esquerda
   1776	0386			     RENDER_SCORE proc
   1777	0386  56			 push si
   1778	0387  55			 push bp
   1779	0388  50			 push ax
   1780	0389  53			 push bx
   1781	038A  51			 push cx
   1782	038B  52			 push dx
   1783
   1784	038C  BD 0C1Cr			 mov bp, offset	score_str
   1785	038F  B9 0006			 mov cx, score_str_len
   1786	0392  B3 0F			 mov bl, 0FH ; branco
   1787	0394  33 D2			 xor dx, dx  ; linha 0,	coluna 0
   1788	0396  E8 FD39			 call PRINT_STRING
   1789
   1790	0399  A1 0C15r			 mov ax, score
   1791	039C  BE 0C17r			 mov si, offset	score_buffer
   1792	039F  83 C6 04			 add si, score_buffer_len - 1
   1793	03A2  B9 0005			 mov cx, score_buffer_len
   1794	03A5  E8 FFC3			 call CONVERT_UINT16
   1795
   1796	03A8  BD 0C17r			 mov bp, offset	score_buffer
   1797	03AB  B9 0005			 mov cx, score_buffer_len
   1798	03AE  B3 0A			 mov bl, 0AH ; verde claro
   1799	03B0  32 F6			 xor dh, dh
   1800	03B2  B2 07			 mov dl, 7   ; coluna 7	(após "SCORE:")
   1801	03B4  E8 FD1B			 call PRINT_STRING
   1802
   1803	03B7  5A			 pop dx
   1804	03B8  59			 pop cx
   1805	03B9  5B			 pop bx
   1806	03BA  58			 pop ax
   1807	03BB  5D			 pop bp
   1808	03BC  5E			 pop si
   1809	03BD  C3			 ret
   1810	03BE			     RENDER_SCORE endp
   1811
   1812				     ; Renderiza as vidas no centro da barra de	status
   1813	03BE			     RENDER_LIVES proc
   1814	03BE  50			 push ax
   1815	03BF  53			 push bx
   1816	03C0  51			 push cx
   1817	03C1  56			 push si
   1818	03C2  57			 push di
   1819
   1820					 ; Primeiro limpa todas	as posições possíveis de vidas (3 posições)
   1821	03C3  B9 0003			 mov cx, LIFES_START	     ; Limpa todas as 3	posições
   1822	03C6  B8 06BB			 mov ax, 5 * SCREEN_W +	123  ; Posição inicial
   1823
   1824	03C9			     CLEAR_LIVES_LOOP:
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 33
MAIN.ASM



   1825	03C9  51			 push cx
   1826	03CA  50			 push ax
   1827	03CB  8B F8			 mov di, ax
   1828	03CD  E8 FDA4			 call CLEAR_SPRITE	     ; Limpa cada sprite de vida
   1829	03D0  58			 pop ax
   1830	03D1  05 0019			 add ax, 25		     ; Próxima	posição
   1831	03D4  59			 pop cx
   1832	03D5  E2 F2			 loop CLEAR_LIVES_LOOP
   1833
   1834					 ; Agora renderiza apenas as vidas restantes
   1835	03D7  33 C9			 xor cx, cx
   1836	03D9  8A 0E 0777r		 mov cl, lives
   1837	03DD  80 F9 00			 cmp cl, 0
   1838	03E0  74 17			 je END_RENDER_LIVES
   1839
   1840					 ; Posição inicial: linha 5, centralizado
   1841					 ; Centro da tela = 160, cada vida ocupa 19 pixels + 6 de espaço = 25
   1842					 ; Para	3 vidas: 3*25 =	75 pixels, começa em 160-37 = 123
   1843	03E2  B8 06BB			 mov ax, 5 * SCREEN_W +	123  ; linha 5,	coluna 123 (centralizado)
   1844	03E5  BE 0548r			 mov si, offset	ship_sprite
   1845
   1846	03E8			     RENDER_SINGLE_LIFE:
   1847	03E8  51			 push cx
   1848	03E9  50			 push ax
   1849	03EA  56			 push si
   1850	03EB  BE 0548r			 mov si, offset	ship_sprite  ; Resetar SI para o início do sprite
   1851	03EE  E8 FD09			 call RENDER_SPRITE
   1852	03F1  5E			 pop si
   1853	03F2  58			 pop ax
   1854	03F3  05 0019			 add ax, 25  ; próxima	vida (19 pixels	+ 6 de espaço)
   1855	03F6  59			 pop cx
   1856	03F7  E2 EF			 loop RENDER_SINGLE_LIFE
   1857
   1858	03F9			     END_RENDER_LIVES:
   1859	03F9  5F			 pop di
   1860	03FA  5E			 pop si
   1861	03FB  59			 pop cx
   1862	03FC  5B			 pop bx
   1863	03FD  58			 pop ax
   1864	03FE  C3			 ret
   1865	03FF			     RENDER_LIVES endp
   1866
   1867				     ; Renderiza toda a	barra de status	(score + vidas + tempo)
   1868	03FF			     RENDER_STATUS proc
   1869	03FF  E8 FF84			 call RENDER_SCORE
   1870	0402  E8 FFB9			 call RENDER_LIVES
   1871	0405  E8 FF2B			 call RENDER_TIME
   1872	0408  C3			 ret
   1873	0409			     RENDER_STATUS endp
   1874
   1875	0409			     UPDATE_TIME proc
   1876	0409  50			 push ax
   1877	040A  53			 push bx
   1878
   1879	040B  8A 26 0C0Cr		 mov ah, timeout
   1880	040F  FE C4			 inc ah
   1881	0411  80 FC 64			 cmp ah, 100
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 34
MAIN.ASM



   1882	0414  75 6D			 jne SAVE_TIMEOUT
   1883
   1884	0416  8A 26 0C0Br		 mov ah, time
   1885	041A  FE CC			 dec ah
   1886	041C  75 37			 jnz SAVE_TIME
   1887
   1888	041E  8A 26 0003r		 mov ah, fase
   1889	0422  FE C4			 inc ah
   1890	0424  88 26 0003r		 mov fase, ah		   ; Atualiza a	fase primeiro
   1891
   1892	0428  80 FC 04			 cmp ah, 4		   ; Verifica se passou	da fase	3
   1893	042B  73 25			 jae FINISH_GAME	  ; Se sim, marca como completado
   1894
   1895					 ; Reseta o tempo para a nova fase
   1896	042D  C6 06 0C0Br 3C		 mov time, SECONDS_START
   1897
   1898					 ; Reseta aliens ao mudar de fase
   1899	0432  E8 0620			 call RESET_ALIENS
   1900
   1901					 ; Ajusta posição do terreno baseado na fase
   1902	0435  80 FC 03			 cmp ah, 3
   1903	0438  75 0C			 jne TERRAIN_POS_NORMAL_ADVANCE
   1904					 ; Fase	3: terreno mais	baixo (linha 110) e inicializa torres
   1905	043A  C7 06 A51Fr 0000		 mov terrain_pos, 0
   1906	0440  E8 02D6			 call INIT_FASE3_TOWERS
   1907	0443  EB 07 90			 jmp TERRAIN_POS_SET_ADVANCE
   1908	0446			     TERRAIN_POS_NORMAL_ADVANCE:
   1909					 ; Fases 1 e 2:	terreno	normal (linha 150)
   1910	0446  C7 06 A51Fr 0000		 mov terrain_pos, 0
   1911	044C			     TERRAIN_POS_SET_ADVANCE:
   1912
   1913	044C  E8 FE8A			 call RENDER_FASE
   1914
   1915	044F  EB 36 90			 jmp END_TIME
   1916
   1917	0452			     FINISH_GAME:
   1918					 ; Player completou todas as fases - fase agora	é 4
   1919					 ; A verificação de vitória será feita no CHECK_GAME_END
   1920	0452  EB 33 90			 jmp END_TIME
   1921
   1922	0455			     SAVE_TIME:
   1923	0455  88 26 0C0Br		 mov time, ah
   1924
   1925					 ; Adiciona pontos por segundo baseado na fase
   1926	0459  8A 1E 0003r		 mov bl, fase
   1927	045D  80 FB 01			 cmp bl, 1
   1928	0460  75 08			 jne CHECK_FASE2
   1929	0462  83 06 0C15r 0A		 add score, 10	; Fase 1: +10 pontos/segundo
   1930	0467  EB 1A 90			 jmp SAVE_TIMEOUT
   1931
   1932	046A			     CHECK_FASE2:
   1933	046A  80 FB 02			 cmp bl, 2
   1934	046D  75 08			 jne CHECK_FASE3
   1935	046F  83 06 0C15r 0F		 add score, 15	; Fase 2: +15 pontos/segundo
   1936	0474  EB 0D 90			 jmp SAVE_TIMEOUT
   1937
   1938	0477			     CHECK_FASE3:
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 35
MAIN.ASM



   1939	0477  80 FB 03			 cmp bl, 3
   1940	047A  75 07			 jne SAVE_TIMEOUT
   1941	047C  83 06 0C15r 14		 add score, 20	; Fase 3: +20 pontos/segundo
   1942
   1943	0481  32 E4			 xor ah, ah
   1944
   1945	0483			     SAVE_TIMEOUT:
   1946	0483  88 26 0C0Cr		 mov timeout, ah
   1947
   1948	0487			     END_TIME:
   1949	0487  5B			 pop bx
   1950	0488  58			 pop ax
   1951	0489  C3			 ret
   1952	048A			     endp
   1953
   1954
   1955
   1956	048A			     UPDATE_SHIP proc
   1957	048A  56			 push si
   1958	048B  57			 push di
   1959	048C  50			 push ax
   1960	048D  53			 push bx
   1961
   1962	048E  B4 01			 mov ah, 1H
   1963	0490  CD 16			 int 16H
   1964	0492  74 07			 jz END_SHIP_UPDATE
   1965
   1966	0494  E8 000F			 call HANDLE_CONTROLS
   1967	0497  32 E4			 xor ah, ah
   1968	0499  CD 16			 int 16H
   1969
   1970	049B			     END_SHIP_UPDATE:
   1971	049B  5B			 pop bx
   1972	049C  58			 pop ax
   1973	049D  5F			 pop di
   1974	049E  5E			 pop si
   1975	049F  E8 008F			 call RENDER_SHIP
   1976	04A2  E8 074D			 call RENDER_ALIENS
   1977	04A5  C3			 ret
   1978	04A6			     endp
   1979
   1980
   1981				     ; Proc para controle da nave
   1982	04A6			     HANDLE_CONTROLS proc
   1983	04A6  56			 push si
   1984	04A7  57			 push di
   1985	04A8  50			 push ax
   1986	04A9  53			 push bx
   1987	04AA  51			 push cx
   1988
   1989	04AB  BE 074Dr			 mov si, offset	ship_pos
   1990	04AE  8B 3C			 mov di, [si]
   1991
   1992	04B0  80 FC 48			 cmp ah, 48H
   1993	04B3  74 25			 je MOVE_UP
   1994
   1995	04B5  80 FC 50			 cmp ah, 50H
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 36
MAIN.ASM



   1996	04B8  74 26			 je MOVE_DOWN
   1997
   1998	04BA  80 FC 4B			 cmp ah, 4BH
   1999	04BD  74 27			 je MOVE_LEFT
   2000
   2001	04BF  80 FC 4D			 cmp ah, 4DH
   2002	04C2  74 31			 je MOVE_RIGHT
   2003
   2004	04C4  80 FC 39			 cmp ah, 39H
   2005	04C7  74 0B			 je FIRE
   2006
   2007	04C9  3C 71			 cmp al, 'q'
   2008	04CB  75 37			 jne END_CONTROLS
   2009
   2010	04CD  33 C0			 xor ax, ax
   2011	04CF  CD 16			 int 16h
   2012	04D1  E8 FDE0			 call END_GAME
   2013
   2014	04D4			     FIRE:
   2015	04D4  E8 00C9			 call SHOOT
   2016	04D7  EB 2B 90			 jmp END_CONTROLS
   2017
   2018	04DA			     MOVE_UP:
   2019	04DA  E8 04F0			 call MOVE_UP_PROC
   2020	04DD  EB 25 90			 jmp END_CONTROLS
   2021	04E0			     MOVE_DOWN:
   2022	04E0  E8 0505			 call MOVE_DOWN_PROC
   2023	04E3  EB 1F 90			 jmp END_CONTROLS
   2024	04E6			     MOVE_LEFT:
   2025	04E6  BB 074Dr			 mov bx, OFFSET	ship_pos     ; ponteiro	para posição da nave
   2026	04E9  B9 0005			 mov cx, ship_speed	     ; velocidade da nave
   2027	04EC  BA 0004			 mov dx, 4		     ; limite esquerdo
   2028	04EF  E8 0511			 call MOVE_LEFT_PROC
   2029	04F2  EB 10 90			 jmp END_CONTROLS
   2030
   2031	04F5			     MOVE_RIGHT:
   2032	04F5  BB 074Dr			 mov bx, OFFSET	ship_pos     ; ponteiro	para posição da nave
   2033	04F8  B9 0005			 mov cx, ship_speed	     ; velocidade da nave
   2034	04FB  BA 0128			 mov dx, 320 - SPR_W	     ; limite direito
   2035	04FE  E8 052B			 call MOVE_RIGHT_PROC
   2036	0501  EB 01 90			 jmp END_CONTROLS
   2037
   2038	0504			     END_CONTROLS:
   2039	0504  59			 pop cx
   2040	0505  5B			 pop bx
   2041	0506  58			 pop ax
   2042	0507  5F			 pop di
   2043	0508  5E			 pop si
   2044	0509  C3			 ret
   2045	050A			     endp
   2046
   2047				     ; AL = axis (0 is X, 1 is Y)
   2048				     ; AH = direction (0 is positive, 1	is negative)
   2049				     ; SI = position pointer
   2050				     ; BX = increment
   2051	050A			     MOVE_SPRITE proc
   2052	050A  56			 push si
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 37
MAIN.ASM



   2053	050B  50			 push ax
   2054	050C  53			 push bx
   2055
   2056	050D  8B 0C			 mov cx, [si]
   2057	050F  3C 00			 cmp al, 0
   2058	0511  75 03			 jne MOVE_Y_AXIS
   2059	0513  EB 0A 90			 jmp CHECK_DIRECTION
   2060
   2061	0516			     MOVE_Y_AXIS:
   2062	0516  50			 push ax
   2063	0517  B8 0140			 mov ax, 320
   2064	051A  F7 E3			 mul bx
   2065	051C  8B D8			 mov bx, ax
   2066	051E  58			 pop ax
   2067
   2068	051F			     CHECK_DIRECTION:
   2069	051F  80 FC 00			 cmp ah, 0
   2070	0522  75 05			 jne MOVE_NEGATIVE
   2071	0524  03 CB			 add cx, bx
   2072	0526  EB 03 90			 jmp SAVE_POS
   2073
   2074	0529			     MOVE_NEGATIVE:
   2075	0529  2B CB			 sub cx, bx
   2076
   2077	052B			     SAVE_POS:
   2078	052B  89 0C			 mov [si], cx
   2079
   2080	052D  5B			 pop bx
   2081	052E  58			 pop ax
   2082	052F  5E			 pop si
   2083	0530  C3			 ret
   2084	0531			     endp
   2085
   2086	0531			     RENDER_SHIP proc
   2087	0531  56			 push si
   2088	0532  57			 push di
   2089	0533  53			 push bx
   2090	0534  50			 push ax
   2091
   2092	0535  A1 074Dr			 mov ax, ship_pos
   2093	0538  BE 0548r			 mov si, offset	ship_sprite
   2094	053B  E8 FBBC			 call RENDER_SPRITE
   2095
   2096	053E  58			 pop ax
   2097	053F  5B			 pop bx
   2098	0540  5F			 pop di
   2099	0541  5E			 pop si
   2100	0542  C3			 ret
   2101	0543			     endp
   2102
   2103	0543			     RESET_SHIP	proc
   2104	0543  56			 push si
   2105	0544  53			 push bx
   2106
   2107	0545  C7 06 074Dr 5DC0		 mov ship_pos, ship_pos_ini ; Ship stating position
   2108
   2109	054B  5B			 pop bx
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 38
MAIN.ASM



   2110	054C  5E			 pop si
   2111	054D  C3			 ret
   2112	054E			     endp
   2113
   2114	054E			     RENDER_ALIEN proc
   2115					 ; AX =	posição na tela
   2116	054E  57			 push di
   2117	054F  53			 push bx
   2118
   2119	0550  BE 034Er			 mov si, offset	alien_sprite
   2120	0553  E8 FBA4			 call RENDER_SPRITE
   2121
   2122	0556  5B			 pop bx
   2123	0557  5F			 pop di
   2124	0558  C3			 ret
   2125	0559			     endp
   2126
   2127	0559			     RENDER_METEOR proc
   2128					 ; AX =	posição na tela
   2129	0559  57			 push di
   2130	055A  53			 push bx
   2131
   2132	055B  BE 016Er			 mov si, offset	meteor_sprite
   2133	055E  E8 FB99			 call RENDER_SPRITE
   2134
   2135	0561  5B			 pop bx
   2136	0562  5F			 pop di
   2137	0563  C3			 ret
   2138	0564			     endp
   2139
   2140				     ; Reseta o	jogo (score, vidas, fase)
   2141	0564			     RESET_GAME	proc
   2142	0564  50			 push ax
   2143	0565  51			 push cx
   2144	0566  56			 push si
   2145
   2146	0567  C7 06 0C15r 0000		 mov score, 0
   2147	056D  C6 06 0777r 03		 mov lives, LIFES_START
   2148	0572  C6 06 0003r 01		 mov fase, 1
   2149	0577  C6 06 0C0Br 3C		 mov time, SECONDS_START
   2150	057C  C6 06 0C0Cr 00		 mov timeout, 0
   2151	0581  C7 06 A51Fr 0000		 mov terrain_pos, 0
   2152
   2153					 ; Reset all shots
   2154	0587  C6 06 0756r 00		 mov byte ptr [shot_active], 0
   2155	058C  C6 06 0757r 00		 mov byte ptr [shot_active + 1], 0
   2156	0591  C6 06 0758r 00		 mov byte ptr [shot_active + 2], 0
   2157
   2158					 ; Reset aliens
   2159	0596  E8 04BC			 call RESET_ALIENS
   2160
   2161					 ; Reset fase 3	towers
   2162	0599  E8 017D			 call INIT_FASE3_TOWERS
   2163
   2164	059C  5E			 pop si
   2165	059D  59			 pop cx
   2166	059E  58			 pop ax
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 39
MAIN.ASM



   2167	059F  C3			 ret
   2168	05A0			     endp
   2169
   2170				     ; Sistema de Tiro Múltiplo (3 tiros)
   2171	05A0			     SHOOT proc
   2172	05A0  50			 push ax
   2173	05A1  53			 push bx
   2174	05A2  51			 push cx
   2175	05A3  56			 push si
   2176
   2177					 ; Procura um slot livre para o	tiro
   2178	05A4  33 C9			 xor cx, cx
   2179	05A6  8A 0E 074Fr		 mov cl, shot_count
   2180	05AA  BE 0756r			 mov si, offset	shot_active
   2181
   2182	05AD			     FIND_FREE_SHOT:
   2183	05AD  80 3C 00			 cmp byte ptr [si], 0	 ; Verifica se este slot está livre
   2184	05B0  74 06			 je FOUND_FREE_SHOT
   2185	05B2  46			 inc si			 ; Próximo slot
   2186	05B3  E2 F8			 loop FIND_FREE_SHOT
   2187	05B5  EB 24 90			 jmp END_SHOOT		; Todos	os slots ocupados
   2188
   2189	05B8			     FOUND_FREE_SHOT:
   2190					 ; Calcula o índice do	slot livre
   2191	05B8  8B C6			 mov ax, si
   2192	05BA  2D 0756r			 sub ax, offset	shot_active  ; AX = índice do slot (0 ou 1)
   2193
   2194					 ; Ativa o tiro	na posição da	nave
   2195	05BD  8B 1E 074Dr		 mov bx, ship_pos
   2196	05C1  83 C3 1D			 add bx, 29		 ; Posição no	nariz da nave (largura do sprite = 29)
   2197	05C4  81 C3 0780		 add bx, 320 * 6	 ; Ajusta para o meio vertical da nave (altura/2 ≈ 6)
   2198
   2199					 ; Armazena a posição	do tiro
   2200	05C8  D1 E0			 shl ax, 1		 ; Multiplica por 2 (words são	2 bytes)
   2201	05CA  BE 0750r			 mov si, offset	shot_pos
   2202	05CD  03 F0			 add si, ax
   2203	05CF  89 1C			 mov [si], bx
   2204
   2205					 ; Marca o tiro	como ativo
   2206	05D1  D1 E8			 shr ax, 1		 ; Volta para índice original
   2207	05D3  BE 0756r			 mov si, offset	shot_active
   2208	05D6  03 F0			 add si, ax
   2209	05D8  C6 04 01			 mov byte ptr [si], 1
   2210
   2211	05DB			     END_SHOOT:
   2212	05DB  5E			 pop si
   2213	05DC  59			 pop cx
   2214	05DD  5B			 pop bx
   2215	05DE  58			 pop ax
   2216	05DF  C3			 ret
   2217	05E0			     SHOOT endp
   2218
   2219
   2220	05E0			     UPDATE_SHOT proc
   2221	05E0  57			 push di
   2222	05E1  56			 push si
   2223	05E2  50			 push ax
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 40
MAIN.ASM



   2224	05E3  53			 push bx
   2225	05E4  51			 push cx
   2226	05E5  52			 push dx
   2227
   2228					 ; Loop	através de todos os tiros
   2229	05E6  33 C9			 xor cx, cx
   2230	05E8  8A 0E 074Fr		 mov cl, shot_count
   2231
   2232	05EC			     UPDATE_SHOT_LOOP:
   2233	05EC  51			 push cx		 ; Salva contador
   2234	05ED  49			 dec cx			 ; Converte para índice base 0
   2235
   2236					 ; Verifica se este tiro está ativo
   2237	05EE  BE 0756r			 mov si, offset	shot_active
   2238	05F1  03 F1			 add si, cx
   2239	05F3  80 3C 01			 cmp byte ptr [si], 1
   2240	05F6  75 3E			 jne NEXT_SHOT
   2241
   2242					 ; Obtém a posição do tiro
   2243	05F8  51			 push cx		 ; Salva índice
   2244	05F9  D1 E1			 shl cx, 1		 ; Multiplica por 2 (words)
   2245	05FB  BE 0750r			 mov si, offset	shot_pos
   2246	05FE  03 F1			 add si, cx
   2247	0600  8B 3C			 mov di, [si]		 ; DI =	posição atual	do tiro
   2248	0602  59			 pop cx			 ; Restaura índice
   2249
   2250					 ; Limpa a posição anterior do tiro
   2251	0603  E8 0066			 call CLEAR_SHOT_SPRITE
   2252
   2253					 ; Calcula posição X atual
   2254	0606  8B C7			 mov ax, di
   2255	0608  BB 0140			 mov bx, 320
   2256	060B  33 D2			 xor dx, dx
   2257	060D  F7 F3			 div bx
   2258					 ; DX =	posição X na linha
   2259
   2260					 ; Se posição	X >= 310, desativa o tiro (mais	conservador)
   2261	060F  81 FA 0136		 cmp dx, 310
   2262	0613  73 19			 jae DEACTIVATE_THIS_SHOT
   2263
   2264					 ; Move	o tiro para direita (2 pixels)
   2265	0615  83 C7 02			 add di, 2
   2266
   2267					 ; Atualiza posição
   2268	0618  51			 push cx
   2269	0619  D1 E1			 shl cx, 1
   2270	061B  BE 0750r			 mov si, offset	shot_pos
   2271	061E  03 F1			 add si, cx
   2272	0620  89 3C			 mov [si], di
   2273	0622  59			 pop cx
   2274
   2275					 ; Renderiza o tiro na nova posição
   2276	0623  8B C7			 mov ax, di
   2277	0625  BE 0727r			 mov si, offset	shot_sprite
   2278	0628  E8 0015			 call RENDER_SHOT_SPRITE
   2279	062B  EB 09 90			 jmp NEXT_SHOT
   2280
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 41
MAIN.ASM



   2281	062E			     DEACTIVATE_THIS_SHOT:
   2282					 ; Desativa este tiro específico
   2283	062E  BE 0756r			 mov si, offset	shot_active
   2284	0631  03 F1			 add si, cx
   2285	0633  C6 04 00			 mov byte ptr [si], 0
   2286
   2287	0636			     NEXT_SHOT:
   2288	0636  59			 pop cx			 ; Restaura contador
   2289	0637  E2 B3			 loop UPDATE_SHOT_LOOP
   2290
   2291	0639  5A			 pop dx
   2292	063A  59			 pop cx
   2293	063B  5B			 pop bx
   2294	063C  58			 pop ax
   2295	063D  5E			 pop si
   2296	063E  5F			 pop di
   2297	063F  C3			 ret
   2298	0640			     UPDATE_SHOT endp
   2299
   2300				     ; Renderiza sprite	da nave
   2301				     ; AX = posição na tela
   2302				     ; SI = offset do sprite
   2303	0640			     RENDER_SHOT_SPRITE	proc
   2304	0640  53			 push bx
   2305	0641  51			 push cx
   2306	0642  52			 push dx
   2307	0643  57			 push di
   2308	0644  06			 push es
   2309	0645  1E			 push ds
   2310	0646  50			 push ax
   2311
   2312	0647  B8 0000s			 mov ax, @data
   2313	064A  8E D8			 mov ds, ax
   2314
   2315	064C  B8 A000			 mov ax, 0A000h
   2316	064F  8E C0			 mov es, ax
   2317
   2318	0651  58			 pop ax
   2319	0652  8B F8			 mov di, ax
   2320	0654  BA 0006			 mov dx, 6		 ; Sprite do tiro tem 6	linhas de altura
   2321	0657  50			 push ax
   2322
   2323	0658			     DRAW_SHOT_LINE:
   2324	0658  B9 0006			 mov cx, 6		; Cada linha do	sprite tem 22 bytes
   2325	065B  F3> A4			 rep movsb
   2326	065D  81 C7 013A		 add di, SCREEN_W - 6	; Ajusta para próxima linha (320 - 22)
   2327	0661  4A			 dec dx
   2328	0662  75 F4			 jnz DRAW_SHOT_LINE
   2329
   2330	0664  58			 pop ax
   2331	0665  1F			 pop ds
   2332	0666  07			 pop es
   2333	0667  5F			 pop di
   2334	0668  5A			 pop dx
   2335	0669  59			 pop cx
   2336	066A  5B			 pop bx
   2337	066B  C3			 ret
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 42
MAIN.ASM



   2338	066C			     RENDER_SHOT_SPRITE	endp
   2339
   2340				     ; Limpa sprite do tiro na posição DI
   2341	066C			     CLEAR_SHOT_SPRITE proc
   2342	066C  50			 push ax
   2343	066D  51			 push cx
   2344	066E  57			 push di
   2345	066F  06			 push es
   2346
   2347	0670  B8 A000			 mov ax, 0A000h
   2348	0673  8E C0			 mov es, ax
   2349	0675  B9 0006			 mov cx, 6		 ; Altura do sprite do tiro
   2350
   2351	0678			     CLEAR_SHOT_LINE:
   2352	0678  51			 push cx
   2353	0679  B9 0006			 mov cx, 6		; Largura do sprite do tiro
   2354	067C  32 C0			 xor al, al		 ; cor 0 (preto)
   2355	067E  F3> AA			 rep stosb
   2356	0680  81 C7 013A		 add di, SCREEN_W - 6	; Próxima linha
   2357	0684  59			 pop cx
   2358	0685  E2 F1			 loop CLEAR_SHOT_LINE
   2359
   2360	0687  07			 pop es
   2361	0688  5F			 pop di
   2362	0689  59			 pop cx
   2363	068A  58			 pop ax
   2364	068B  C3			 ret
   2365	068C			     CLEAR_SHOT_SPRITE endp
   2366
   2367
   2368				     ; Renderiza o terreno baseado na fase atual
   2369	068C			     RENDER_TERRAIN proc
   2370	068C  53			 push bx
   2371	068D  51			 push cx
   2372	068E  52			 push dx
   2373	068F  57			 push di
   2374	0690  06			 push es
   2375	0691  1E			 push ds
   2376	0692  50			 push ax
   2377
   2378	0693  B8 0000s			 mov ax, @data
   2379	0696  8E D8			 mov ds, ax
   2380
   2381	0698  B8 A000			 mov ax, 0A000h
   2382	069B  8E C0			 mov es, ax
   2383
   2384					 ; Verifica se é fase 3 (usa renderização procedural)
   2385	069D  A0 0003r			 mov al, fase
   2386	06A0  3C 03			 cmp al, 3
   2387	06A2  74 49			 je RENDER_TERRAIN_FASE3
   2388
   2389					 ; Seleciona o terreno correto baseado na fase
   2390	06A4  33 C0			 xor ax, ax
   2391	06A6  A0 0003r			 mov al, fase
   2392	06A9  FE C8			 dec al			     ; fase 1->0, fase 2->1
   2393	06AB  D0 E0			 shl al, 1		     ; multiplica por 2	(offsets são words)
   2394	06AD  BB A519r			 mov bx, offset	terrain_vec
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 43
MAIN.ASM



   2395	06B0  03 D8			 add bx, ax
   2396	06B2  8B 37			 mov si, [bx]		    ; SI = offset do terreno da	fase atual
   2397
   2398					 ; DI =	posição inicial do terreno na	tela (linha 150)
   2399	06B4  BF BB80			 mov di, 320*150
   2400
   2401					 ; SI já aponta para o	offset do terreno
   2402					 ; Adiciona o scroll horizontal
   2403	06B7  03 36 A51Fr		 add si, terrain_pos
   2404
   2405					 ; Copia 50 linhas de 320 bytes
   2406	06BB  B9 0032			 mov cx, 50
   2407	06BE			     COPY_TERRAIN_LINE:
   2408	06BE  51			 push cx
   2409	06BF  56			 push si
   2410	06C0  57			 push di
   2411
   2412	06C1  B9 0140			 mov cx, 320
   2413	06C4  F3> A4			 rep movsb
   2414
   2415	06C6  5F			 pop di
   2416	06C7  5E			 pop si
   2417	06C8  59			 pop cx
   2418
   2419	06C9  81 C7 0140		 add di, 320	     ; Próxima	linha na tela
   2420	06CD  81 C6 0140		 add si, 320	     ; Próxima	linha do terreno
   2421	06D1  E2 EB			 loop COPY_TERRAIN_LINE
   2422
   2423					 ; Atualiza scroll horizontal (1 pixel por frame)
   2424	06D3  FF 06 A51Fr		 inc terrain_pos
   2425	06D7  81 3E A51Fr 0140		 cmp terrain_pos, 320  ; Se completou uma linha
   2426	06DD  7C 06			 jl TERRAIN_DONE_RENDER
   2427	06DF  C7 06 A51Fr 0000		 mov terrain_pos, 0    ; Reseta	para início
   2428
   2429	06E5			     TERRAIN_DONE_RENDER:
   2430	06E5  58			 pop ax
   2431	06E6  1F			 pop ds
   2432	06E7  07			 pop es
   2433	06E8  5F			 pop di
   2434	06E9  5A			 pop dx
   2435	06EA  59			 pop cx
   2436	06EB  5B			 pop bx
   2437	06EC  C3			 ret
   2438
   2439	06ED			     RENDER_TERRAIN_FASE3:
   2440					 ; Renderização procedural para fase 3
   2441					 ; Limpa apenas	a borda	esquerda (onde torres saem)
   2442	06ED  50			 push ax
   2443	06EE  51			 push cx
   2444	06EF  57			 push di
   2445	06F0  06			 push es
   2446
   2447	06F1  B8 A000			 mov ax, 0A000h
   2448	06F4  8E C0			 mov es, ax
   2449
   2450					 ; Limpa apenas	primeiros pixels da borda esquerda (pequena margem)
   2451	06F6  BF 5780			 mov di, 70*320
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 44
MAIN.ASM



   2452	06F9  B9 0082			 mov cx, 130
   2453	06FC			     CLEAR_LEFT_EDGE:
   2454	06FC  51			 push cx
   2455	06FD  57			 push di
   2456	06FE  B9 0005			 mov cx, 5		 ; Limpa apenas	5 pixels
   2457	0701  32 C0			 xor al, al
   2458	0703  F3> AA			 rep stosb
   2459	0705  5F			 pop di
   2460	0706  59			 pop cx
   2461	0707  81 C7 0140		 add di, 320
   2462	070B  E2 EF			 loop CLEAR_LEFT_EDGE
   2463
   2464	070D  07			 pop es
   2465	070E  5F			 pop di
   2466	070F  59			 pop cx
   2467	0710  58			 pop ax
   2468
   2469					 ; Atualiza e renderiza	torres
   2470	0711  E8 0047			 call UPDATE_FASE3_TOWERS
   2471	0714  E8 00C1			 call RENDER_FASE3_TOWERS
   2472
   2473	0717  EB CC			 jmp TERRAIN_DONE_RENDER
   2474
   2475	0719			     endp
   2476
   2477
   2478				     ; Inicializa sistema de torres da fase 3
   2479				     ; Cria torres iniciais distribuídas pela tela
   2480	0719			     INIT_FASE3_TOWERS proc
   2481	0719  50			 push ax
   2482	071A  53			 push bx
   2483	071B  51			 push cx
   2484	071C  52			 push dx
   2485
   2486					 ; Inicializa torres preenchendo a tela	toda (da direita para esquerda)
   2487	071D  33 DB			 xor bx, bx
   2488	071F  BA 0140			 mov dx, 320			  ; Começa em X = 320 (borda direita)
   2489	0722  B9 000C			 mov cx, MAX_TOWERS		  ; 12 torres x	34 pixels = 408	pixels (cobre tela e mais)
   2490
   2491	0725			     INIT_TOWER_LOOP:
   2492					 ; Ativa torre
   2493	0725  C6 87 A545r 01		 mov byte ptr tower_active[bx],	1
   2494
   2495					 ; Define posição X
   2496	072A  53			 push bx
   2497	072B  D1 E3			 shl bx, 1		       ; BX = BX * 2
   2498	072D  89 97 A52Dr		 mov word ptr tower_x_pos[bx], dx
   2499	0731  5B			 pop bx
   2500
   2501					 ; Altura aleatória (3	a 6 andares para início)
   2502	0732  53			 push bx
   2503	0733  51			 push cx
   2504	0734  52			 push dx
   2505	0735  E8 F9EE			 call RANDOM_UINT16
   2506	0738  25 0003			 and ax, 3		 ; 0-3
   2507	073B  04 03			 add al, 3		 ; 3-6 andares
   2508	073D  5A			 pop dx
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 45
MAIN.ASM



   2509	073E  59			 pop cx
   2510	073F  5B			 pop bx
   2511	0740  88 87 A521r		 mov byte ptr tower_heights[bx], al
   2512
   2513					 ; Próxima torre colada (BASE_WIDTH pixels à esquerda)
   2514	0744  83 EA 22			 sub dx, BASE_WIDTH
   2515
   2516	0747  43			 inc bx
   2517	0748  E2 DB			 loop INIT_TOWER_LOOP
   2518
   2519					 ; Reseta contadores
   2520					 ; Contador em 0 porque	a primeira torre já está no ciclo correto
   2521	074A  C7 06 A551r 0140		 mov next_tower_x, 320
   2522	0750  C7 06 A553r 0000		 mov tower_spawn_counter, 0
   2523
   2524	0756  5A			 pop dx
   2525	0757  59			 pop cx
   2526	0758  5B			 pop bx
   2527	0759  58			 pop ax
   2528	075A  C3			 ret
   2529	075B			     INIT_FASE3_TOWERS endp
   2530
   2531
   2532				     ; Atualiza	posição das torres e gera novas
   2533	075B			     UPDATE_FASE3_TOWERS proc
   2534	075B  50			 push ax
   2535	075C  53			 push bx
   2536	075D  51			 push cx
   2537	075E  52			 push dx
   2538
   2539					 ; Move	todas as torres	para esquerda
   2540	075F  33 DB			 xor bx, bx
   2541	0761  B9 000C			 mov cx, MAX_TOWERS
   2542	0764			     MOVE_TOWERS_LOOP:
   2543	0764  80 BF A545r 00		 cmp byte ptr tower_active[bx],	0
   2544	0769  74 1C			 je SKIP_MOVE_TOWER
   2545
   2546					 ; Calcula offset para tower_x_pos (word array)
   2547	076B  53			 push bx
   2548	076C  D1 E3			 shl bx, 1		       ; BX = BX * 2
   2549
   2550					 ; Move	torre 1	pixel para esquerda
   2551	076E  FF 8F A52Dr		 dec word ptr tower_x_pos[bx]
   2552
   2553					 ; Verifica se saiu pela esquerda (X < -40)
   2554	0772  8B 87 A52Dr		 mov ax, word ptr tower_x_pos[bx]
   2555	0776  5B			 pop bx
   2556
   2557					 ; Se X	>= 0, continua
   2558	0777  85 C0			 test ax, ax
   2559	0779  79 0C			 jns SKIP_MOVE_TOWER
   2560
   2561					 ; X é	negativo, converte para	positivo e verifica
   2562	077B  F7 D8			 neg ax
   2563	077D  3D 0028			 cmp ax, 40
   2564	0780  7C 05			 jl SKIP_MOVE_TOWER
   2565
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 46
MAIN.ASM



   2566					 ; Torre saiu pela esquerda, desativa e	será respawnada
   2567	0782  C6 87 A545r 00		 mov byte ptr tower_active[bx],	0
   2568
   2569	0787			     SKIP_MOVE_TOWER:
   2570	0787  43			 inc bx
   2571	0788  E2 DA			 loop MOVE_TOWERS_LOOP
   2572
   2573					 ; Verifica se deve gerar nova torre
   2574	078A  FF 06 A553r		 inc tower_spawn_counter
   2575	078E  A1 A553r			 mov ax, tower_spawn_counter
   2576	0791  3D 0022			 cmp ax, tower_min_spacing
   2577	0794  7C 09			 jl SKIP_SPAWN_TOWER	     ; Pula se counter < 34
   2578
   2579					 ; Reseta contador e gera nova torre
   2580	0796  C7 06 A553r 0000		 mov tower_spawn_counter, 0
   2581	079C  E8 0005			 call SPAWN_FASE3_TOWER
   2582
   2583	079F			     SKIP_SPAWN_TOWER:
   2584	079F  5A			 pop dx
   2585	07A0  59			 pop cx
   2586	07A1  5B			 pop bx
   2587	07A2  58			 pop ax
   2588	07A3  C3			 ret
   2589	07A4			     UPDATE_FASE3_TOWERS endp
   2590
   2591
   2592				     ; Gera uma	nova torre aleatória
   2593	07A4			     SPAWN_FASE3_TOWER proc
   2594	07A4  50			 push ax
   2595	07A5  53			 push bx
   2596	07A6  51			 push cx
   2597
   2598					 ; Procura slot	vazio
   2599	07A7  33 DB			 xor bx, bx
   2600	07A9  B9 000C			 mov cx, MAX_TOWERS
   2601	07AC			     FIND_EMPTY_SLOT:
   2602	07AC  80 BF A545r 00		 cmp byte ptr tower_active[bx],	0
   2603	07B1  74 06			 je FOUND_EMPTY_SLOT
   2604	07B3  43			 inc bx
   2605	07B4  E2 F6			 loop FIND_EMPTY_SLOT
   2606	07B6  EB 1C 90			 jmp SPAWN_DONE	 ; Sem slots vazios
   2607
   2608	07B9			     FOUND_EMPTY_SLOT:
   2609					 ; Ativa torre
   2610	07B9  C6 87 A545r 01		 mov byte ptr tower_active[bx],	1
   2611
   2612					 ; Posição X inicial (320 para spawnar fora e	aparecer gradualmente)
   2613	07BE  53			 push bx
   2614	07BF  D1 E3			 shl bx, 1		       ; BX = BX * 2
   2615	07C1  C7 87 A52Dr 0140		 mov word ptr tower_x_pos[bx], 320  ; X	= 320 (fora da tela)
   2616	07C7  5B			 pop bx
   2617
   2618					 ; Gera	altura aleatória (2 a 8 andares)
   2619	07C8  E8 F95B			 call RANDOM_UINT16
   2620	07CB  25 0007			 and ax, 7	  ; AX = 0-7
   2621	07CE  04 02			 add al, 2	  ; AL = 2-9
   2622	07D0  88 87 A521r		 mov byte ptr tower_heights[bx], al
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 47
MAIN.ASM



   2623
   2624	07D4			     SPAWN_DONE:
   2625	07D4  59			 pop cx
   2626	07D5  5B			 pop bx
   2627	07D6  58			 pop ax
   2628	07D7  C3			 ret
   2629	07D8			     SPAWN_FASE3_TOWER endp
   2630
   2631
   2632				     ; Renderiza todas as torres ativas
   2633	07D8			     RENDER_FASE3_TOWERS proc
   2634	07D8  50			 push ax
   2635	07D9  53			 push bx
   2636	07DA  51			 push cx
   2637	07DB  52			 push dx
   2638	07DC  56			 push si
   2639	07DD  57			 push di
   2640
   2641	07DE  33 DB			 xor bx, bx
   2642	07E0  B9 000C			 mov cx, MAX_TOWERS
   2643	07E3			     RENDER_TOWERS_LOOP:
   2644	07E3  80 BF A545r 00		 cmp byte ptr tower_active[bx],	0
   2645	07E8  74 17			 je SKIP_RENDER_TOWER
   2646
   2647					 ; Renderiza esta torre
   2648	07EA  53			 push bx
   2649	07EB  51			 push cx
   2650
   2651	07EC  32 E4			 xor ah, ah
   2652	07EE  8A 87 A521r		 mov al, byte ptr tower_heights[bx]
   2653	07F2  8B C8			 mov cx, ax			 ; CX =	altura em andares
   2654
   2655					 ; Calcula offset para tower_x_pos (word array)
   2656	07F4  53			 push bx
   2657	07F5  D1 E3			 shl bx, 1		       ; BX = BX * 2
   2658	07F7  8B 97 A52Dr		 mov dx, word ptr tower_x_pos[bx]  ; DX	= posição X
   2659	07FB  5B			 pop bx
   2660
   2661	07FC  E8 000C			 call RENDER_TOWER
   2662
   2663	07FF  59			 pop cx
   2664	0800  5B			 pop bx
   2665
   2666	0801			     SKIP_RENDER_TOWER:
   2667	0801  43			 inc bx
   2668	0802  E2 DF			 loop RENDER_TOWERS_LOOP
   2669
   2670	0804  5F			 pop di
   2671	0805  5E			 pop si
   2672	0806  5A			 pop dx
   2673	0807  59			 pop cx
   2674	0808  5B			 pop bx
   2675	0809  58			 pop ax
   2676	080A  C3			 ret
   2677	080B			     RENDER_FASE3_TOWERS endp
   2678
   2679
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 48
MAIN.ASM



   2680				     ; Renderiza uma torre na posição	especificada
   2681				     ; Entrada:	CX = altura (número de	andares), DX = posição X
   2682	080B			     RENDER_TOWER proc
   2683	080B  50			 push ax
   2684	080C  53			 push bx
   2685	080D  51			 push cx
   2686	080E  52			 push dx
   2687	080F  56			 push si
   2688	0810  57			 push di
   2689	0811  55			 push bp
   2690	0812  06			 push es
   2691
   2692					 ; Garante direção forward para movsb
   2693	0813  FC			 cld
   2694
   2695					 ; Configura ES	para apontar para memória de vídeo
   2696	0814  B8 A000			 mov ax, 0A000h
   2697	0817  8E C0			 mov es, ax
   2698
   2699					 ; Verifica se torre está visível (permite renderização parcial)
   2700	0819  83 FA DE			 cmp dx, -BASE_WIDTH
   2701	081C  7C 09			 jl TOWER_NOT_VISIBLE_JMP
   2702	081E  81 FA 0140		 cmp dx, 320
   2703	0822  7D 03			 jge TOWER_NOT_VISIBLE_JMP
   2704	0824  EB 04 90			 jmp TOWER_VISIBLE
   2705
   2706	0827			     TOWER_NOT_VISIBLE_JMP:
   2707	0827  E9 00C2			 jmp TOWER_NOT_VISIBLE
   2708
   2709	082A			     TOWER_VISIBLE:
   2710
   2711	082A  51			 push cx		 ; Salva altura	da torre original
   2712
   2713					 ; Calcula clipping horizontal usando variáveis globais
   2714					 ; DX =	X da torre (pode ser negativo)
   2715	082B  C7 06 A555r 0000		 mov tower_sprite_offset, 0
   2716	0831  B8 0022			 mov ax, BASE_WIDTH
   2717	0834  A3 A557r			 mov tower_render_width, ax
   2718
   2719					 ; Verifica se X < 0 (saindo pela esquerda)
   2720	0837  83 FA 00			 cmp dx, 0
   2721	083A  7D 16			 jge CLIP_RIGHT_CHECK
   2722
   2723					 ; X negativo: calcula offset e	ajusta
   2724	083C  8B C2			 mov ax, dx
   2725	083E  F7 D8			 neg ax			     ; AX = |X|
   2726	0840  A3 A555r			 mov tower_sprite_offset, ax ; Offset =	|X|
   2727	0843  BB 0022			 mov bx, BASE_WIDTH
   2728	0846  2B D8			 sub bx, ax		     ; BX = largura - offset
   2729	0848  89 1E A557r		 mov tower_render_width, bx
   2730	084C  BA 0000			 mov dx, 0		     ; Desenha a partir	de X=0
   2731	084F  EB 13 90			 jmp CLIP_DONE
   2732
   2733	0852			     CLIP_RIGHT_CHECK:
   2734					 ; Verifica se ultrapassa borda	direita
   2735	0852  8B C2			 mov ax, dx
   2736	0854  05 0022			 add ax, BASE_WIDTH
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 49
MAIN.ASM



   2737	0857  3D 0140			 cmp ax, 320
   2738	085A  7E 08			 jle CLIP_DONE
   2739					 ; Ajusta largura
   2740	085C  B8 0140			 mov ax, 320
   2741	085F  2B C2			 sub ax, dx		     ; AX = 320	- X
   2742	0861  A3 A557r			 mov tower_render_width, ax
   2743
   2744	0864			     CLIP_DONE:
   2745
   2746					 ; Calcula posição Y inicial (topo da	torre)
   2747					 ; Y_topo = ROW_TERRAIN_FASE3 -	(altura	* BASE_HEIGHT)
   2748	0864  8B C1			 mov ax, cx
   2749	0866  B3 08			 mov bl, BASE_HEIGHT
   2750	0868  F6 E3			 mul bl			 ; AX =	altura * BASE_HEIGHT (tamanho total em pixels)
   2751	086A  BB 0096			 mov bx, ROW_TERRAIN_FASE3
   2752	086D  2B D8			 sub bx, ax		 ; BX =	linha do terreno - altura total
   2753
   2754					 ; Permite torres altas	que começam acima da tela
   2755	086F  83 FB 00			 cmp bx, 0
   2756	0872  7D 02			 jge TOWER_Y_OK
   2757	0874  33 DB			 xor bx, bx		 ; Y inicial = 0
   2758	0876			     TOWER_Y_OK:
   2759
   2760					 ; Calcula offset linear: Y * 320 + X
   2761	0876  52			 push dx		 ; Salva X na stack
   2762	0877  8B C3			 mov ax, bx		 ; AX =	Y inicial (topo	da torre)
   2763	0879  BB 0140			 mov bx, 320
   2764	087C  F7 E3			 mul bx			 ; DX:AX = Y * 320
   2765	087E  5B			 pop bx			 ; BX =	X
   2766	087F  03 C3			 add ax, bx		 ; AX =	Y * 320	+ X
   2767	0881  8B F8			 mov di, ax		 ; DI =	posição inicial
   2768
   2769					 ; Calcula total de andares a renderizar
   2770	0883  58			 pop ax			 ; AX =	altura original	da torre
   2771	0884  8B E8			 mov bp, ax		 ; BP =	altura da torre
   2772	0886  05 0006			 add ax, 6		 ; +6 andares de preenchimento
   2773	0889  8B C8			 mov cx, ax		 ; CX =	total de andares
   2774
   2775	088B			     RENDER_FLOOR_LOOP:
   2776	088B  51			 push cx
   2777	088C  55			 push bp
   2778
   2779					 ; Verifica se é o primeiro andar (topo da torre)
   2780					 ; CX começa com o valor máximo (altura + 6)
   2781	088D  8B C5			 mov ax, bp
   2782	088F  05 0006			 add ax, 6		 ; Total de andares
   2783	0892  3B C8			 cmp cx, ax
   2784	0894  5D			 pop bp
   2785	0895  75 24			 jne RENDER_BASE_ANDAR_2
   2786
   2787					 ; Renderiza TOPO
   2788	0897  57			 push di
   2789	0898  BE A409r			 mov si, offset	topo
   2790
   2791					 ; Adiciona offset do sprite (pixels a pular)
   2792	089B  03 36 A555r		 add si, tower_sprite_offset
   2793
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 50
MAIN.ASM



   2794	089F  B9 0008			 mov cx, BASE_HEIGHT
   2795	08A2			     RENDER_TOP_LINE_LOOP:
   2796	08A2  51			 push cx
   2797	08A3  57			 push di
   2798	08A4  56			 push si
   2799
   2800	08A5  8B 0E A557r		 mov cx, tower_render_width  ; Largura a renderizar
   2801	08A9  F3> A4			 rep movsb		     ; Copia CX	pixels
   2802
   2803	08AB  5E			 pop si
   2804	08AC  83 C6 22			 add si, BASE_WIDTH	     ; Próxima	linha do sprite
   2805	08AF  5F			 pop di
   2806	08B0  59			 pop cx
   2807	08B1  81 C7 0140		 add di, 320		     ; Próxima	linha da tela
   2808	08B5  E2 EB			 loop RENDER_TOP_LINE_LOOP
   2809	08B7  5F			 pop di
   2810	08B8  EB 22 90			 jmp NEXT_FLOOR
   2811
   2812	08BB			     RENDER_BASE_ANDAR_2:
   2813					 ; Renderiza andar da BASE (usado tanto	para torre quanto preenchimento)
   2814	08BB  57			 push di
   2815	08BC  BE A2F9r			 mov si, offset	base
   2816
   2817					 ; Adiciona offset do sprite (pixels a pular)
   2818	08BF  03 36 A555r		 add si, tower_sprite_offset
   2819
   2820	08C3  B9 0008			 mov cx, BASE_HEIGHT
   2821	08C6			     RENDER_BASE_LINE_LOOP:
   2822	08C6  51			 push cx
   2823	08C7  57			 push di
   2824	08C8  56			 push si
   2825
   2826	08C9  8B 0E A557r		 mov cx, tower_render_width  ; Largura a renderizar
   2827	08CD  F3> A4			 rep movsb		     ; Copia CX	pixels
   2828
   2829	08CF  5E			 pop si
   2830	08D0  83 C6 22			 add si, BASE_WIDTH	     ; Próxima	linha do sprite
   2831	08D3  5F			 pop di
   2832	08D4  59			 pop cx
   2833	08D5  81 C7 0140		 add di, 320		     ; Próxima	linha da tela
   2834	08D9  E2 EB			 loop RENDER_BASE_LINE_LOOP
   2835	08DB  5F			 pop di
   2836
   2837	08DC			     NEXT_FLOOR:
   2838					 ; Move	para o próximo	andar (descendo	na tela)
   2839	08DC  B8 0008			 mov ax, BASE_HEIGHT
   2840	08DF  BB 0140			 mov bx, 320
   2841	08E2  F7 E3			 mul bx
   2842	08E4  03 F8			 add di, ax	     ; DI += BASE_HEIGHT * 320
   2843
   2844	08E6  59			 pop cx
   2845	08E7  E2 A2			 loop RENDER_FLOOR_LOOP
   2846	08E9  EB 01 90			 jmp TOWER_DONE
   2847
   2848	08EC			     TOWER_NOT_VISIBLE:
   2849					 ; Torre não visível,	não faz nada
   2850
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 51
MAIN.ASM



   2851	08EC			     TOWER_DONE:
   2852	08EC  07			 pop es
   2853	08ED  5D			 pop bp
   2854	08EE  5F			 pop di
   2855	08EF  5E			 pop si
   2856	08F0  5A			 pop dx
   2857	08F1  59			 pop cx
   2858	08F2  5B			 pop bx
   2859	08F3  58			 pop ax
   2860	08F4  C3			 ret
   2861	08F5			     RENDER_TOWER endp
   2862
   2863				     ; Exibe tela de Game Over (vidas =	0)
   2864	08F5			     SHOW_GAME_OVER proc
   2865	08F5  50			 push ax
   2866	08F6  53			 push bx
   2867	08F7  51			 push cx
   2868	08F8  52			 push dx
   2869	08F9  56			 push si
   2870
   2871	08FA  E8 F9C4			 call CLEAR_SCREEN
   2872	08FD  33 C9			 xor cx, cx
   2873	08FF  B9 001E			 mov cx, 1Eh
   2874	0902  BA 2710			 mov dx, 2710H
   2875	0905  B4 86			 mov ah, 86H
   2876	0907  CD 15			 int 15h
   2877					 ; Configura ES	para apontar para o segmento de	dados
   2878	0909  8C D8			 mov ax, ds
   2879	090B  8E C0			 mov es, ax
   2880
   2881					 ; Exibe mensagem Game Over em vermelho
   2882	090D  BD 09D0r			 mov bp, offset	game_over_msg
   2883	0910  B9 0122			 mov cx, game_over_msg_length ;	tamanho
   2884	0913  B3 0C			 mov bl, 0Ch	 ; cor vermelha
   2885	0915  BA 03C0			 mov dx, 320*3 ; linha / coluna
   2886	0918  E8 F7B7			 call PRINT_STRING
   2887
   2888					 ; ; Move cursor para baixo
   2889					 ; mov ah, 02h
   2890					 ; mov bh, 0
   2891					 ; mov dh, 15	   ; linha 15
   2892					 ; mov dl, 5	   ; coluna 5
   2893					 ; int 10h
   2894
   2895					 ; Exibe mensagem para pressionar tecla	em branco
   2896					 ; mov bp, offset press_key_msg
   2897					 ; mov cx, 999	   ; tamanho grande
   2898					 ; mov bl, 0Fh	   ; cor branca
   2899					 ; call	PRINT_STRING
   2900
   2901	091B  BD 0BE2r			 mov bp, offset	press_key_msg
   2902	091E  B9 001B			 mov cx, press_key_msg_length ;	tamanho	correto
   2903	0921  B3 0F			 mov bl, 0Fh	 ; cor branca
   2904	0923  BA 1680			 mov dx, 320*18	; linha	18, coluna 8 (centralizado)
   2905	0926  E8 F7A9			 call PRINT_STRING
   2906
   2907					 ; Aguarda tecla
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 52
MAIN.ASM



   2908	0929  E8 0077			 call WAIT_KEY
   2909	092C  E8 0074			 call WAIT_KEY
   2910	092F  E8 F98F			 call CLEAR_SCREEN
   2911
   2912	0932  5E			 pop si
   2913	0933  5A			 pop dx
   2914	0934  59			 pop cx
   2915	0935  5B			 pop bx
   2916	0936  58			 pop ax
   2917	0937  C3			 ret
   2918	0938			     SHOW_GAME_OVER endp
   2919
   2920				     ; Exibe tela de Vitória (completou todas as fases)
   2921	0938			     SHOW_VICTORY proc
   2922	0938  50			 push ax
   2923	0939  53			 push bx
   2924	093A  51			 push cx
   2925	093B  52			 push dx
   2926	093C  56			 push si
   2927
   2928	093D  E8 F981			 call CLEAR_SCREEN
   2929	0940  33 C9			 xor cx, cx
   2930	0942  B9 001E			 mov cx, 1Eh
   2931	0945  BA 2710			 mov dx, 2710H
   2932	0948  B4 86			 mov ah, 86H
   2933	094A  CD 15			 int 15h
   2934					 ; Configura ES	para apontar para o segmento de	dados
   2935	094C  8C D8			 mov ax, ds
   2936	094E  8E C0			 mov es, ax
   2937
   2938					 ; Exibe mensagem Vencedor em verde
   2939	0950  BD 0AF2r			 mov bp, offset	vencedor_msg
   2940	0953  B9 00F0			 mov cx, vencedor_msg_length ; tamanho correto
   2941	0956  B3 0A			 mov bl, 0Ah	 ; cor verde
   2942	0958  BA 0640			 mov dx, 320*5 ; linha 5
   2943	095B  E8 F774			 call PRINT_STRING
   2944
   2945					 ; Exibe score final em	branco
   2946	095E  BD 0BFDr			 mov bp, offset	final_score_msg
   2947	0961  B9 000E			 mov cx, final_score_msg_length	; tamanho correto
   2948	0964  B3 0F			 mov bl, 0Fh	 ; cor branca
   2949	0966  BA 0F0A			 mov dx, 320*12	+ 10 ; linha 12, coluna	15 (centralizado)
   2950	0969  E8 F766			 call PRINT_STRING
   2951
   2952					 ; Converte e exibe o score
   2953	096C  A1 0C15r			 mov ax, score
   2954	096F  BE 0C1Br			 mov si, offset	score_buffer + 4  ; final do buffer
   2955	0972  B9 0005			 mov cx, 5			  ; 5 dígitos
   2956	0975  E8 F9F3			 call CONVERT_UINT16
   2957
   2958	0978  BD 0C17r			 mov bp, offset	score_buffer
   2959	097B  B9 0005			 mov cx, 5	 ; 5 dígitos
   2960	097E  B3 0F			 mov bl, 0Fh	 ; cor branca
   2961	0980  BA 0F17			 mov dx, 320*12	+ 23 ; linha 12, coluna	28 (logo após "SCORE FINAL: ")
   2962	0983  E8 F74C			 call PRINT_STRING
   2963
   2964					 ; Exibe mensagem para pressionar tecla
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 53
MAIN.ASM



   2965	0986  BD 0BE2r			 mov bp, offset	press_key_msg
   2966	0989  B9 001B			 mov cx, press_key_msg_length ;	tamanho	correto
   2967	098C  B3 0F			 mov bl, 0Fh	 ; cor branca
   2968	098E  BA 1680			 mov dx, 320*18	; linha	18, coluna 8 (centralizado)
   2969	0991  E8 F73E			 call PRINT_STRING
   2970					 ; Aguarda tecla
   2971	0994  E8 000C			 call WAIT_KEY
   2972	0997  E8 0009			 call WAIT_KEY
   2973	099A  E8 F924			 call CLEAR_SCREEN
   2974	099D  5E			 pop si
   2975	099E  5A			 pop dx
   2976	099F  59			 pop cx
   2977	09A0  5B			 pop bx
   2978	09A1  58			 pop ax
   2979	09A2  C3			 ret
   2980	09A3			     SHOW_VICTORY endp
   2981
   2982				     ; Aguarda qualquer	tecla ser pressionada
   2983	09A3			     WAIT_KEY proc
   2984	09A3  50			 push ax
   2985
   2986	09A4			     WAIT_KEY_LOOP:
   2987	09A4  B4 01			 mov ah, 01h	 ; verifica se há tecla disponível
   2988	09A6  CD 16			 int 16h
   2989	09A8  74 FA			 jz WAIT_KEY_LOOP  ; se	não há tecla,	continua aguardando
   2990
   2991	09AA  B4 00			 mov ah, 00h	 ; lê a tecla
   2992	09AC  CD 16			 int 16h
   2993
   2994	09AE  58			 pop ax
   2995	09AF  C3			 ret
   2996	09B0			     WAIT_KEY endp
   2997
   2998				     ; Verifica	condições de fim de jogo
   2999				     ; Retorna:	AL = 0 (continua), 1 (game over), 2 (vitória)
   3000	09B0			     CHECK_GAME_END proc
   3001	09B0  53			 push bx
   3002
   3003					 ; Verifica se perdeu todas as vidas
   3004	09B1  80 3E 0777r 00		 cmp lives, 0
   3005	09B6  74 0C			 je GAME_OVER_CONDITION
   3006
   3007					 ; Verifica se completou todas as fases	(fase >	3)
   3008	09B8  80 3E 0003r 03		 cmp fase, 3
   3009	09BD  77 0A			 ja VICTORY_CONDITION
   3010
   3011					 ; Jogo	continua
   3012	09BF  B0 00			 mov al, 0
   3013	09C1  EB 08 90			 jmp END_CHECK
   3014
   3015	09C4			     GAME_OVER_CONDITION:
   3016	09C4  B0 01			 mov al, 1
   3017	09C6  EB 03 90			 jmp END_CHECK
   3018
   3019	09C9			     VICTORY_CONDITION:
   3020	09C9  B0 02			 mov al, 2
   3021
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 54
MAIN.ASM



   3022	09CB			     END_CHECK:
   3023	09CB  5B			 pop bx
   3024	09CC  C3			 ret
   3025	09CD			     CHECK_GAME_END endp
   3026
   3027	09CD			     MOVE_UP_PROC proc
   3028	09CD  57			 push di
   3029	09CE  56			 push si
   3030	09CF  50			 push ax
   3031
   3032					 ; Verifica limites
   3033	09D0  8B 1E 074Dr		 mov bx, [ship_pos]
   3034	09D4  81 FB 192F		 cmp bx, 320 * 20 + 47
   3035	09D8  72 0A			 jb END_UP
   3036
   3037					 ; Move	a nave
   3038	09DA  B0 01			 mov al, 1
   3039	09DC  B4 01			 mov ah, 1
   3040	09DE  BB 0005			 mov bx, ship_speed
   3041	09E1  E8 FB26			 call MOVE_SPRITE
   3042
   3043
   3044	09E4			     END_UP:
   3045	09E4  58			 pop ax
   3046	09E5  5E			 pop si
   3047	09E6  5F			 pop di
   3048	09E7  C3			 ret
   3049	09E8			     endp
   3050
   3051	09E8			     MOVE_DOWN_PROC proc
   3052	09E8  57			 push di
   3053	09E9  56			 push si
   3054	09EA  50			 push ax
   3055
   3056					 ; Verifica limites (até linha	135, deixando espaço antes do terreno)
   3057	09EB  8B 1E 074Dr		 mov bx, [ship_pos]
   3058	09EF  81 FB A8C0		 cmp bx, 320 * 135
   3059	09F3  73 0A			 jae END_DOWN
   3060
   3061					 ; Move	a nave
   3062	09F5  B0 01			 mov al, 1
   3063	09F7  32 E4			 xor ah, ah
   3064	09F9  BB 0005			 mov bx, ship_speed
   3065	09FC  E8 FB0B			 call MOVE_SPRITE
   3066
   3067
   3068	09FF			     END_DOWN:
   3069	09FF  58			 pop ax
   3070	0A00  5E			 pop si
   3071	0A01  5F			 pop di
   3072	0A02  C3			 ret
   3073	0A03			     endp
   3074
   3075	0A03			     MOVE_LEFT_PROC proc
   3076					 ; Entradas:
   3077					 ;   BX	= ponteiro para	posição (ex.:	OFFSET ship_pos)
   3078					 ;   CX	= velocidade (ex.: ship_speed)
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 55
MAIN.ASM



   3079					 ;   DX	= limite esquerdo (ex.:	4)
   3080	0A03  57			 push di
   3081	0A04  56			 push si
   3082	0A05  50			 push ax
   3083	0A06  52			 push dx
   3084	0A07  51			 push cx
   3085	0A08  55			 push bp
   3086
   3087	0A09  8B E9			 mov bp, cx		 ; BP =	velocidade
   3088	0A0B  8B FA			 mov di, dx		 ; DI =	limite esquerdo
   3089
   3090					 ; Verifica limites: x = pos % 320
   3091	0A0D  8B 07			 mov ax, [bx]		 ; AX =	posição atual
   3092	0A0F  33 D2			 xor dx, dx
   3093	0A11  B9 0140			 mov cx, 320
   3094	0A14  F7 F1			 div cx			 ; DX =	coordenada X
   3095
   3096	0A16  3B D7			 cmp dx, di		 ; compara com limite esquerdo
   3097	0A18  76 0B			 jbe END_LEFT
   3098
   3099					 ; Move	para a esquerda
   3100	0A1A  8B F3			 mov si, bx		 ; SI =	ponteiro para posição
   3101	0A1C  B4 01			 mov ah, 1		 ; direção negativa (esquerda)
   3102	0A1E  8B DD			 mov bx, bp		 ; BX =	velocidade
   3103	0A20  B0 00			 mov al, 0		 ; eixo	X
   3104	0A22  E8 FAE5			 call MOVE_SPRITE
   3105
   3106	0A25			     END_LEFT:
   3107	0A25  5D			 pop bp
   3108	0A26  59			 pop cx
   3109	0A27  5A			 pop dx
   3110	0A28  58			 pop ax
   3111	0A29  5E			 pop si
   3112	0A2A  5F			 pop di
   3113	0A2B  C3			 ret
   3114	0A2C			     endp
   3115
   3116	0A2C			     MOVE_RIGHT_PROC proc
   3117					 ; Entradas:
   3118					 ;   BX	= ponteiro para	posição (ex.:	OFFSET alien_pos)
   3119					 ;   CX	= velocidade (ex.: 1)
   3120					 ;   DX	= limite direito em coordenada X (ex.: 320-SPR_W)
   3121	0A2C  57			 push di
   3122	0A2D  56			 push si
   3123	0A2E  50			 push ax
   3124	0A2F  52			 push dx
   3125	0A30  51			 push cx
   3126	0A31  55			 push bp
   3127
   3128	0A32  8B E9			 mov bp, cx		 ; BP =	velocidade
   3129	0A34  8B FA			 mov di, dx		 ; DI =	limite direito
   3130
   3131					 ; Verifica limites: x = pos % 320
   3132	0A36  8B 07			 mov ax, [bx]		 ; AX =	posição atual
   3133	0A38  33 D2			 xor dx, dx
   3134	0A3A  B9 0140			 mov cx, 320
   3135	0A3D  F7 F1			 div cx			 ; DX =	coordenada X
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 56
MAIN.ASM



   3136
   3137	0A3F  3B D7			 cmp dx, di		 ; compara com limite direito
   3138	0A41  73 0B			 jae END_RIGHT
   3139
   3140					 ; Move	para a direita
   3141	0A43  8B F3			 mov si, bx		 ; SI =	ponteiro para posição
   3142	0A45  32 E4			 xor ah, ah		 ; direção positiva (direita)
   3143	0A47  8B DD			 mov bx, bp		 ; BX =	velocidade
   3144	0A49  B0 00			 mov al, 0		 ; eixo	X
   3145	0A4B  E8 FABC			 call MOVE_SPRITE
   3146
   3147	0A4E			     END_RIGHT:
   3148	0A4E  5D			 pop bp
   3149	0A4F  59			 pop cx
   3150	0A50  5A			 pop dx
   3151	0A51  58			 pop ax
   3152	0A52  5E			 pop si
   3153	0A53  5F			 pop di
   3154	0A54  C3			 ret
   3155	0A55			     endp
   3156
   3157				     ; ==================== SISTEMA DE ALIENS (PADRÃO K-STAR PATROL) ====================
   3158
   3159				     ; Reseta sistema de aliens
   3160	0A55			     RESET_ALIENS proc
   3161	0A55  50			 push ax
   3162	0A56  53			 push bx
   3163	0A57  51			 push cx
   3164
   3165	0A58  C7 06 0769r 0000		 mov alien_spawn_timer,	0
   3166
   3167					 ; Quantidade baseada na fase: 4 (fase 1) ou 5 (fases 2	e 3)
   3168	0A5E  B9 0004			 mov cx, 4
   3169	0A61  80 3E 0003r 02		 cmp fase, 2
   3170	0A66  74 0A			 je RESET_ALIENS_5
   3171	0A68  80 3E 0003r 03		 cmp fase, 3
   3172	0A6D  74 03			 je RESET_ALIENS_5
   3173	0A6F  EB 04 90			 jmp RESET_ALIENS_START
   3174	0A72			     RESET_ALIENS_5:
   3175	0A72  B9 0005			 mov cx, 5
   3176	0A75			     RESET_ALIENS_START:
   3177	0A75  33 DB			 xor bx, bx
   3178
   3179	0A77			     RESET_ALIENS_LOOP:
   3180	0A77  C6 87 0764r 00		 mov byte ptr [alien_array_active + bx], 0
   3181	0A7C  D1 E3			 shl bx, 1
   3182	0A7E  C7 87 075Ar 0000		 mov word ptr [alien_array_pos + bx], 0
   3183	0A84  D1 EB			 shr bx, 1
   3184	0A86  43			 inc bx
   3185	0A87  49			 dec cx
   3186	0A88  75 ED			 jnz RESET_ALIENS_LOOP
   3187
   3188					 ; Força spawn	imediato de 1 alien para teste
   3189	0A8A  E8 00BC			 call SPAWN_ALIEN
   3190
   3191	0A8D  59			 pop cx
   3192	0A8E  5B			 pop bx
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 57
MAIN.ASM



   3193	0A8F  58			 pop ax
   3194	0A90  C3			 ret
   3195	0A91			     endp
   3196
   3197				     ; Atualiza	sistema	de aliens
   3198	0A91			     UPDATE_ALIENS proc
   3199	0A91  50			 push ax
   3200	0A92  53			 push bx
   3201	0A93  51			 push cx
   3202	0A94  52			 push dx
   3203
   3204					 ; Incrementa timer
   3205	0A95  FF 06 0769r		 inc alien_spawn_timer
   3206
   3207					 ; Verifica spawn (delay baseado na fase)
   3208	0A99  A1 0769r			 mov ax, alien_spawn_timer
   3209	0A9C  8B 16 076Br		 mov dx, alien_spawn_delay
   3210	0AA0  80 3E 0003r 02		 cmp fase, 2
   3211	0AA5  74 0A			 je USE_FASE2_DELAY
   3212	0AA7  80 3E 0003r 03		 cmp fase, 3
   3213	0AAC  74 0A			 je USE_FASE3_DELAY
   3214	0AAE  EB 0C 90			 jmp USE_NORMAL_DELAY
   3215	0AB1			     USE_FASE2_DELAY:
   3216	0AB1  8B 16 0771r		 mov dx, meteor_spawn_delay  ; Fase 2: spawn meteoros
   3217	0AB5  EB 05 90			 jmp USE_NORMAL_DELAY
   3218	0AB8			     USE_FASE3_DELAY:
   3219	0AB8  8B 16 0775r		 mov dx, alien_fase3_spawn_delay  ; Fase 3: spawn mais rápido
   3220	0ABC			     USE_NORMAL_DELAY:
   3221	0ABC  3B C2			 cmp ax, dx
   3222	0ABE  72 09			 jb UPDATE_EXISTING_ALIENS
   3223
   3224					 ; Reset timer e spawna
   3225	0AC0  C7 06 0769r 0000		 mov alien_spawn_timer,	0
   3226	0AC6  E8 0080			 call SPAWN_ALIEN
   3227
   3228	0AC9			     UPDATE_EXISTING_ALIENS:
   3229					 ; Move	aliens/meteoros	existentes
   3230					 ; Quantidade baseada na fase: 4 (fase 1) ou 5 (fases 2	e 3)
   3231	0AC9  B9 0004			 mov cx, 4
   3232	0ACC  80 3E 0003r 02		 cmp fase, 2
   3233	0AD1  74 0A			 je UPDATE_ALIENS_5
   3234	0AD3  80 3E 0003r 03		 cmp fase, 3
   3235	0AD8  74 03			 je UPDATE_ALIENS_5
   3236	0ADA  EB 04 90			 jmp UPDATE_ALIENS_START
   3237	0ADD			     UPDATE_ALIENS_5:
   3238	0ADD  B9 0005			 mov cx, 5
   3239	0AE0			     UPDATE_ALIENS_START:
   3240	0AE0  33 DB			 xor bx, bx
   3241
   3242	0AE2			     UPDATE_ALIENS_LOOP:
   3243	0AE2  80 BF 0764r 00		 cmp byte ptr [alien_array_active + bx], 0
   3244	0AE7  74 57			 je NEXT_UPDATE_ALIEN
   3245
   3246					 ; Pega	posição do alien (BX * 2 para	word array)
   3247	0AE9  53			 push bx
   3248	0AEA  D1 E3			 shl bx, 1
   3249	0AEC  8B 87 075Ar		 mov ax, word ptr [alien_array_pos + bx]
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 58
MAIN.ASM



   3250	0AF0  5B			 pop bx
   3251
   3252					 ; Verifica se X >= 2 para evitar underflow
   3253	0AF1  50			 push ax
   3254	0AF2  53			 push bx
   3255	0AF3  33 D2			 xor dx, dx
   3256	0AF5  BB 0140			 mov bx, 320
   3257	0AF8  F7 F3			 div bx		     ; ax = y, dx = x
   3258	0AFA  5B			 pop bx
   3259
   3260	0AFB  83 FA 02			 cmp dx, 2
   3261	0AFE  58			 pop ax		     ; recupera	posição original
   3262	0AFF  72 2F			 jb REMOVE_ALIEN
   3263
   3264					 ; Move	para esquerda (velocidade baseada na fase)
   3265	0B01  53			 push bx
   3266	0B02  8B 1E 076Dr		 mov bx, alien_move_speed
   3267	0B06  80 3E 0003r 02		 cmp fase, 2
   3268	0B0B  74 0A			 je USE_FASE2_SPEED
   3269	0B0D  80 3E 0003r 03		 cmp fase, 3
   3270	0B12  74 0A			 je USE_FASE3_SPEED
   3271	0B14  EB 0C 90			 jmp USE_NORMAL_SPEED
   3272	0B17			     USE_FASE2_SPEED:
   3273	0B17  8B 1E 076Fr		 mov bx, meteor_move_speed  ; Fase 2: meteoros
   3274	0B1B  EB 05 90			 jmp USE_NORMAL_SPEED
   3275	0B1E			     USE_FASE3_SPEED:
   3276	0B1E  8B 1E 0773r		 mov bx, alien_fase3_move_speed	 ; Fase	3: aliens mais rápidos
   3277	0B22			     USE_NORMAL_SPEED:
   3278	0B22  2B C3			 sub ax, bx
   3279	0B24  5B			 pop bx
   3280
   3281	0B25  53			 push bx
   3282	0B26  D1 E3			 shl bx, 1
   3283	0B28  89 87 075Ar		 mov word ptr [alien_array_pos + bx], ax
   3284	0B2C  5B			 pop bx
   3285	0B2D  EB 11 90			 jmp NEXT_UPDATE_ALIEN
   3286
   3287	0B30			     REMOVE_ALIEN:
   3288					 ; Limpa sprite	do alien antes de desativar
   3289	0B30  53			 push bx
   3290	0B31  D1 E3			 shl bx, 1
   3291	0B33  8B BF 075Ar		 mov di, word ptr [alien_array_pos + bx]
   3292	0B37  E8 F63A			 call CLEAR_SPRITE
   3293	0B3A  5B			 pop bx
   3294
   3295	0B3B  C6 87 0764r 00		 mov byte ptr [alien_array_active + bx], 0
   3296
   3297	0B40			     NEXT_UPDATE_ALIEN:
   3298	0B40  43			 inc bx
   3299	0B41  49			 dec cx
   3300	0B42  75 9E			 jnz UPDATE_ALIENS_LOOP
   3301
   3302	0B44  5A			 pop dx
   3303	0B45  59			 pop cx
   3304	0B46  5B			 pop bx
   3305	0B47  58			 pop ax
   3306	0B48  C3			 ret
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 59
MAIN.ASM



   3307	0B49			     endp
   3308
   3309				     ; Spawna novo alien
   3310	0B49			     SPAWN_ALIEN proc
   3311	0B49  50			 push ax
   3312	0B4A  53			 push bx
   3313	0B4B  51			 push cx
   3314	0B4C  52			 push dx
   3315
   3316					 ; Procura slot	livre (quantidade baseada na fase: 4 (fase 1) ou 5 (fases 2 e 3))
   3317	0B4D  B9 0004			 mov cx, 4
   3318	0B50  80 3E 0003r 02		 cmp fase, 2
   3319	0B55  74 0A			 je SPAWN_ALIEN_5
   3320	0B57  80 3E 0003r 03		 cmp fase, 3
   3321	0B5C  74 03			 je SPAWN_ALIEN_5
   3322	0B5E  EB 04 90			 jmp SPAWN_ALIEN_START
   3323	0B61			     SPAWN_ALIEN_5:
   3324	0B61  B9 0005			 mov cx, 5
   3325	0B64			     SPAWN_ALIEN_START:
   3326	0B64  33 DB			 xor bx, bx
   3327
   3328	0B66			     FIND_SLOT:
   3329	0B66  80 BF 0764r 00		 cmp byte ptr [alien_array_active + bx], 0
   3330	0B6B  74 07			 je FOUND_SLOT
   3331	0B6D  43			 inc bx
   3332	0B6E  49			 dec cx
   3333	0B6F  75 F5			 jnz FIND_SLOT
   3334	0B71  EB 39 90			 jmp END_SPAWN
   3335
   3336	0B74			     FOUND_SLOT:
   3337					 ; BX contém o	índice	do slot	livre (0-3)
   3338	0B74  53			 push bx	     ; Salva índice do	slot
   3339
   3340					 ; Gera	Y aleatório baseado na	fase
   3341	0B75  E8 F5AE			 call RANDOM_UINT16
   3342	0B78  33 D2			 xor dx, dx	     ; Zera DX para divisão
   3343
   3344					 ; Fase	3: espaço vertical seguro (linha 25-60)
   3345					 ; HUD está nas linhas	0-20, torres começam em Y~78
   3346					 ; Aliens devem	ficar entre a HUD e as torres
   3347	0B7A  80 3E 0003r 03		 cmp fase, 3
   3348	0B7F  75 0D			 jne SPAWN_ALIEN_NORMAL_Y
   3349	0B81  B9 0024			 mov cx, 36	     ; Divisor para fase 3 (36 linhas de espaço)
   3350	0B84  F7 F1			 div cx		     ; AX / CX,	resto em DX
   3351	0B86  8B C2			 mov ax, dx	     ; Usa resto (0-35)
   3352	0B88  05 0019			 add ax, 25	     ; Y entre 25-60 (área segura)
   3353	0B8B  EB 0B 90			 jmp SPAWN_ALIEN_CALC_POS
   3354
   3355	0B8E			     SPAWN_ALIEN_NORMAL_Y:
   3356					 ; Fases 1 e 2:	Y entre	20-130
   3357	0B8E  B9 006E			 mov cx, 110	     ; Divisor em CX
   3358	0B91  F7 F1			 div cx		     ; AX / CX,	resto em DX
   3359	0B93  8B C2			 mov ax, dx	     ; Usa resto (0-109)
   3360	0B95  05 0014			 add ax, 20	     ; Y entre 20-129
   3361
   3362	0B98			     SPAWN_ALIEN_CALC_POS:
   3363
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 60
MAIN.ASM



   3364					 ; Calcula posição: Y*320 + X
   3365					 ; X = 298 (320	- 22 = 298, garante sprite dentro da tela)
   3366	0B98  B9 0140			 mov cx, 320
   3367	0B9B  F7 E1			 mul cx		     ; AX = Y *	320, resultado em DX:AX
   3368	0B9D  05 012A			 add ax, 298	     ; Adiciona	X=298 (lado direito, sprite completo visível)
   3369
   3370					 ; Ativa alien
   3371	0BA0  5B			 pop bx		     ; Recupera	índice	do slot
   3372	0BA1  C6 87 0764r 01		 mov byte ptr [alien_array_active + bx], 1
   3373	0BA6  D1 E3			 shl bx, 1	     ; BX *= 2 para word array
   3374	0BA8  89 87 075Ar		 mov word ptr [alien_array_pos + bx], ax
   3375
   3376	0BAC			     END_SPAWN:
   3377	0BAC  5A			 pop dx
   3378	0BAD  59			 pop cx
   3379	0BAE  5B			 pop bx
   3380	0BAF  58			 pop ax
   3381	0BB0  C3			 ret
   3382	0BB1			     endp
   3383
   3384				     ; Verifica	sobreposição entre aliens
   3385				     ; Entrada:	AX = Y do novo alien
   3386				     ; Retorna:	AL = 1 se há sobreposição, 0	caso contrário
   3387	0BB1			     CHECK_ALIEN_OVERLAP proc
   3388	0BB1  53			 push bx
   3389	0BB2  51			 push cx
   3390	0BB3  52			 push dx
   3391	0BB4  56			 push si
   3392
   3393	0BB5  8B F0			 mov si, ax	     ; SI = Y do novo alien
   3394	0BB7  B9 0004			 mov cx, 4
   3395	0BBA  33 DB			 xor bx, bx
   3396
   3397	0BBC			     CHECK_OVERLAP_LOOP:
   3398	0BBC  80 BF 0764r 00		 cmp byte ptr [alien_array_active + bx], 0
   3399	0BC1  74 1F			 je NEXT_CHECK_OVERLAP
   3400
   3401					 ; Calcula Y do	alien existente
   3402	0BC3  53			 push bx
   3403	0BC4  D1 E3			 shl bx, 1
   3404	0BC6  8B 87 075Ar		 mov ax, word ptr [alien_array_pos + bx]
   3405	0BCA  5B			 pop bx
   3406
   3407	0BCB  53			 push bx
   3408	0BCC  BB 0140			 mov bx, 320
   3409	0BCF  33 D2			 xor dx, dx
   3410	0BD1  F7 F3			 div bx		     ; ax = y
   3411	0BD3  5B			 pop bx
   3412
   3413					 ; Verifica distância
   3414	0BD4  2B C6			 sub ax, si
   3415	0BD6  3D 0000			 cmp ax, 0
   3416	0BD9  7D 02			 jge POSITIVE_DIST
   3417	0BDB  F7 D8			 neg ax
   3418	0BDD			     POSITIVE_DIST:
   3419	0BDD  3D 0019			 cmp ax, 25
   3420	0BE0  72 09			 jb OVERLAP_FOUND
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 61
MAIN.ASM



   3421
   3422	0BE2			     NEXT_CHECK_OVERLAP:
   3423	0BE2  43			 inc bx
   3424	0BE3  49			 dec cx
   3425	0BE4  75 D6			 jnz CHECK_OVERLAP_LOOP
   3426
   3427	0BE6  B0 00			 mov al, 0
   3428	0BE8  EB 03 90			 jmp END_CHECK_OVERLAP
   3429
   3430	0BEB			     OVERLAP_FOUND:
   3431	0BEB  B0 01			 mov al, 1
   3432
   3433	0BED			     END_CHECK_OVERLAP:
   3434	0BED  5E			 pop si
   3435	0BEE  5A			 pop dx
   3436	0BEF  59			 pop cx
   3437	0BF0  5B			 pop bx
   3438	0BF1  C3			 ret
   3439	0BF2			     endp
   3440
   3441				     ; Renderiza aliens/meteoros
   3442	0BF2			     RENDER_ALIENS proc
   3443	0BF2  50			 push ax
   3444	0BF3  53			 push bx
   3445	0BF4  51			 push cx
   3446	0BF5  56			 push si
   3447
   3448					 ; Quantidade baseada na fase: 4 (fase 1) ou 5 (fases 2	e 3)
   3449	0BF6  B9 0004			 mov cx, 4
   3450	0BF9  80 3E 0003r 02		 cmp fase, 2
   3451	0BFE  74 0A			 je RENDER_ALIENS_5
   3452	0C00  80 3E 0003r 03		 cmp fase, 3
   3453	0C05  74 03			 je RENDER_ALIENS_5
   3454	0C07  EB 04 90			 jmp RENDER_ALIENS_START
   3455	0C0A			     RENDER_ALIENS_5:
   3456	0C0A  B9 0005			 mov cx, 5
   3457	0C0D			     RENDER_ALIENS_START:
   3458	0C0D  33 DB			 xor bx, bx
   3459
   3460	0C0F			     RENDER_ALIENS_LOOP:
   3461	0C0F  80 BF 0764r 00		 cmp byte ptr [alien_array_active + bx], 0
   3462	0C14  74 1B			 je NEXT_RENDER_ALIEN
   3463
   3464	0C16  53			 push bx
   3465	0C17  D1 E3			 shl bx, 1
   3466	0C19  8B 87 075Ar		 mov ax, word ptr [alien_array_pos + bx]
   3467	0C1D  5B			 pop bx
   3468
   3469					 ; Escolhe sprite baseado na fase
   3470	0C1E  80 3E 0003r 02		 cmp fase, 2
   3471	0C23  74 06			 je USE_METEOR_SPRITE
   3472					 ; Fases 1 e 3 usam alien sprite
   3473	0C25  BE 034Er			 mov si, offset	alien_sprite
   3474	0C28  EB 04 90			 jmp DRAW_ENEMY
   3475	0C2B			     USE_METEOR_SPRITE:
   3476	0C2B  BE 016Er			 mov si, offset	meteor_sprite
   3477	0C2E			     DRAW_ENEMY:
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 62
MAIN.ASM



   3478	0C2E  E8 F4C9			 call RENDER_SPRITE
   3479
   3480	0C31			     NEXT_RENDER_ALIEN:
   3481	0C31  43			 inc bx
   3482	0C32  49			 dec cx
   3483	0C33  75 DA			 jnz RENDER_ALIENS_LOOP
   3484
   3485	0C35  5E			 pop si
   3486	0C36  59			 pop cx
   3487	0C37  5B			 pop bx
   3488	0C38  58			 pop ax
   3489	0C39  C3			 ret
   3490	0C3A			     endp
   3491
   3492				     ; Verifica	colisões tiros	vs aliens/meteoros
   3493	0C3A			     CHECK_ALIEN_SHOT_COLLISION	proc
   3494	0C3A  50			 push ax
   3495	0C3B  53			 push bx
   3496	0C3C  51			 push cx
   3497	0C3D  52			 push dx
   3498	0C3E  56			 push si
   3499	0C3F  57			 push di
   3500
   3501					 ; Quantidade baseada na fase: 4 (fase 1) ou 5 (fases 2	e 3)
   3502	0C40  B9 0004			 mov cx, 4
   3503	0C43  80 3E 0003r 02		 cmp fase, 2
   3504	0C48  74 0A			 je CHECK_SHOT_COLLISION_5
   3505	0C4A  80 3E 0003r 03		 cmp fase, 3
   3506	0C4F  74 03			 je CHECK_SHOT_COLLISION_5
   3507	0C51  EB 04 90			 jmp CHECK_SHOT_COLLISION_START
   3508	0C54			     CHECK_SHOT_COLLISION_5:
   3509	0C54  B9 0005			 mov cx, 5
   3510	0C57			     CHECK_SHOT_COLLISION_START:
   3511	0C57  33 DB			 xor bx, bx
   3512
   3513	0C59			     CHECK_COLLISION_ALIEN_LOOP:
   3514	0C59  80 BF 0764r 00		 cmp byte ptr [alien_array_active + bx], 0
   3515	0C5E  75 03			 jne CHECK_ALIEN_ACTIVE
   3516	0C60  EB 45 90			 jmp NEXT_COLLISION_ALIEN
   3517	0C63			     CHECK_ALIEN_ACTIVE:
   3518
   3519					 ; Posição do	alien
   3520	0C63  53			 push bx
   3521	0C64  D1 E3			 shl bx, 1
   3522	0C66  8B BF 075Ar		 mov di, word ptr [alien_array_pos + bx]
   3523	0C6A  5B			 pop bx
   3524
   3525					 ; Verifica cada tiro
   3526	0C6B  51			 push cx
   3527	0C6C  53			 push bx
   3528
   3529	0C6D  8A 0E 074Fr		 mov cl, shot_count
   3530	0C71  32 ED			 xor ch, ch
   3531	0C73  33 F6			 xor si, si
   3532
   3533	0C75			     CHECK_COLLISION_SHOT_LOOP:
   3534	0C75  80 BC 0756r 00		 cmp byte ptr [shot_active + si], 0
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 63
MAIN.ASM



   3535	0C7A  74 24			 je NEXT_COLLISION_SHOT
   3536
   3537					 ; Posição do	tiro
   3538	0C7C  56			 push si
   3539	0C7D  D1 E6			 shl si, 1
   3540	0C7F  8B 84 0750r		 mov ax, word ptr [shot_pos + si]
   3541	0C83  5E			 pop si
   3542
   3543					 ; Verifica colisão
   3544	0C84  E8 00D7			 call CHECK_COLLISION_XY
   3545	0C87  3C 01			 cmp al, 1
   3546	0C89  75 15			 jne NEXT_COLLISION_SHOT
   3547
   3548					 ; Colisão detectada! Chama handler apropriado
   3549	0C8B  80 3E 0003r 02		 cmp fase, 2
   3550	0C90  74 06			 je CALL_METEOR_HIT
   3551	0C92  E8 0020			 call HANDLE_ALIEN_DESTROYED
   3552	0C95  EB 04 90			 jmp END_COLLISION_CHECK
   3553	0C98			     CALL_METEOR_HIT:
   3554	0C98  E8 0058			 call HANDLE_METEOR_HIT
   3555	0C9B			     END_COLLISION_CHECK:
   3556	0C9B  5B			 pop bx
   3557	0C9C  59			 pop cx
   3558	0C9D  EB 08 90			 jmp NEXT_COLLISION_ALIEN
   3559
   3560	0CA0			     NEXT_COLLISION_SHOT:
   3561	0CA0  46			 inc si
   3562	0CA1  FE C9			 dec cl
   3563	0CA3  75 D0			 jnz CHECK_COLLISION_SHOT_LOOP
   3564
   3565	0CA5  5B			 pop bx
   3566	0CA6  59			 pop cx
   3567
   3568	0CA7			     NEXT_COLLISION_ALIEN:
   3569	0CA7  43			 inc bx
   3570	0CA8  49			 dec cx
   3571	0CA9  83 F9 00			 cmp cx, 0
   3572	0CAC  75 AB			 jne CHECK_COLLISION_ALIEN_LOOP
   3573
   3574	0CAE  5F			 pop di
   3575	0CAF  5E			 pop si
   3576	0CB0  5A			 pop dx
   3577	0CB1  59			 pop cx
   3578	0CB2  5B			 pop bx
   3579	0CB3  58			 pop ax
   3580	0CB4  C3			 ret
   3581	0CB5			     endp
   3582
   3583				     ; Handler para alien destruído (fases 1 e	3)
   3584				     ; Entrada:	BX = índice do	alien, SI = índice do tiro
   3585	0CB5			     HANDLE_ALIEN_DESTROYED proc
   3586	0CB5  50			 push ax
   3587	0CB6  53			 push bx
   3588	0CB7  56			 push si
   3589	0CB8  57			 push di
   3590
   3591					 ; Limpa sprite	do alien
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 64
MAIN.ASM



   3592	0CB9  53			 push bx
   3593	0CBA  D1 E3			 shl bx, 1
   3594	0CBC  8B BF 075Ar		 mov di, word ptr [alien_array_pos + bx]
   3595	0CC0  E8 F4B1			 call CLEAR_SPRITE
   3596	0CC3  5B			 pop bx
   3597
   3598					 ; Limpa sprite	do tiro
   3599	0CC4  56			 push si
   3600	0CC5  D1 E6			 shl si, 1
   3601	0CC7  8B BC 0750r		 mov di, word ptr [shot_pos + si]
   3602	0CCB  E8 F99E			 call CLEAR_SHOT_SPRITE
   3603	0CCE  5E			 pop si
   3604
   3605					 ; Desativa alien e tiro
   3606	0CCF  C6 87 0764r 00		 mov byte ptr [alien_array_active + bx], 0
   3607	0CD4  C6 84 0756r 00		 mov byte ptr [shot_active + si], 0
   3608
   3609					 ; Pontuação:	100 (fase 1) ou	150 (fase 3)
   3610	0CD9  80 3E 0003r 03		 cmp fase, 3
   3611	0CDE  74 08			 je ALIEN_SCORE_150
   3612	0CE0  83 06 0C15r 64		 add score, 100
   3613	0CE5  EB 07 90			 jmp END_ALIEN_SCORE
   3614	0CE8			     ALIEN_SCORE_150:
   3615	0CE8  81 06 0C15r 0096		 add score, 150
   3616	0CEE			     END_ALIEN_SCORE:
   3617
   3618	0CEE  5F			 pop di
   3619	0CEF  5E			 pop si
   3620	0CF0  5B			 pop bx
   3621	0CF1  58			 pop ax
   3622	0CF2  C3			 ret
   3623	0CF3			     endp
   3624
   3625				     ; Handler para meteoro atingido (fase 2)
   3626				     ; Entrada:	SI = índice do	tiro
   3627	0CF3			     HANDLE_METEOR_HIT proc
   3628	0CF3  56			 push si
   3629	0CF4  57			 push di
   3630
   3631					 ; Limpa sprite	do tiro	apenas
   3632	0CF5  56			 push si
   3633	0CF6  D1 E6			 shl si, 1
   3634	0CF8  8B BC 0750r		 mov di, word ptr [shot_pos + si]
   3635	0CFC  E8 F96D			 call CLEAR_SHOT_SPRITE
   3636	0CFF  5E			 pop si
   3637
   3638					 ; Desativa tiro (meteoro continua ativo)
   3639	0D00  C6 84 0756r 00		 mov byte ptr [shot_active + si], 0
   3640
   3641	0D05  5F			 pop di
   3642	0D06  5E			 pop si
   3643	0D07  C3			 ret
   3644	0D08			     endp
   3645
   3646				     ; Verifica	colisões nave vs aliens/meteoros
   3647	0D08			     CHECK_ALIEN_SHIP_COLLISION	proc
   3648	0D08  50			 push ax
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 65
MAIN.ASM



   3649	0D09  53			 push bx
   3650	0D0A  51			 push cx
   3651	0D0B  57			 push di
   3652
   3653					 ; Quantidade baseada na fase: 4 (fase 1) ou 5 (fases 2	e 3)
   3654	0D0C  B9 0004			 mov cx, 4
   3655	0D0F  80 3E 0003r 02		 cmp fase, 2
   3656	0D14  74 0A			 je CHECK_SHIP_COLLISION_5
   3657	0D16  80 3E 0003r 03		 cmp fase, 3
   3658	0D1B  74 03			 je CHECK_SHIP_COLLISION_5
   3659	0D1D  EB 04 90			 jmp CHECK_SHIP_COLLISION_START
   3660	0D20			     CHECK_SHIP_COLLISION_5:
   3661	0D20  B9 0005			 mov cx, 5
   3662	0D23			     CHECK_SHIP_COLLISION_START:
   3663	0D23  33 DB			 xor bx, bx
   3664
   3665	0D25			     CHECK_SHIP_COLLISION_LOOP:
   3666	0D25  80 BF 0764r 00		 cmp byte ptr [alien_array_active + bx], 0
   3667	0D2A  74 29			 je NEXT_SHIP_COLLISION
   3668
   3669					 ; Posição do	alien
   3670	0D2C  53			 push bx
   3671	0D2D  D1 E3			 shl bx, 1
   3672	0D2F  8B BF 075Ar		 mov di, word ptr [alien_array_pos + bx]
   3673	0D33  5B			 pop bx
   3674
   3675					 ; Posição da	nave
   3676	0D34  A1 074Dr			 mov ax, ship_pos
   3677
   3678					 ; Verifica colisão
   3679	0D37  E8 0024			 call CHECK_COLLISION_XY
   3680	0D3A  3C 01			 cmp al, 1
   3681	0D3C  75 17			 jne NEXT_SHIP_COLLISION
   3682
   3683					 ; Colisão! Perde vida
   3684					 ; Limpa sprite	do alien da tela
   3685	0D3E  53			 push bx
   3686	0D3F  D1 E3			 shl bx, 1
   3687	0D41  8B BF 075Ar		 mov di, word ptr [alien_array_pos + bx]
   3688	0D45  E8 F42C			 call CLEAR_SPRITE
   3689	0D48  5B			 pop bx
   3690
   3691	0D49  C6 87 0764r 00		 mov byte ptr [alien_array_active + bx], 0
   3692	0D4E  FE 0E 0777r		 dec lives
   3693
   3694					 ; Atualiza exibição de vidas	na tela
   3695	0D52  E8 F669			 call RENDER_LIVES
   3696
   3697	0D55			     NEXT_SHIP_COLLISION:
   3698	0D55  43			 inc bx
   3699	0D56  49			 dec cx
   3700	0D57  75 CC			 jnz CHECK_SHIP_COLLISION_LOOP
   3701
   3702	0D59  5F			 pop di
   3703	0D5A  59			 pop cx
   3704	0D5B  5B			 pop bx
   3705	0D5C  58			 pop ax
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 66
MAIN.ASM



   3706	0D5D  C3			 ret
   3707	0D5E			     endp
   3708
   3709				     ; Verifica	colisão entre dois objetos
   3710				     ; Entrada:	AX = posição 1, DI = posição 2
   3711				     ; Retorna:	AL = 1 se colidiu, 0 caso contrário
   3712	0D5E			     CHECK_COLLISION_XY	proc
   3713	0D5E  53			 push bx
   3714	0D5F  51			 push cx
   3715	0D60  52			 push dx
   3716	0D61  56			 push si
   3717
   3718					 ; Calcula X,Y do objeto 1
   3719	0D62  BB 0140			 mov bx, 320
   3720	0D65  33 D2			 xor dx, dx
   3721	0D67  F7 F3			 div bx		     ; ax = y1,	dx = x1
   3722	0D69  8B C8			 mov cx, ax	     ; cx = y1
   3723	0D6B  8B F2			 mov si, dx	     ; si = x1
   3724
   3725					 ; Calcula X,Y do objeto 2
   3726	0D6D  8B C7			 mov ax, di
   3727	0D6F  33 D2			 xor dx, dx
   3728	0D71  F7 F3			 div bx		     ; ax = y2,	dx = x2
   3729
   3730					 ; Distância X
   3731	0D73  2B F2			 sub si, dx
   3732	0D75  83 FE 00			 cmp si, 0
   3733	0D78  7D 02			 jge ABS_X
   3734	0D7A  F7 DE			 neg si
   3735	0D7C			     ABS_X:
   3736	0D7C  83 FE 14			 cmp si, 20
   3737	0D7F  77 13			 ja NO_COLLISION_XY
   3738
   3739					 ; Distância Y
   3740	0D81  2B C8			 sub cx, ax
   3741	0D83  83 F9 00			 cmp cx, 0
   3742	0D86  7D 02			 jge ABS_Y
   3743	0D88  F7 D9			 neg cx
   3744	0D8A			     ABS_Y:
   3745	0D8A  83 F9 0F			 cmp cx, 15
   3746	0D8D  77 05			 ja NO_COLLISION_XY
   3747
   3748	0D8F  B0 01			 mov al, 1
   3749	0D91  EB 03 90			 jmp END_COLLISION_XY
   3750
   3751	0D94			     NO_COLLISION_XY:
   3752	0D94  B0 00			 mov al, 0
   3753
   3754	0D96			     END_COLLISION_XY:
   3755	0D96  5E			 pop si
   3756	0D97  5A			 pop dx
   3757	0D98  59			 pop cx
   3758	0D99  5B			 pop bx
   3759	0D9A  C3			 ret
   3760	0D9B			     endp
   3761
   3762				     end MAIN
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 67
Symbol Table




Symbol Name			  Type	 Value

??DATE				  Text	 "12/05/25"
??FILENAME			  Text	 "MAIN	  "
??TIME				  Text	 "15:26:47"
??VERSION			  Number 040A
@32BIT				  Text	 0
@CODE				  Text	 _TEXT
@CODESIZE			  Text	 0
@CPU				  Text	 0101H
@CURSEG				  Text	 _TEXT
@DATA				  Text	 DGROUP
@DATASIZE			  Text	 0
@FILENAME			  Text	 MAIN
@INTERFACE			  Text	 000H
@MODEL				  Text	 2
@STACK				  Text	 DGROUP
@WORDSIZE			  Text	 2
ABS_X				  Near	 _TEXT:0D7C
ABS_Y				  Near	 _TEXT:0D8A
ALE				  Word	 DGROUP:0000
ALIEN_ARRAY_ACTIVE		  Byte	 DGROUP:0764
ALIEN_ARRAY_POS			  Word	 DGROUP:075A
ALIEN_COUNT			  Byte	 DGROUP:0759
ALIEN_DIR			  Byte	 DGROUP:0547
ALIEN_FASE3_MOVE_SPEED		  Word	 DGROUP:0773
ALIEN_FASE3_SPAWN_DELAY		  Word	 DGROUP:0775
ALIEN_MOVE_SPEED		  Word	 DGROUP:076D
ALIEN_POS			  Word	 DGROUP:0545
ALIEN_SCORE_150			  Near	 _TEXT:0CE8
ALIEN_SPAWN_DELAY		  Word	 DGROUP:076B
ALIEN_SPAWN_TIMER		  Word	 DGROUP:0769
ALIEN_SPRITE			  Byte	 DGROUP:034E
ARROW_DOWN			  Near	 _TEXT:02AA
ARROW_UP			  Near	 _TEXT:02A1
BASE				  Byte	 DGROUP:A2F9
BASE_HEIGHT			  Number 0008
BASE_WIDTH			  Number 0022
BOUNCE_LEFT			  Near	 _TEXT:01ED
BOUNCE_RIGHT			  Near	 _TEXT:01F2
BTN_INICIAR			  Byte	 DGROUP:0004
BTN_INICIAR_LENGTH		  Number 0051
BTN_SAIR			  Byte	 DGROUP:0055
BTN_SAIR_LENGTH			  Number 0051
CALL_METEOR_HIT			  Near	 _TEXT:0C98
CHECK_ALIEN_ACTIVE		  Near	 _TEXT:0C63
CHECK_ALIEN_OVERLAP		  Near	 _TEXT:0BB1
CHECK_ALIEN_SHIP_COLLISION	  Near	 _TEXT:0D08
CHECK_ALIEN_SHOT_COLLISION	  Near	 _TEXT:0C3A
CHECK_COLLISION_ALIEN_LOOP	  Near	 _TEXT:0C59
CHECK_COLLISION_SHOT_LOOP	  Near	 _TEXT:0C75
CHECK_COLLISION_XY		  Near	 _TEXT:0D5E
CHECK_DIRECTION			  Near	 _TEXT:051F
CHECK_FASE2			  Near	 _TEXT:046A
CHECK_FASE3			  Near	 _TEXT:0477
CHECK_GAME_END			  Near	 _TEXT:09B0
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 68
Symbol Table



CHECK_OVERLAP_LOOP		  Near	 _TEXT:0BBC
CHECK_SHIP_COLLISION_5		  Near	 _TEXT:0D20
CHECK_SHIP_COLLISION_LOOP	  Near	 _TEXT:0D25
CHECK_SHIP_COLLISION_START	  Near	 _TEXT:0D23
CHECK_SHOT_COLLISION_5		  Near	 _TEXT:0C54
CHECK_SHOT_COLLISION_START	  Near	 _TEXT:0C57
CLEAR_LEFT_EDGE			  Near	 _TEXT:06FC
CLEAR_LINE			  Near	 _TEXT:0180
CLEAR_LIVES_LOOP		  Near	 _TEXT:03C9
CLEAR_SCREEN			  Near	 _TEXT:02C1
CLEAR_SHOT_LINE			  Near	 _TEXT:0678
CLEAR_SHOT_SPRITE		  Near	 _TEXT:066C
CLEAR_SPRITE			  Near	 _TEXT:0174
CLIP_DONE			  Near	 _TEXT:0864
CLIP_RIGHT_CHECK		  Near	 _TEXT:0852
CONVERT_UINT16			  Near	 _TEXT:036B
COPY_TERRAIN_LINE		  Near	 _TEXT:06BE
DEACTIVATE_THIS_SHOT		  Near	 _TEXT:062E
DRAW_BOUNCE			  Near	 _TEXT:021B
DRAW_ENEMY			  Near	 _TEXT:0C2E
DRAW_RIGHT			  Near	 _TEXT:025D
DRAW_SHIP_LINE			  Near	 _TEXT:0112
DRAW_SHOT_LINE			  Near	 _TEXT:0658
DRAW_SPRITE			  Near	 _TEXT:01C1
END_ALIEN_SCORE			  Near	 _TEXT:0CEE
END_CHECK			  Near	 _TEXT:09CB
END_CHECK_OVERLAP		  Near	 _TEXT:0BED
END_COLLISION_CHECK		  Near	 _TEXT:0C9B
END_COLLISION_XY		  Near	 _TEXT:0D96
END_CONTROLS			  Near	 _TEXT:0504
END_DOWN			  Near	 _TEXT:09FF
END_GAME			  Near	 _TEXT:02B4
END_HANDLE			  Near	 _TEXT:02B3
END_LEFT			  Near	 _TEXT:0A25
END_RENDER_LIVES		  Near	 _TEXT:03F9
END_RIGHT			  Near	 _TEXT:0A4E
END_SHIP_UPDATE			  Near	 _TEXT:049B
END_SHOOT			  Near	 _TEXT:05DB
END_SPAWN			  Near	 _TEXT:0BAC
END_TIME			  Near	 _TEXT:0487
END_UP				  Near	 _TEXT:09E4
EXIT_BTN			  Near	 _TEXT:00B4
FASE				  Byte	 DGROUP:0003
FASE1				  Byte	 DGROUP:0778
FASE2				  Byte	 DGROUP:083E
FASE3				  Byte	 DGROUP:0904
FASE_STRING_LENGTH		  Number 00C6
FASE_VEC			  Word	 DGROUP:09CA
FINAL_SCORE_MSG			  Byte	 DGROUP:0BFD
FINAL_SCORE_MSG_LENGTH		  Number 000E
FIND_EMPTY_SLOT			  Near	 _TEXT:07AC
FIND_FREE_SHOT			  Near	 _TEXT:05AD
FIND_SLOT			  Near	 _TEXT:0B66
FINISH				  Near	 _TEXT:0088
FINISH_GAME			  Near	 _TEXT:0452
FIRE				  Near	 _TEXT:04D4
FOUND_EMPTY_SLOT		  Near	 _TEXT:07B9
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 69
Symbol Table



FOUND_FREE_SHOT			  Near	 _TEXT:05B8
FOUND_SLOT			  Near	 _TEXT:0B74
GAME_LOOP			  Near	 _TEXT:0059
GAME_OVER_CONDITION		  Near	 _TEXT:09C4
GAME_OVER_END			  Near	 _TEXT:007E
GAME_OVER_MSG			  Byte	 DGROUP:09D0
GAME_OVER_MSG_LENGTH		  Number 0122
HANDLE_ALIEN_DESTROYED		  Near	 _TEXT:0CB5
HANDLE_CONTROLS			  Near	 _TEXT:04A6
HANDLE_INPUT			  Near	 _TEXT:0294
HANDLE_METEOR_HIT		  Near	 _TEXT:0CF3
INIT_ALIEN_RANDOM		  Near	 _TEXT:0136
INIT_FASE3_TOWERS		  Near	 _TEXT:0719
INIT_TOWER_LOOP			  Near	 _TEXT:0725
LIFES_START			  Number 0003
LIVES				  Byte	 DGROUP:0777
LOOP_DIV			  Near	 _TEXT:0373
LOOP_MENU			  Near	 _TEXT:001A
MAIN				  Near	 _TEXT:0000
MAX_TOWERS			  Number 000C
MENU				  Byte	 DGROUP:0002
METEOR_MOVE_SPEED		  Word	 DGROUP:076F
METEOR_POS			  Word	 DGROUP:074B
METEOR_POS_INI			  Number 7E2C
METEOR_SPAWN_DELAY		  Word	 DGROUP:0771
METEOR_SPRITE			  Byte	 DGROUP:016E
MOVE_BOUNCE_MENU		  Near	 _TEXT:01F7
MOVE_BOUNCE_X_AND_DRAW		  Near	 _TEXT:01CE
MOVE_DOWN			  Near	 _TEXT:04E0
MOVE_DOWN_PROC			  Near	 _TEXT:09E8
MOVE_LEFT			  Near	 _TEXT:04E6
MOVE_LEFT_MENU			  Near	 _TEXT:01B5
MOVE_LEFT_PROC			  Near	 _TEXT:0A03
MOVE_MENU			  Near	 _TEXT:0267
MOVE_NEGATIVE			  Near	 _TEXT:0529
MOVE_RIGHT			  Near	 _TEXT:04F5
MOVE_RIGHT_BOUNCE		  Near	 _TEXT:0210
MOVE_RIGHT_MENU			  Near	 _TEXT:0251
MOVE_RIGHT_PROC			  Near	 _TEXT:0A2C
MOVE_SPRITE			  Near	 _TEXT:050A
MOVE_TOWERS_LOOP		  Near	 _TEXT:0764
MOVE_UP				  Near	 _TEXT:04DA
MOVE_UP_PROC			  Near	 _TEXT:09CD
MOVE_WRAP_LEFT_AND_DRAW		  Near	 _TEXT:0194
MOVE_WRAP_RIGHT_AND_DRAW	  Near	 _TEXT:0228
MOVE_Y_AXIS			  Near	 _TEXT:0516
NEXT_CHECK_OVERLAP		  Near	 _TEXT:0BE2
NEXT_COLLISION_ALIEN		  Near	 _TEXT:0CA7
NEXT_COLLISION_SHOT		  Near	 _TEXT:0CA0
NEXT_FLOOR			  Near	 _TEXT:08DC
NEXT_RENDER_ALIEN		  Near	 _TEXT:0C31
NEXT_SHIP_COLLISION		  Near	 _TEXT:0D55
NEXT_SHOT			  Near	 _TEXT:0636
NEXT_TOWER_X			  Word	 DGROUP:A551
NEXT_UPDATE_ALIEN		  Near	 _TEXT:0B40
NO_COLLISION_XY			  Near	 _TEXT:0D94
N_ALE				  Near	 _TEXT:00C3
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 70
Symbol Table



OVERLAP_FOUND			  Near	 _TEXT:0BEB
POSITIVE_DIST			  Near	 _TEXT:0BDD
PRESS_KEY_MSG			  Byte	 DGROUP:0BE2
PRESS_KEY_MSG_LENGTH		  Number 001B
PRINT_BUTTONS			  Near	 _TEXT:008C
PRINT_STRING			  Near	 _TEXT:00D2
PRINT_TITLE_MENU		  Near	 _TEXT:00E7
RANDOM_UINT16			  Near	 _TEXT:0126
REMOVE_ALIEN			  Near	 _TEXT:0B30
RENDER_ALIEN			  Near	 _TEXT:054E
RENDER_ALIENS			  Near	 _TEXT:0BF2
RENDER_ALIENS_5			  Near	 _TEXT:0C0A
RENDER_ALIENS_LOOP		  Near	 _TEXT:0C0F
RENDER_ALIENS_START		  Near	 _TEXT:0C0D
RENDER_BASE_ANDAR_2		  Near	 _TEXT:08BB
RENDER_BASE_LINE_LOOP		  Near	 _TEXT:08C6
RENDER_BUTTONS			  Near	 _TEXT:02B0
RENDER_FASE			  Near	 _TEXT:02D9
RENDER_FASE3_TOWERS		  Near	 _TEXT:07D8
RENDER_FLOOR_LOOP		  Near	 _TEXT:088B
RENDER_LIVES			  Near	 _TEXT:03BE
RENDER_METEOR			  Near	 _TEXT:0559
RENDER_SCORE			  Near	 _TEXT:0386
RENDER_SHIP			  Near	 _TEXT:0531
RENDER_SHOT_SPRITE		  Near	 _TEXT:0640
RENDER_SINGLE_LIFE		  Near	 _TEXT:03E8
RENDER_SPRITE			  Near	 _TEXT:00FA
RENDER_STATUS			  Near	 _TEXT:03FF
RENDER_TERRAIN			  Near	 _TEXT:068C
RENDER_TERRAIN_FASE3		  Near	 _TEXT:06ED
RENDER_TIME			  Near	 _TEXT:0333
RENDER_TOP_LINE_LOOP		  Near	 _TEXT:08A2
RENDER_TOWER			  Near	 _TEXT:080B
RENDER_TOWERS_LOOP		  Near	 _TEXT:07E3
RESET_ALIENS			  Near	 _TEXT:0A55
RESET_ALIENS_5			  Near	 _TEXT:0A72
RESET_ALIENS_LOOP		  Near	 _TEXT:0A77
RESET_ALIENS_START		  Near	 _TEXT:0A75
RESET_GAME			  Near	 _TEXT:0564
RESET_SHIP			  Near	 _TEXT:0543
RESTORE_BOUNCE			  Near	 _TEXT:0218
ROW_ALIEN			  Number 007D
ROW_ALIEN_FASE3			  Number 0032
ROW_METEOR			  Number 0064
ROW_SHIP			  Number 004B
ROW_SHIP_FASE3			  Number 0032
ROW_TERRAIN_FASE3		  Number 0096
SAVE_POS			  Near	 _TEXT:052B
SAVE_TIME			  Near	 _TEXT:0455
SAVE_TIMEOUT			  Near	 _TEXT:0483
SCORE				  Word	 DGROUP:0C15
SCORE_BUFFER			  Byte	 DGROUP:0C17
SCORE_BUFFER_LEN		  Number 0005
SCORE_STR			  Byte	 DGROUP:0C1C
SCORE_STR_LEN			  Number 0006
SCREEN_H			  Number 00C8
SCREEN_W			  Number 0140
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 71
Symbol Table



SECONDS_START			  Number 003C
SELECT_OPTION			  Near	 _TEXT:0037
SET_DIRECTION			  Near	 _TEXT:01F4
SHIP_POS			  Word	 DGROUP:074D
SHIP_POS_INI			  Number 5DC0
SHIP_POS_NORMAL_RENDER		  Near	 _TEXT:02F1
SHIP_POS_SET_RENDER		  Near	 _TEXT:02F7
SHIP_SPEED			  Number 0005
SHIP_SPRITE			  Byte	 DGROUP:0548
SHOOT				  Near	 _TEXT:05A0
SHOT_ACTIVE			  Byte	 DGROUP:0756
SHOT_COUNT			  Byte	 DGROUP:074F
SHOT_POS			  Word	 DGROUP:0750
SHOT_SPRITE			  Byte	 DGROUP:0727
SHOW_GAME_OVER			  Near	 _TEXT:08F5
SHOW_VICTORY			  Near	 _TEXT:0938
SKIP_MOVE_TOWER			  Near	 _TEXT:0787
SKIP_RENDER_TOWER		  Near	 _TEXT:0801
SKIP_SPAWN_TOWER		  Near	 _TEXT:079F
SPAWN_ALIEN			  Near	 _TEXT:0B49
SPAWN_ALIEN_5			  Near	 _TEXT:0B61
SPAWN_ALIEN_CALC_POS		  Near	 _TEXT:0B98
SPAWN_ALIEN_NORMAL_Y		  Near	 _TEXT:0B8E
SPAWN_ALIEN_START		  Near	 _TEXT:0B64
SPAWN_DONE			  Near	 _TEXT:07D4
SPAWN_FASE3_TOWER		  Near	 _TEXT:07A4
SPR_H				  Number 0014
SPR_W				  Number 0018
START_BTN			  Near	 _TEXT:009A
STRING				  Byte	 DGROUP:00A6
STRING_LENGTH			  Number 00C8
SUM_POINTS			  Near	 _TEXT:0300
TERRAIN_DONE_RENDER		  Near	 _TEXT:06E5
TERRAIN_FASE1			  Byte	 DGROUP:0C22
TERRAIN_FASE2			  Byte	 DGROUP:6B63
TERRAIN_POS			  Word	 DGROUP:A51F
TERRAIN_POS_NORMAL_ADVANCE	  Near	 _TEXT:0446
TERRAIN_POS_SET_ADVANCE		  Near	 _TEXT:044C
TERRAIN_VEC			  Word	 DGROUP:A519
TIME				  Byte	 DGROUP:0C0B
TIMEOUT				  Byte	 DGROUP:0C0C
TIME_BUFFER			  Byte	 DGROUP:0C0D
TIME_BUFFER_LEN			  Number 0002
TIME_STR			  Byte	 DGROUP:0C0F
TIME_STR_LEN			  Number 0006
TOPO				  Byte	 DGROUP:A409
TOWER_ACTIVE			  Byte	 DGROUP:A545
TOWER_DONE			  Near	 _TEXT:08EC
TOWER_HEIGHTS			  Byte	 DGROUP:A521
TOWER_MIN_SPACING		  Number 0022
TOWER_NOT_VISIBLE		  Near	 _TEXT:08EC
TOWER_NOT_VISIBLE_JMP		  Near	 _TEXT:0827
TOWER_RENDER_WIDTH		  Word	 DGROUP:A557
TOWER_SPAWN_COUNTER		  Word	 DGROUP:A553
TOWER_SPRITE_OFFSET		  Word	 DGROUP:A555
TOWER_VISIBLE			  Near	 _TEXT:082A
TOWER_X_POS			  Word	 DGROUP:A52D
Turbo Assembler	 Version 4.1	    12/05/25 15:26:49	    Page 72
Symbol Table



TOWER_Y_OK			  Near	 _TEXT:0876
UPDATE_ALIENS			  Near	 _TEXT:0A91
UPDATE_ALIENS_5			  Near	 _TEXT:0ADD
UPDATE_ALIENS_LOOP		  Near	 _TEXT:0AE2
UPDATE_ALIENS_START		  Near	 _TEXT:0AE0
UPDATE_EXISTING_ALIENS		  Near	 _TEXT:0AC9
UPDATE_FASE3_TOWERS		  Near	 _TEXT:075B
UPDATE_SHIP			  Near	 _TEXT:048A
UPDATE_SHOT			  Near	 _TEXT:05E0
UPDATE_SHOT_LOOP		  Near	 _TEXT:05EC
UPDATE_TIME			  Near	 _TEXT:0409
USE_FASE2_DELAY			  Near	 _TEXT:0AB1
USE_FASE2_SPEED			  Near	 _TEXT:0B17
USE_FASE3_DELAY			  Near	 _TEXT:0AB8
USE_FASE3_SPEED			  Near	 _TEXT:0B1E
USE_METEOR_SPRITE		  Near	 _TEXT:0C2B
USE_NORMAL_DELAY		  Near	 _TEXT:0ABC
USE_NORMAL_SPEED		  Near	 _TEXT:0B22
VENCEDOR_MSG			  Byte	 DGROUP:0AF2
VENCEDOR_MSG_LENGTH		  Number 00F0
VICTORY_CONDITION		  Near	 _TEXT:09C9
VICTORY_END			  Near	 _TEXT:0083
WAIT_KEY			  Near	 _TEXT:09A3
WAIT_KEY_LOOP			  Near	 _TEXT:09A4

Groups & Segments		  Bit Size Align  Combine Class

DGROUP				  Group
  STACK				  16  0400 Para	  Stack	  STACK
  _DATA				  16  A559 Word	  Public  DATA
_TEXT				  16  0D9B Word	  Public  CODE
