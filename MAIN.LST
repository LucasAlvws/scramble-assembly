Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 1
MAIN.ASM



      1
      2				     ; M0 ? Sanity check: texto	-> 13h -> desenha 1 pixel -> volta pro texto
      3	0000			     .model small
      4	0000			     .stack
      5
      6	0000			     .data
      7	0000  0000			 ale dw	0
      8	0002  00			 menu db 0
      9	0003  01			 fase db 1
     10	0004  0E*(20) DA C4 C4 C4 +	 btn_iniciar db	 14 dup(" "),218,196,196,196,196,196,196,196,196,196,191,13,10
     11	      C4 C4 C4 C4 C4 C4	BF+
     12	      0D 0A
     13	001F  0E*(20) B3 20 20 4A +		      db 14 dup(" "),179,"  JOGAR  ",179,10,13
     14	      4F 47 41 52 20 20	B3+
     15	      0A 0D
     16	003A  0E*(20) C0 C4 C4 C4 +		      db 14 dup(" "),192,196,196,196,196,196,196,196,196,196,217,13,10
     17	      C4 C4 C4 C4 C4 C4	D9+
     18	      0D 0A
     19
     20	      =0051			 btn_iniciar_length equ	$-btn_iniciar
     21
     22	0055  0E*(20) DA C4 C4 C4 +	 btn_sair db  14 dup(" "),218,196,196,196,196,196,196,196,196,196,191,13,10
     23	      C4 C4 C4 C4 C4 C4	BF+
     24	      0D 0A
     25	0070  0E*(20) B3 20 20 53 +		   db 14 dup(" "),179,"	 SAIR	",179,10,13
     26	      41 49 52 20 20 20	B3+
     27	      0A 0D
     28	008B  0E*(20) C0 C4 C4 C4 +		   db 14 dup(" "),192,196,196,196,196,196,196,196,196,196,217,13,10
     29	      C4 C4 C4 C4 C4 C4	D9+
     30	      0D 0A
     31
     32	      =0051			 btn_sair_length equ $-btn_sair
     33	00A6  02*(20) 20 20 20 20 +	 string	 db 2 dup(" "),"				    ",13,10
     34	      20 20 20 20 20 20	20+
     35	      20 20 20 20 20 20	20+
     36	      20 20 20 20 20 20	20+
     37	      20 20 20 20 20 20	20+
     38	      20 20 20 20 0D 0A
     39	00CE  02*(20) 20 20 5F 5F +		 db 2 dup(" "),"  ___			 _    _	    ",13,10
     40	      5F 20 20 20 20 20	20+
     41	      20 20 20 20 20 20	20+
     42	      20 20 20 20 20 20	20+
     43	      5F 20 20 20 20 5F	20+
     44	      20 20 20 20 0D 0A
     45	00F6  02*(20) 20 2F 20 5F +		 db 2 dup(" ")," / __| __ _ _ __ _ _ __	| |__| |___ ",13,10
     46	      5F 7C 20 5F 5F 20	5F+
     47	      20 5F 20 5F 5F 20	5F+
     48	      20 5F 20 5F 5F 20	7C+
     49	      20 7C 5F 5F 7C 20	7C+
     50	      5F 5F 5F 20 0D 0A
     51	011E  02*(20) 20 5C 5F 5F +		 db 2 dup(" ")," \__ \/	_| '_/ _` | '  \| '_ \ / -_)",13,10
     52	      20 5C 2F 20 5F 7C	20+
     53	      27 5F 2F 20 5F 60	20+
     54	      7C 20 27 20 20 5C	7C+
     55	      20 27 5F 20 5C 20	2F+
     56	      20 2D 5F 29 0D 0A
     57	0146  02*(20) 20 7C 5F 5F +		 db 2 dup(" ")," |___/\__|_| \__,_|_|_|_|_.__/_\___|",13,10
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 2
MAIN.ASM



     58	      5F 2F 5C 5F 5F 7C	5F+
     59	      7C 20 5C 5F 5F 2C	5F+
     60	      7C 5F 7C 5F 7C 5F	7C+
     61	      5F 2E 5F 5F 2F 5F	5C+
     62	      5F 5F 5F 7C 0D 0A
     63
     64
     65	      =00C8			 string_length equ $-string
     66	016E  00 00 00 00 00 00	00+	 meteor_sprite	 db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
     67	      00 00 00 00 00 00	00+
     68	      00 00 00 00 00 00	00+
     69	      00 00 00
     70	0186  00 00 00 00 00 00	00+			 db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
     71	      00 00 00 00 00 00	00+
     72	      00 00 00 00 00 00	00+
     73	      00 00 00
     74	019E  00 00 00 00 00 00	00+			 db 0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0
     75	      00 00 01 01 01 01	00+
     76	      00 00 00 00 00 00	00+
     77	      00 00 00
     78	01B6  00 00 00 00 00 00	01+			 db 0,0,0,0,0,0,1,1,4,4,4,4,4,1,0,0,0,0,0,0,0,0,0,0
     79	      01 04 04 04 04 04	01+
     80	      00 00 00 00 00 00	00+
     81	      00 00 00
     82	01CE  00 00 00 00 00 01	04+			 db 0,0,0,0,0,1,4,4,4,4,4,4,4,4,1,0,1,1,0,0,0,0,0,0
     83	      04 04 04 04 04 04	04+
     84	      01 00 01 01 00 00	00+
     85	      00 00 00
     86	01E6  00 00 00 00 00 01	04+			 db 0,0,0,0,0,1,4,4,4,4,4,4,4,4,1,0,1,1,0,0,0,0,0,0
     87	      04 04 04 04 04 04	04+
     88	      01 00 01 01 00 00	00+
     89	      00 00 00
     90	01FE  00 00 00 00 01 04	04+			 db 0,0,0,0,1,4,4,4,5,5,5,5,4,4,4,1,0,0,0,0,0,0,0,0
     91	      04 05 05 05 05 04	04+
     92	      04 01 00 00 00 00	00+
     93	      00 00 00
     94	0216  00 00 00 01 04 04	05+			 db 0,0,0,1,4,4,5,5,5,5,5,5,5,4,4,1,0,0,0,0,0,0,0,0
     95	      05 05 05 05 05 05	04+
     96	      04 01 00 00 00 00	00+
     97	      00 00 00
     98	022E  00 00 00 01 04 04	05+			 db 0,0,0,1,4,4,5,5,5,5,5,5,5,5,4,1,5,5,0,0,0,0,0,0
     99	      05 05 05 05 05 05	05+
    100	      04 01 05 05 00 00	00+
    101	      00 00 00
    102	0246  00 00 00 01 04 04	04+			 db 0,0,0,1,4,4,4,5,5,5,5,5,5,4,4,1,4,5,0,0,0,0,0,0
    103	      05 05 05 05 05 05	04+
    104	      04 01 04 05 00 00	00+
    105	      00 00 00
    106	025E  00 00 00 01 04 04	04+			 db 0,0,0,1,4,4,4,5,5,5,5,5,5,4,4,1,4,5,0,0,0,0,0,0
    107	      05 05 05 05 05 05	04+
    108	      04 01 04 05 00 00	00+
    109	      00 00 00
    110	0276  00 00 00 01 04 04	04+			 db 0,0,0,1,4,4,4,5,5,5,5,5,5,4,4,1,4,5,0,0,0,0,0,0
    111	      05 05 05 05 05 05	04+
    112	      04 01 04 05 00 00	00+
    113	      00 00 00
    114	028E  00 00 00 00 01 04	04+			 db 0,0,0,0,1,4,4,4,4,5,5,5,4,4,1,0,0,0,0,0,0,0,0,0
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 3
MAIN.ASM



    115	      04 04 05 05 05 04	04+
    116	      01 00 00 00 00 00	00+
    117	      00 00 00
    118	02A6  00 00 00 00 01 04	04+			 db 0,0,0,0,1,4,4,4,4,4,4,4,4,4,1,0,1,5,0,0,0,0,0,0
    119	      04 04 04 04 04 04	04+
    120	      01 00 01 05 00 00	00+
    121	      00 00 00
    122	02BE  00 00 00 00 00 01	04+			 db 0,0,0,0,0,1,4,4,4,4,4,4,4,1,0,0,0,0,0,0,0,0,0,0
    123	      04 04 04 04 04 04	01+
    124	      00 00 00 00 00 00	00+
    125	      00 00 00
    126	02D6  00 00 00 00 00 00	01+			 db 0,0,0,0,0,0,1,4,4,4,4,4,1,0,4,4,0,0,0,0,0,0,0,0
    127	      04 04 04 04 04 01	00+
    128	      04 04 00 00 00 00	00+
    129	      00 00 00
    130	02EE  00 00 00 00 00 00	01+			 db 0,0,0,0,0,0,1,4,4,4,4,4,1,0,4,4,0,0,0,0,0,0,0,0
    131	      04 04 04 04 04 01	00+
    132	      04 04 00 00 00 00	00+
    133	      00 00 00
    134	0306  00 00 00 00 00 00	00+			 db 0,0,0,0,0,0,0,1,1,1,1,1,0,0,1,0,0,0,0,0,0,0,0,0
    135	      01 01 01 01 01 00	00+
    136	      01 00 00 00 00 00	00+
    137	      00 00 00
    138	031E  00 00 00 00 00 00	00+			 db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
    139	      00 00 00 00 00 00	00+
    140	      00 00 00 00 00 00	00+
    141	      00 00 00
    142	0336  00 00 00 00 00 00	00+			 db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
    143	      00 00 00 00 00 00	00+
    144	      00 00 00 00 00 00	00+
    145	      00 00 00
    146
    147
    148	034E  00 00 00 00 00 00	00+	 alien_sprite	 db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
    149	      00 00 00 00 00 00	00+
    150	      00 00 00 00 00 00	00+
    151	      00 00 00
    152	0366  00 00 00 00 00 00	00+			 db 0,0,0,0,0,0,0,0,0,0AH,0AH,0AH,2,0EH,0AH,0AH,0AH,0,0,0,0,0,0,0
    153	      00 00 0A 0A 0A 02	0E+
    154	      0A 0A 0A 00 00 00	00+
    155	      00 00 00
    156	037E  00 00 00 00 00 00	0E+			 db 0,0,0,0,0,0,0EH,2,2,2,2,2,2,2,2,2,2,0EH,0,0,0,0,0,0
    157	      02 02 02 02 02 02	02+
    158	      02 02 02 0E 00 00	00+
    159	      00 00 00
    160	0396  00 00 00 00 00 00	0E+			 db 0,0,0,0,0,0,0EH,2,2,2,2,2,2,2,2,2,2,0EH,0,0,0,0,0,0
    161	      02 02 02 02 02 02	02+
    162	      02 02 02 0E 00 00	00+
    163	      00 00 00
    164	03AE  00 00 00 00 00 0E	02+			 db 0,0,0,0,0,0EH,2,2,2,2,2,2,2,2,2,2,2,2,0EH,0,0,0,0,0
    165	      02 02 02 02 02 02	02+
    166	      02 02 02 02 0E 00	00+
    167	      00 00 00
    168	03C6  00 00 00 00 00 0E	0E+			 db 0,0,0,0,0,0EH,0EH,0AH,5,5,0AH,2,0EH,0AH,5,5,0AH,0EH,0EH,0,0,0,0,0
    169	      0A 05 05 0A 02 0E	0A+
    170	      05 05 0A 0E 0E 00	00+
    171	      00 00 00
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 4
MAIN.ASM



    172	03DE  00 00 00 00 00 0E	0E+			 db 0,0,0,0,0,0EH,0EH,0AH,5,5,0AH,2,0EH,0AH,5,5,0AH,0EH,0EH,0,0,0,0,0
    173	      0A 05 05 0A 02 0E	0A+
    174	      05 05 0A 0E 0E 00	00+
    175	      00 00 00
    176	03F6  00 00 00 00 00 0E	0E+			 db 0,0,0,0,0,0EH,0EH,0EH,0AH,0AH,0AH,2,0EH,0AH,0AH,0AH,0EH,0EH,0EH,0,0,0,0,0
    177	      0E 0A 0A 0A 02 0E	0A+
    178	      0A 0A 0E 0E 0E 00	00+
    179	      00 00 00
    180	040E  00 00 00 00 00 00	00+			 db 0,0,0,0,0,0,0,0EH,0AH,2,5,5,2,5,5,2,0AH,0EH,0,0,0,0,0,0
    181	      0E 0A 02 05 05 02	05+
    182	      05 02 0A 0E 00 00	00+
    183	      00 00 00
    184	0426  00 00 00 00 00 00	00+			 db 0,0,0,0,0,0,0,0EH,0AH,2,5,5,2,5,5,2,0AH,0EH,0,0,0,0,0,0
    185	      0E 0A 02 05 05 02	05+
    186	      05 02 0A 0E 00 00	00+
    187	      00 00 00
    188	043E  00 00 00 00 00 00	00+			 db 0,0,0,0,0,0,0,0EH,0AH,2,5,5,0AH,5,5,2,0AH,0EH,0,0,0,0,0,0
    189	      0E 0A 02 05 05 0A	05+
    190	      05 02 0A 0E 00 00	00+
    191	      00 00 00
    192	0456  00 00 00 00 00 00	00+			 db 0,0,0,0,0,0,0,0EH,0AH,2,5,5,0AH,5,5,2,0AH,0EH,0,0,0,0,0,0
    193	      0E 0A 02 05 05 0A	05+
    194	      05 02 0A 0E 00 00	00+
    195	      00 00 00
    196	046E  00 00 00 00 00 00	00+			 db 0,0,0,0,0,0,0,0EH,0AH,2,5,5,2,5,5,2,0AH,0EH,0,0,0,0,0,0
    197	      0E 0A 02 05 05 02	05+
    198	      05 02 0A 0E 00 00	00+
    199	      00 00 00
    200	0486  00 00 00 00 00 00	00+			 db 0,0,0,0,0,0,0,0EH,0AH,2,5,5,2,5,5,2,0AH,0EH,0,0,0,0,0,0
    201	      0E 0A 02 05 05 02	05+
    202	      05 02 0A 0E 00 00	00+
    203	      00 00 00
    204	049E  00 00 00 00 00 00	00+			 db 0,0,0,0,0,0,0,0,0AH,0AH,0AH,2,0EH,0AH,0AH,0AH,0,0,0,0,0,0,0
    205	      00 0A 0A 0A 02 0E	0A+
    206	      0A 0A 00 00 00 00	00+
    207	      00 00
    208	04B5  00 00 00 00 00 00	00+			 db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
    209	      00 00 00 00 00 00	00+
    210	      00 00 00 00 00 00	00+
    211	      00 00 00
    212	04CD  00 00 00 00 00 00	00+			 db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
    213	      00 00 00 00 00 00	00+
    214	      00 00 00 00 00 00	00+
    215	      00 00 00
    216	04E5  00 00 00 00 00 00	00+			 db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
    217	      00 00 00 00 00 00	00+
    218	      00 00 00 00 00 00	00+
    219	      00 00 00
    220	04FD  00 00 00 00 00 00	00+			 db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
    221	      00 00 00 00 00 00	00+
    222	      00 00 00 00 00 00	00+
    223	      00 00 00
    224	0515  00 00 00 00 00 00	00+			 db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
    225	      00 00 00 00 00 00	00+
    226	      00 00 00 00 00 00	00+
    227	      00 00 00
    228	052D  00 00 00 00 00 00	00+			 db 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 5
MAIN.ASM



    229	      00 00 00 00 00 00	00+
    230	      00 00 00 00 00 00	00+
    231	      00 00 00
    232
    233	0545  9D6C			 alien_pos dw 125*320 +	300 ; posição	inicial	(linha 125, x =	300)
    234	0547  00			 alien_dir db 0	 ; direção do	alien (0=esquerda, 1=direita)
    235
    236					 ; Sprite da nave principal (29x13 pixels) - baseado no	exemplo
    237	0548  00 00 00 00 00 00	00+	 ship_sprite db	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
    238	      00 00 00 00 00 00	00+
    239	      00 00 00 00 00 00	00+
    240	      00 00 00
    241	0560  00 00 00 00 00 00	00+		     db	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
    242	      00 00 00 00 00 00	00+
    243	      00 00 00 00 00 00	00+
    244	      00 00 00
    245	0578  00 00 00 00 00 00	00+		     db	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
    246	      00 00 00 00 00 00	00+
    247	      00 00 00 00 00 00	00+
    248	      00 00 00
    249	0590  00 00 00 00 00 00	00+		     db	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
    250	      00 00 00 00 00 00	00+
    251	      00 00 00 00 00 00	00+
    252	      00 00 00
    253	05A8  00 00 00 00 00 00	00+		     db	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
    254	      00 00 00 00 00 00	00+
    255	      00 00 00 00 00 00	00+
    256	      00 00 00
    257	05C0  00 00 00 00 00 0F	0F+		     db	0,0,0,0,0,15,15,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
    258	      0F 00 00 00 00 00	00+
    259	      00 00 00 00 00 00	00+
    260	      00 00 00
    261	05D8  00 00 00 00 00 00	01+		     db	0,0,0,0,0,0,1,15,15,0AH,0AH,0AH,0,0,0,0,0,0,0,0,0,0,0,0
    262	      0F 0F 0A 0A 0A 00	00+
    263	      00 00 00 00 00 00	00+
    264	      00 00 00
    265	05F0  00 00 00 00 00 00	01+		     db	0,0,0,0,0,0,1,15,15,15,0AH,0AH,0,0,0,0,0,0,0,0,0,0,0,0
    266	      0F 0F 0F 0A 0A 00	00+
    267	      00 00 00 00 00 00	00+
    268	      00 00 00
    269	0608  00 00 00 00 00 00	01+		     db	0,0,0,0,0,0,1,15,15,15,15,15,15,0,0,0,0,0,0,0,0,0,0,0
    270	      0F 0F 0F 0F 0F 0F	00+
    271	      00 00 00 00 00 00	00+
    272	      00 00 00
    273	0620  00 00 00 00 00 00	01+		     db	0,0,0,0,0,0,1,09H,09H,09H,09H,09H,09H,15,15,15,15,15,15,0,0,0,0,0
    274	      09 09 09 09 09 09	0F+
    275	      0F 0F 0F 0F 0F 00	00+
    276	      00 00 00
    277	0638  00 00 00 00 00 00	01+		     db	0,0,0,0,0,0,1,09H,09H,09H,09H,09H,09H,15,15,15,15,15,15,0,0,0,0,0
    278	      09 09 09 09 09 09	0F+
    279	      0F 0F 0F 0F 0F 00	00+
    280	      00 00 00
    281	0650  00 00 00 00 00 00	01+		     db	0,0,0,0,0,0,1,15,15,15,15,15,15,0,0,0,0,0,0,0,0,0,0,0
    282	      0F 0F 0F 0F 0F 0F	00+
    283	      00 00 00 00 00 00	00+
    284	      00 00 00
    285	0668  00 00 00 00 00 00	01+		     db	0,0,0,0,0,0,1,15,15,15,0AH,0AH,0,0,0,0,0,0,0,0,0,0,0,0
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 6
MAIN.ASM



    286	      0F 0F 0F 0A 0A 00	00+
    287	      00 00 00 00 00 00	00+
    288	      00 00 00
    289	0680  00 00 00 00 00 00	01+		     db	0,0,0,0,0,0,1,15,15,0AH,0AH,0AH,0,0,0,0,0,0,0,0,0,0,0,0
    290	      0F 0F 0A 0A 0A 00	00+
    291	      00 00 00 00 00 00	00+
    292	      00 00 00
    293	0698  00 00 00 00 00 0F	0F+		     db	0,0,0,0,0,15,15,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
    294	      0F 00 00 00 00 00	00+
    295	      00 00 00 00 00 00	00+
    296	      00 00 00
    297	06B0  00 00 00 00 00 00	00+		     db	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
    298	      00 00 00 00 00 00	00+
    299	      00 00 00 00 00 00	00+
    300	      00 00
    301	06C7  00 00 00 00 00 00	00+		     db	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
    302	      00 00 00 00 00 00	00+
    303	      00 00 00 00 00 00	00+
    304	      00 00 00
    305	06DF  00 00 00 00 00 00	00+		     db	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
    306	      00 00 00 00 00 00	00+
    307	      00 00 00 00 00 00	00+
    308	      00 00 00
    309	06F7  00 00 00 00 00 00	00+		     db	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
    310	      00 00 00 00 00 00	00+
    311	      00 00 00 00 00 00	00+
    312	      00 00 00
    313	070F  00 00 00 00 00 00	00+		     db	0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
    314	      00 00 00 00 00 00	00+
    315	      00 00 00 00 00 00	00+
    316	      00 00 00
    317
    318					 ; Sprite do tiro (8x6 pixels) - horizontal
    319	0727  00 00 00 00 00 00		 shot_sprite db	0,0,0,0,0,0
    320	072D  00 00 00 00 00 00			     db	0,0,0,0,0,0
    321	0733  00 00 0F 0F 00 00			     db	0,0,15,15,0,0
    322	0739  00 00 0F 0F 00 00			     db	0,0,15,15,0,0
    323	073F  00 00 00 00 00 00			     db	0,0,0,0,0,0
    324	0745  00 00 00 00 00 00			     db	0,0,0,0,0,0
    325
    326	      =0064			 ROW_METEOR  EQU 100
    327	      =007D			 ROW_ALIEN   EQU 125
    328	      =004B			 ROW_SHIP    EQU 75
    329
    330					 ; Fase	3: Nave	mais alta, terreno mais	baixo
    331	      =0032			 ROW_SHIP_FASE3	   EQU 50      ; Nave na linha 50
    332	      =0096			 ROW_TERRAIN_FASE3 EQU 150     ; Terreno começa na linha 150
    333	      =0032			 ROW_ALIEN_FASE3   EQU 50      ; Aliens	mais acima (linhas 50-90)
    334
    335	      =7E2C			 meteor_pos_ini	EQU ROW_METEOR*320 + 300  ; posição inicial do meteoro (linha	100, x = 300)
    336	074B  7E2C			 meteor_pos dw meteor_pos_ini ;	posição inicial (linha 100, x	= 300)
    337
    338	      =5DC0			 ship_pos_ini EQU ROW_SHIP*320
    339	074D  5DC0			 ship_pos dw ship_pos_ini ; posição inicial (linha 95, coluna	41)
    340	      =0005			 ship_speed EQU	5
    341
    342					 ; Sistema de tiro (3 tiros simultâneos)
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 7
MAIN.ASM



    343	074F  03			 shot_count db 3
    344	0750  0000 0000	0000		 shot_pos dw 0,	0, 0	   ; Posições	dos 3 tiros
    345	0756  00 00 00			 shot_active db	0, 0, 0	   ; Status dos	3 tiros	(0=inativo, 1=ativo)
    346
    347					 ; Sistema de aliens/meteoros (usa mesmo sistema para ambos)
    348	0759  05			 alien_count db	5
    349	075A  05*(0000)			 alien_array_pos dw 5 dup(0)  ;	Expandido para 5
    350	0764  05*(00)			 alien_array_active db 5 dup(0)	; Expandido para 5
    351	0769  0000			 alien_spawn_timer dw 0
    352	076B  003C			 alien_spawn_delay dw 60      ;	60 frames = ~1 segundo
    353	076D  0001			 alien_move_speed dw 1	      ;	Velocidade de movimento	aliens fase 1 (pixels por frame)
    354	076F  0001			 meteor_move_speed dw 1	      ;	Velocidade de movimento	meteoros fase 2	(pixels	por frame)
    355	0771  003C			 meteor_spawn_delay dw 60     ;	45 frames entre	spawns de meteoros
    356	0773  0003			 alien_fase3_move_speed	dw 3  ;	Velocidade maior para fase 3
    357	0775  002D			 alien_fase3_spawn_delay dw 45	; Spawn	mais rápido na	fase 3
    358
    359	      =0003			 LIFES_START EQU 3
    360	0777  03			 lives db LIFES_START  ; número de vidas
    361
    362	      =0140			 SCREEN_W    EQU 320
    363	      =00C8			 SCREEN_H    EQU 200
    364
    365	      =0018			 SPR_W	     EQU 24  ; para meteoro e alien
    366	      =0014			 SPR_H	     EQU 20
    367
    368	0778  07*(20) 20 5F 5F 5F +	 fase1	 db 7 dup(" ")," ___		      _	",13,10
    369	      20 20 20 20 20 20	20+
    370	      20 20 20 20 20 20	20+
    371	      20 20 20 20 5F 20	0D+
    372	      0A
    373	0799  07*(20) 7C 20 5F 5F +		 db 7 dup(" "),"| __|_ _ ___ ___     / |",13,10
    374	      7C 5F 20 5F 20 5F	5F+
    375	      5F 20 5F 5F 5F 20	20+
    376	      20 20 20 2F 20 7C	0D+
    377	      0A
    378	07BA  07*(20) 7C 20 5F 2F +		 db 7 dup(" "),"| _/ _`	(_-</ -_)    | |",13,10
    379	      20 5F 60 20 28 5F	2D+
    380	      3C 2F 20 2D 5F 29	20+
    381	      20 20 20 7C 20 7C	0D+
    382	      0A
    383	07DB  07*(20) 7C 5F 7C 5C +		 db 7 dup(" "),"|_|\__,_/__/\___|    |_|",13,10
    384	      5F 5F 2C 5F 2F 5F	5F+
    385	      2F 5C 5F 5F 5F 7C	20+
    386	      20 20 20 7C 5F 7C	0D+
    387	      0A
    388	07FC  07*(20) 20 20 20 20 +		 db 7 dup(" "),"			",13,10
    389	      20 20 20 20 20 20	20+
    390	      20 20 20 20 20 20	20+
    391	      20 20 20 20 20 20	0D+
    392	      0A
    393	081D  07*(20) 20 20 20 20 +		 db 7 dup(" "),"			",13,10
    394	      20 20 20 20 20 20	20+
    395	      20 20 20 20 20 20	20+
    396	      20 20 20 20 20 20	0D+
    397	      0A
    398
    399	083E  07*(20) 20 5F 5F 5F +	 fase2	 db 7 dup(" ")," ___		    ___	",13,10
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 8
MAIN.ASM



    400	      20 20 20 20 20 20	20+
    401	      20 20 20 20 20 20	20+
    402	      20 20 5F 5F 5F 20	0D+
    403	      0A
    404	085F  07*(20) 7C 20 5F 5F +		 db 7 dup(" "),"| __|_ _ ___ ___   |_  )",13,10
    405	      7C 5F 20 5F 20 5F	5F+
    406	      5F 20 5F 5F 5F 20	20+
    407	      20 7C 5F 20 20 29	0D+
    408	      0A
    409	0880  07*(20) 7C 20 5F 2F +		 db 7 dup(" "),"| _/ _`	(_-</ -_)   / /	",13,10
    410	      20 5F 60 20 28 5F	2D+
    411	      3C 2F 20 2D 5F 29	20+
    412	      20 20 2F 20 2F 20	0D+
    413	      0A
    414	08A1  07*(20) 7C 5F 7C 5C +		 db 7 dup(" "),"|_|\__,_/__/\___|  /___|",13,10
    415	      5F 5F 2C 5F 2F 5F	5F+
    416	      2F 5C 5F 5F 5F 7C	20+
    417	      20 2F 5F 5F 5F 7C	0D+
    418	      0A
    419	08C2  07*(20) 20 20 20 20 +		 db 7 dup(" "),"			",13,10
    420	      20 20 20 20 20 20	20+
    421	      20 20 20 20 20 20	20+
    422	      20 20 20 20 20 20	0D+
    423	      0A
    424	08E3  07*(20) 20 20 20 20 +		 db 7 dup(" "),"			",13,10
    425	      20 20 20 20 20 20	20+
    426	      20 20 20 20 20 20	20+
    427	      20 20 20 20 20 20	0D+
    428	      0A
    429
    430	0904  07*(20) 20 5F 5F 5F +	 fase3	 db 7 dup(" ")," ___		    ____",13,10
    431	      20 20 20 20 20 20	20+
    432	      20 20 20 20 20 20	20+
    433	      20 20 5F 5F 5F 5F	0D+
    434	      0A
    435	0925  07*(20) 7C 20 5F 5F +		 db 7 dup(" "),"| __|_ _ ___ ___   |__ /",13,10
    436	      7C 5F 20 5F 20 5F	5F+
    437	      5F 20 5F 5F 5F 20	20+
    438	      20 7C 5F 5F 20 2F	0D+
    439	      0A
    440	0946  07*(20) 7C 20 5F 2F +		 db 7 dup(" "),"| _/ _`	(_-</ -_)   |_ \",13,10
    441	      20 5F 60 20 28 5F	2D+
    442	      3C 2F 20 2D 5F 29	20+
    443	      20 20 7C 5F 20 5C	0D+
    444	      0A
    445	0967  07*(20) 7C 5F 7C 5C +		 db 7 dup(" "),"|_|\__,_/__/\___|  |___/",13,10
    446	      5F 5F 2C 5F 2F 5F	5F+
    447	      2F 5C 5F 5F 5F 7C	20+
    448	      20 7C 5F 5F 5F 2F	0D+
    449	      0A
    450	0988  07*(20) 20 20 20 20 +		 db 7 dup(" "),"			",13,10
    451	      20 20 20 20 20 20	20+
    452	      20 20 20 20 20 20	20+
    453	      20 20 20 20 20 20	0D+
    454	      0A
    455	09A9  07*(20) 20 20 20 20 +		 db 7 dup(" "),"			",13,10
    456	      20 20 20 20 20 20	20+
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 9
MAIN.ASM



    457	      20 20 20 20 20 20	20+
    458	      20 20 20 20 20 20	0D+
    459	      0A
    460
    461	      =00C6			 fase_string_length equ	$-fase3
    462
    463	09CA  0778r 083Er 0904r		 fase_vec dw offset fase1, offset fase2, offset	fase3
    464
    465					 ; ASCII art para Game Over
    466	09D0  05*(20) 20 20 20 20 +	 game_over_msg	 db 5 dup(" "),"			  ",13,10
    467	      20 20 20 20 20 20	20+
    468	      20 20 20 20 20 20	20+
    469	      20 20 20 20 20 20	20+
    470	      20 0D 0A
    471	09F1  05*(20) 20 20 20 5F +			 db 5 dup(" "),"   ___	 _   __	 __ ___	 ",13,10
    472	      5F 5F 20 20 20 5F	20+
    473	      20 20 5F 5F 20 20	5F+
    474	      5F 20 5F 5F 5F 20	20+
    475	      0D 0A
    476	0A11  05*(20) 20 20 2F 20 +			 db 5 dup(" "),"  / __|	/_\ |  \/  | __| ",13,10
    477	      5F 5F 7C 20 2F 5F	5C+
    478	      20 7C 20 20 5C 2F	20+
    479	      20 7C 20 5F 5F 7C	20+
    480	      0D 0A
    481	0A31  05*(20) 20 7C 20 28 +			 db 5 dup(" ")," | (_ |/ _ \| |\/| | _|	 ",13,10
    482	      5F 20 7C 2F 20 5F	20+
    483	      5C 7C 20 7C 5C 2F	7C+
    484	      20 7C 20 5F 7C 20	20+
    485	      0D 0A
    486	0A51  05*(20) 20 20 5C 5F +			 db 5 dup(" "),"  \___/_/ \_\_|_ |_|___| ",13,10
    487	      5F 5F 2F 5F 2F 20	5C+
    488	      5F 5C 5F 7C 5F 20	7C+
    489	      5F 7C 5F 5F 5F 7C	20+
    490	      0D 0A
    491	0A71  05*(20) 20 20 2F 20 +			 db 5 dup(" "),"  / _ \	\ / / __| _ \	 ",13,10
    492	      5F 20 5C 20 5C 20	2F+
    493	      20 2F 20 5F 5F 7C	20+
    494	      5F 20 5C 20 20 20	20+
    495	      0D 0A
    496	0A91  05*(20) 20 7C 20 28 +			 db 5 dup(" ")," | (_) \ V /| _||   /	 ",13,10
    497	      5F 29 20 5C 20 56	20+
    498	      2F 7C 20 5F 7C 7C	20+
    499	      20 20 2F 20 20 20	20+
    500	      0D 0A
    501	0AB1  05*(20) 20 20 5C 5F +			 db 5 dup(" "),"  \___/	\_/ |___|_|_\	 ",13,10
    502	      5F 5F 2F 20 5C 5F	2F+
    503	      20 7C 5F 5F 5F 7C	5F+
    504	      7C 5F 5C 20 20 20	20+
    505	      0D 0A
    506	0AD1  05*(20) 20 20 20 20 +			 db 5 dup(" "),"			  ",13,10
    507	      20 20 20 20 20 20	20+
    508	      20 20 20 20 20 20	20+
    509	      20 20 20 20 20 20	20+
    510	      20 0D 0A
    511
    512	      =0122			 game_over_msg_length equ $-game_over_msg
    513
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 10
MAIN.ASM



    514					 ; ASCII art para Vencedor
    515	0AF2  02*(20) 20 20 20 20 +	 vencedor_msg	 db 2 dup(" "),"				    ",13,10
    516	      20 20 20 20 20 20	20+
    517	      20 20 20 20 20 20	20+
    518	      20 20 20 20 20 20	20+
    519	      20 20 20 20 20 20	20+
    520	      20 20 20 20 0D 0A
    521	0B1A  02*(20) 20 5F 5F 20 +			 db 2 dup(" ")," __   __		  _	    ",13,10
    522	      20 20 5F 5F 20 20	20+
    523	      20 20 20 20 20 20	20+
    524	      20 20 20 20 20 20	20+
    525	      20 5F 20 20 20 20	20+
    526	      20 20 20 20 0D 0A
    527	0B42  02*(20) 20 5C 20 5C +			 db 2 dup(" ")," \ \ / /__ _ _	__ ___ __| |___	_ _ ",13,10
    528	      20 2F 20 2F 5F 5F	20+
    529	      5F 20 5F 20 20 5F	5F+
    530	      20 5F 5F 5F 20 5F	5F+
    531	      7C 20 7C 5F 5F 5F	20+
    532	      5F 20 5F 20 0D 0A
    533	0B6A  02*(20) 20 20 5C 20 +			 db 2 dup(" "),"  \ V /	-_) ' \/ _/ -_)	_` / _ \ '_|",13,10
    534	      56 20 2F 20 2D 5F	29+
    535	      20 27 20 5C 2F 20	5F+
    536	      2F 20 2D 5F 29 20	5F+
    537	      60 20 2F 20 5F 20	5C+
    538	      20 27 5F 7C 0D 0A
    539	0B92  02*(20) 20 20 20 5C +			 db 2 dup(" "),"   \_/\___|_||_\__\___\__,_\___/_|  ",13,10
    540	      5F 2F 5C 5F 5F 5F	7C+
    541	      5F 7C 7C 5F 5C 5F	5F+
    542	      5C 5F 5F 5F 5C 5F	5F+
    543	      2C 5F 5C 5F 5F 5F	2F+
    544	      5F 7C 20 20 0D 0A
    545	0BBA  02*(20) 20 20 20 20 +			 db 2 dup(" "),"				    ",13,10
    546	      20 20 20 20 20 20	20+
    547	      20 20 20 20 20 20	20+
    548	      20 20 20 20 20 20	20+
    549	      20 20 20 20 20 20	20+
    550	      20 20 20 20 0D 0A
    551
    552	      =00F0			 vencedor_msg_length equ $-vencedor_msg
    553
    554
    555					 ; Mensagem para pressionar tecla
    556	0BE2  50 72 65 73 73 69	6F+	 press_key_msg db "Pressione qualquer tecla",13,10,0
    557	      6E 65 20 71 75 61	6C+
    558	      71 75 65 72 20 74	65+
    559	      63 6C 61 0D 0A 00
    560	      =001B			 press_key_msg_length equ $-press_key_msg
    561
    562					 ; Mensagem de score final
    563	0BFD  53 43 4F 52 45 20	46+	 final_score_msg db "SCORE FINAL: ",0
    564	      49 4E 41 4C 3A 20	00
    565	      =000E			 final_score_msg_length	equ $-final_score_msg
    566
    567	      =003C			 SECONDS_START	EQU 60
    568
    569	0C0B  3C			 time db SECONDS_START
    570	0C0C  00			 timeout db 0
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 11
MAIN.ASM



    571	0C0D  30 30			 time_buffer db	'00'
    572	      =0002			 time_buffer_len equ $-time_buffer
    573
    574
    575	0C0F  54 45 4D 50 4F 3A		 time_str db "TEMPO:"
    576	      =0006			 time_str_len equ $-time_str
    577
    578	0C15  0000			 score dw 0
    579	0C17  30 30 30 30 30		 score_buffer db '00000'
    580	      =0005			 score_buffer_len equ $-score_buffer
    581
    582	0C1C  53 43 4F 52 45 3A		 score_str db "SCORE:"
    583	      =0006			 score_str_len equ $-score_str
    584
    585					 ; Terreno da fase 1
    586	0C22  0140*(00)			 terrain_fase1 db 320 dup(0)
    587	0D62  0140*(00)			     db	320 dup(0)
    588	0EA2  A8*(00) 03*(06) 95* +	     db	168 dup(0),3 dup (6),149 dup(0)
    589	      (00)
    590	0FE2  A6*(00) 06*(06) 94* +	     db	166 dup(0),6 dup (6),148 dup(0)
    591	      (00)
    592	1122  22*(00) 04*(06) 07* +	     db	34 dup(0),4 dup	(6),7 dup(0),6 dup (6),63 dup(0),2 dup (6),25 dup(0),6 dup (6),18   +
    593	      (00) 06*(06) 3F*(00)+  dup(0),8 dup (6),87 dup(0),9 dup (6),51 dup(0)
    594	      02*(06) 19*(00) 06* +
    595	      (06) 12*(00) 08*(06)+
    596	      57*(00) 09*(06) 33* +
    597	      (00)
    598	1262  21*(00) 06*(06) 05* +	     db	33 dup(0),6 dup	(6),5 dup(0),9 dup (6),37 dup(0),9 dup (6),12 dup(0),7 dup (6),20   +
    599	      (00) 09*(06) 25*(00)+  dup(0),10 dup (6),17 dup(0),9 dup (6),15 dup(0),5 dup (6),40 dup(0),5 dup (6),19 dup(0),11	dup +
    600	      09*(06) 0C*(00) 07* +  (6),15 dup(0),4 dup (6),32	dup(0)
    601	      (06) 14*(00) 0A*(06)+
    602	      11*(00) 09*(06) 0F* +
    603	      (00) 05*(06) 28*(00)+
    604	      05*(06) 13*(00) 0B* +
    605	      (06) 0F*(00) 04*(06)+
    606	      20*(00)
    607	13A2  0C*(00) 04*(06) 10* +	     db	12 dup(0),4 dup	(6),16 dup(0),7	dup (6),4 dup(0),11 dup	(6),17 dup(0),3	dup (6),15  +
    608	      (00) 07*(06) 04*(00)+  dup(0),11 dup (6),10 dup(0),10 dup	(6),15 dup(0),14 dup (6),15 dup(0),11 dup (6),13 dup(0),7   +
    609	      0B*(06) 11*(00) 03* +  dup (6),8 dup(0),6	dup (6),23 dup(0),9 dup	(6),15 dup(0),15 dup (6),12 dup(0),7 dup (6),30	dup +
    610	      (06) 0F*(00) 0B*(06)+  (0)
    611	      0A*(00) 0A*(06) 0F* +
    612	      (00) 0E*(06) 0F*(00)+
    613	      0B*(06) 0D*(00) 07* +
    614	      (06) 08*(00) 06*(06)+
    615	      17*(00) 09*(06) 0F* +
    616	      (00) 0F*(06) 0C*(00)+
    617	      07*(06) 1E*(00)
    618	14E2  0B*(00) 07*(06) 0E* +	     db	11 dup(0),7 dup	(6),14 dup(0),23 dup (6),16 dup(0),3 dup (6),15	dup(0),11 dup (6),9 +
    619	      (00) 17*(06) 10*(00)+  dup(0),11 dup (6),13 dup(0),17 dup	(6),14 dup(0),12 dup (6),11 dup(0),9 dup (6),5 dup(0),9	dup +
    620	      03*(06) 0F*(00) 0B* +  (6),20 dup(0),12 dup (6),13 dup(0),17 dup (6),10 dup(0),9 dup (6),29 dup(0)
    621	      (06) 09*(00) 0B*(06)+
    622	      0D*(00) 11*(06) 0E* +
    623	      (00) 0C*(06) 0B*(00)+
    624	      09*(06) 05*(00) 09* +
    625	      (06) 14*(00) 0C*(06)+
    626	      0D*(00) 11*(06) 0A* +
    627	      (00) 09*(06) 1D*(00)
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 12
MAIN.ASM



    628	1622  01*(06) 09*(00) 0A* +	     db	1 dup (6),9 dup(0),10 dup (6),10 dup(0),26 dup (6),15 dup(0),5 dup (6),12 dup(0),34 +
    629	      (06) 0A*(00) 1A*(06)+  dup (6),8 dup(0),21 dup (6),12 dup(0),14 dup (6),9	dup(0),11 dup (6),2 dup(0),13 dup (6),16 dup+
    630	      0F*(00) 05*(06) 0C* +  (0),17 dup	(6),8 dup(0),20	dup (6),8 dup(0),11 dup	(6),8 dup(0),3 dup (6),8 dup(0),6 dup (6),2 +
    631	      (00) 22*(06) 08*(00)+  dup(0),1 dup (6)
    632	      15*(06) 0C*(00) 0E* +
    633	      (06) 09*(00) 0B*(06)+
    634	      02*(00) 0D*(06) 10* +
    635	      (00) 11*(06) 08*(00)+
    636	      14*(06) 08*(00) 0B* +
    637	      (06) 08*(00) 03*(06)+
    638	      08*(00) 06*(06) 02* +
    639	      (00) 01*(06)
    640	1762  02*(06) 07*(00) 0C* +	     db	2 dup (6),7 dup(0),12 dup (6),8	dup(0),31 dup (6),10 dup(0),6 dup (6),10 dup(0),65  +
    641	      (06) 08*(00) 1F*(06)+  dup (6),11	dup(0),17 dup (6),7 dup(0),28 dup (6),12 dup(0),49 dup (6),5 dup(0),13 dup (6),5 dup+
    642	      0A*(00) 06*(06) 0A* +  (0),7 dup (6),4 dup(0),11 dup (6)
    643	      (00) 41*(06) 0B*(00)+
    644	      11*(06) 07*(00) 1C* +
    645	      (06) 0C*(00) 31*(06)+
    646	      05*(00) 0D*(06) 05* +
    647	      (00) 07*(06) 04*(00)+
    648	      0B*(06)
    649	18A2  03*(06) 05*(00) 0E* +	     db	3 dup (6),5 dup(0),14 dup (6),4	dup(0),36 dup (6),6 dup(0),10 dup (6),6	dup(0),68   +
    650	      (06) 04*(00) 24*(06)+  dup (6),9 dup(0),19 dup (6),5 dup(0),109 dup (6),3	dup(0),8 dup (6),3 dup(0),12 dup (6)
    651	      06*(00) 0A*(06) 06* +
    652	      (00) 44*(06) 09*(00)+
    653	      13*(06) 05*(00) 6D* +
    654	      (06) 03*(00) 08*(06)+
    655	      03*(00) 0C*(06)
    656	19E2  3F*(06) 04*(00) 0B* +	     db	63 dup (6),4 dup(0),11 dup (6),4 dup(0),71 dup (6),7 dup(0),23 dup (6),1 dup(0),122 +
    657	      (06) 04*(00) 47*(06)+  dup (6),1 dup(0),13 dup (6)
    658	      07*(00) 17*(06) 01* +
    659	      (00) 7A*(06) 01*(00)+
    660	      0D*(06)
    661	1B22  0140*(06)			     db	320 dup	(6)
    662	1C62  0140*(06)			     db	320 dup	(6)
    663	1DA2  0140*(06)			     db	320 dup	(6)
    664	1EE2  19*(06) 03*(05) 16* +	     db	25 dup(6),3 dup(05H),22	dup(6),2 dup(0DH),28 dup(6),4 dup(05H),24 dup(6),3 dup(0DH),+
    665	      (06) 02*(0D) 1C*(06)+  26	dup(6),2 dup(05H),30 dup(6),4 dup(0DH),23 dup(6),3 dup(05H),27 dup(6),2	dup(0DH),25 dup(6),4+
    666	      04*(05) 18*(06) 03* +  dup(05H),20 dup(6)
    667	      (0D) 1A*(06) 02*(05)+
    668	      1E*(06) 04*(0D) 17* +
    669	      (06) 03*(05) 1B*(06)+
    670	      02*(0D) 19*(06) 04* +
    671	      (05) 14*(06)
    672	1FF7  12*(06) 06*(0D) 10* +	     db	18 dup(6),6 dup(0DH),16	dup(6),8 dup(05H),20 dup(6),7 dup(0DH),18 dup(6),9 dup(05H),+
    673	      (06) 08*(05) 14*(06)+  22	dup(6),8 dup(0DH),19 dup(6),7 dup(05H),21 dup(6),10 dup(0DH),17	dup(6),9 dup(05H),20 dup(6),+
    674	      07*(0D) 12*(06) 09* +  8 dup(0DH),18 dup(6)
    675	      (05) 16*(06) 08*(0D)+
    676	      13*(06) 07*(05) 15* +
    677	      (06) 0A*(0D) 11*(06)+
    678	      09*(05) 14*(06) 08* +
    679	      (0D) 12*(06)
    680	20FC  0C*(06) 0C*(05) 0E* +	     db	12 dup(6),12 dup(05H),14 dup(6),14 dup(0DH),16 dup(6),11 dup(05H),15 dup(6),13 dup  +
    681	      (06) 0E*(0D) 10*(06)+  (0DH),18 dup(6),12	dup(05H),16 dup(6),14 dup(0DH),17 dup(6),15 dup(05H),14	dup(6),13 dup(0DH), +
    682	      0B*(05) 0F*(06) 0D* +  15	dup(6),12 dup(05H),13 dup(6)
    683	      (0D) 12*(06) 0C*(05)+
    684	      10*(06) 0E*(0D) 11* +
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 13
MAIN.ASM



    685	      (06) 0F*(05) 0E*(06)+
    686	      0D*(0D) 0F*(06) 0C* +
    687	      (05) 0D*(06)
    688	2206  08*(06) 12*(0D) 0A* +	     db	8 dup(6),18 dup(0DH),10	dup(6),20 dup(05H),12 dup(6),17	dup(0DH),11 dup(6),19 dup   +
    689	      (06) 14*(05) 0C*(06)+  (05H),14 dup(6),18	dup(0DH),13 dup(6),20 dup(05H),12 dup(6),19 dup(0DH),11	dup(6),18 dup(05H), +
    690	      11*(0D) 0B*(06) 13* +  10	dup(6),17 dup(0DH),9 dup(6)
    691	      (05) 0E*(06) 12*(0D)+
    692	      0D*(06) 14*(05) 0C* +
    693	      (06) 13*(0D) 0B*(06)+
    694	      12*(05) 0A*(06) 11* +
    695	      (0D) 09*(06)
    696	231A  04*(06) 19*(05) 06* +	     db	4 dup(6),25 dup(05H),6 dup(6),28 dup(0DH),8 dup(6),24 dup(05H),7 dup(6),26 dup(0DH),+
    697	      (06) 1C*(0D) 08*(06)+  9 dup(6),25 dup(05H),8 dup(6),27 dup(0DH),7 dup(6),26 dup(05H),6 dup(6),24	dup(0DH),5 dup(6)
    698	      18*(05) 07*(06) 1A* +
    699	      (0D) 09*(06) 19*(05)+
    700	      08*(06) 1B*(0D) 07* +
    701	      (06) 1A*(05) 06*(06)+
    702	      18*(0D) 05*(06)
    703	2423  0140*(05)			     db	320 dup	(05H)
    704	2563  0140*(0D)			     db	320 dup	(0DH)
    705	26A3  0140*(05)			     db	320 dup	(05H)
    706	27E3  0140*(0D)			     db	320 dup	(0DH)
    707	2923  0140*(05)			     db	320 dup	(05H)
    708	2A63  0140*(0D)			     db	320 dup	(0DH)
    709	2BA3  0140*(05)			     db	320 dup	(05H)
    710	2CE3  0140*(0D)			     db	320 dup	(0DH)
    711	2E23  0140*(05)			     db	320 dup	(05H)
    712	2F63  0140*(0D)			     db	320 dup	(0DH)
    713	30A3  0140*(05)			     db	320 dup	(05H)
    714	31E3  0140*(0D)			     db	320 dup	(0DH)
    715	3323  0140*(05)			     db	320 dup	(05H)
    716	3463  0140*(0D)			     db	320 dup	(0DH)
    717	35A3  0140*(05)			     db	320 dup	(05H)
    718	36E3  0140*(0D)			     db	320 dup	(0DH)
    719	3823  0140*(05)			     db	320 dup	(05H)
    720	3963  0140*(0D)			     db	320 dup	(0DH)
    721	3AA3  0140*(05)			     db	320 dup	(05H)
    722	3BE3  0140*(0D)			     db	320 dup	(0DH)
    723	3D23  0140*(05)			     db	320 dup	(05H)
    724	3E63  0140*(0D)			     db	320 dup	(0DH)
    725	3FA3  0140*(05)			     db	320 dup	(05H)
    726	40E3  0140*(0D)			     db	320 dup	(0DH)
    727	4223  0140*(05)			     db	320 dup	(05H)
    728	4363  0140*(0D)			     db	320 dup	(0DH)
    729	44A3  0140*(05)			     db	320 dup	(05H)
    730	45E3  0140*(0D)			     db	320 dup	(0DH)
    731	4723  0140*(05)			     db	320 dup	(05H)
    732	4863  0140*(0D)			     db	320 dup	(0DH)
    733	49A3  0140*(05)			     db	320 dup	(05H)
    734	4AE3  0140*(0D)			     db	320 dup	(0DH)
    735	4C23  0140*(05)			     db	320 dup	(05H)
    736	4D63  0140*(0D)			     db	320 dup	(0DH)
    737	4EA3  0140*(05)			     db	320 dup	(05H)
    738	4FE3  0140*(0D)			     db	320 dup	(0DH)
    739	5123  0140*(05)			     db	320 dup	(05H)
    740	5263  0140*(0D)			     db	320 dup	(0DH)
    741	53A3  0140*(05)			     db	320 dup	(05H)
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 14
MAIN.ASM



    742	54E3  0140*(0D)			     db	320 dup	(0DH)
    743	5623  0140*(05)			     db	320 dup	(05H)
    744	5763  0140*(0D)			     db	320 dup	(0DH)
    745	58A3  0140*(05)			     db	320 dup	(05H)
    746	59E3  0140*(0D)			     db	320 dup	(0DH)
    747	5B23  0140*(05)			     db	320 dup	(05H)
    748	5C63  0140*(0D)			     db	320 dup	(0DH)
    749	5DA3  0140*(05)			     db	320 dup	(05H)
    750	5EE3  0140*(0D)			     db	320 dup	(0DH)
    751	6023  0140*(05)			     db	320 dup	(05H)
    752	6163  0140*(0D)			     db	320 dup	(0DH)
    753	62A3  0140*(05)			     db	320 dup	(05H)
    754	63E3  0140*(0D)			     db	320 dup	(0DH)
    755	6523  0140*(05)			     db	320 dup	(05H)
    756	6663  0140*(0D)			     db	320 dup	(0DH)
    757	67A3  0140*(05)			     db	320 dup	(05H)
    758	68E3  0140*(0D)			     db	320 dup	(0DH)
    759	6A23  0140*(05)			     db	320 dup	(05H)
    760
    761					 ; Terreno da fase 2 - mais desafiador com mais	obstáculos
    762	6B63  0140*(00)			 terrain_fase2 db 320 dup(0)
    763	6CA3  0140*(00)			     db	320 dup(0)
    764	6DE3  78*(00) 08*(04) C0* +	     db	120 dup(0),8 dup (4),192 dup(0)
    765	      (00)
    766	6F23  73*(00) 0C*(04) C1* +	     db	115 dup(0),12 dup (4),193 dup(0)
    767	      (00)
    768	7063  32*(00) 06*(04) 0A* +	     db	50 dup(0),6 dup	(4),10 dup(0),8	dup (4),90 dup(0),4 dup	(4),30 dup(0),8	dup (4),100 +
    769	      (00) 08*(04) 5A*(00)+  dup(0),4 dup (4),24 dup(0)
    770	      04*(04) 1E*(00) 08* +
    771	      (04) 64*(00) 04*(04)+
    772	      18*(00)
    773	71B1  2D*(00) 08*(04) 08* +	     db	45 dup(0),8 dup	(4),8 dup(0),12	dup (4),80 dup(0),6 dup	(4),25 dup(0),12 dup (4),95 +
    774	      (00) 0C*(04) 50*(00)+  dup(0),6 dup (4),23 dup(0)
    775	      06*(04) 19*(00) 0C* +
    776	      (04) 5F*(00) 06*(04)+
    777	      17*(00)
    778	72F1  28*(00) 0A*(04) 0F* +	     db	40 dup(0),10 dup (4),15	dup(0),8 dup (4),70 dup(0),8 dup (4),20	dup(0),15 dup (4),85+
    779	      (00) 08*(04) 46*(00)+  dup(0),8 dup (4),21 dup(0)
    780	      08*(04) 14*(00) 0F* +
    781	      (04) 55*(00) 08*(04)+
    782	      15*(00)
    783	741D  23*(00) 0C*(04) 0C* +	     db	35 dup(0),12 dup (4),12	dup(0),10 dup (4),60 dup(0),10 dup (4),18 dup(0),18 dup	(4),+
    784	      (00) 0A*(04) 3C*(00)+  75	dup(0),10 dup (4),20 dup(0)
    785	      0A*(04) 12*(00) 12* +
    786	      (04) 4B*(00) 0A*(04)+
    787	      14*(00)
    788	7535  1E*(00) 0F*(04) 0A* +	     db	30 dup(0),15 dup (4),10	dup(0),12 dup (4),50 dup(0),12 dup (4),15 dup(0),20 dup	(4),+
    789	      (00) 0C*(04) 32*(00)+  65	dup(0),12 dup (4),19 dup(0)
    790	      0C*(04) 0F*(00) 14* +
    791	      (04) 41*(00) 0C*(04)+
    792	      13*(00)
    793	7639  19*(00) 12*(04) 08* +	     db	25 dup(0),18 dup (4),8 dup(0),15 dup (4),40 dup(0),15 dup (4),12 dup(0),25 dup (4), +
    794	      (00) 0F*(04) 28*(00)+  55	dup(0),15 dup (4),17 dup(0)
    795	      0F*(04) 0C*(00) 19* +
    796	      (04) 37*(00) 0F*(04)+
    797	      11*(00)
    798	772E  14*(00) 14*(04) 06* +	     db	20 dup(0),20 dup (4),6 dup(0),18 dup (4),30 dup(0),18 dup (4),10 dup(0),30 dup (4), +
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 15
MAIN.ASM



    799	      (00) 12*(04) 1E*(00)+  45	dup(0),18 dup (4),15 dup(0)
    800	      12*(04) 0A*(00) 1E* +
    801	      (04) 2D*(00) 12*(04)+
    802	      0F*(00)
    803	7814  14*(00) 14*(04) 06* +	     db	20 dup(0),20 dup (4),6 dup(0),18 dup (4),30 dup(0),18 dup (4),10 dup(0),30 dup (4), +
    804	      (00) 12*(04) 1E*(00)+  45	dup(0),18 dup (4),15 dup(0)
    805	      12*(04) 0A*(00) 1E* +
    806	      (04) 2D*(00) 12*(04)+
    807	      0F*(00)
    808	78FA  14*(00) 14*(04) 06* +	     db	20 dup(0),20 dup (4),6 dup(0),18 dup (4),30 dup(0),18 dup (4),10 dup(0),30 dup (4), +
    809	      (00) 12*(04) 1E*(00)+  45	dup(0),18 dup (4),15 dup(0)
    810	      12*(04) 0A*(00) 1E* +
    811	      (04) 2D*(00) 12*(04)+
    812	      0F*(00)
    813	79E0  14*(00) 14*(04) 06* +	     db	20 dup(0),20 dup (4),6 dup(0),18 dup (4),30 dup(0),18 dup (4),10 dup(0),30 dup (4), +
    814	      (00) 12*(04) 1E*(00)+  45	dup(0),18 dup (4),15 dup(0)
    815	      12*(04) 0A*(00) 1E* +
    816	      (04) 2D*(00) 12*(04)+
    817	      0F*(00)
    818	7AC6  14*(00) 14*(04) 06* +	     db	20 dup(0),20 dup (4),6 dup(0),18 dup (4),30 dup(0),18 dup (4),10 dup(0),30 dup (4), +
    819	      (00) 12*(04) 1E*(00)+  45	dup(0),18 dup (4),15 dup(0)
    820	      12*(04) 0A*(00) 1E* +
    821	      (04) 2D*(00) 12*(04)+
    822	      0F*(00)
    823	7BAC  14*(00) 14*(04) 06* +	     db	20 dup(0),20 dup (4),6 dup(0),18 dup (4),30 dup(0),18 dup (4),10 dup(0),30 dup (4), +
    824	      (00) 12*(04) 1E*(00)+  45	dup(0),18 dup (4),15 dup(0)
    825	      12*(04) 0A*(00) 1E* +
    826	      (04) 2D*(00) 12*(04)+
    827	      0F*(00)
    828	7C92  0F*(00) 19*(04) 04* +	     db	15 dup(0),25 dup (4),4 dup(0),20 dup (4),20 dup(0),20 dup (4),8	dup(0),35 dup (4),35+
    829	      (00) 14*(04) 14*(00)+  dup(0),20 dup (4),13 dup(0)
    830	      14*(04) 08*(00) 23* +
    831	      (04) 23*(00) 14*(04)+
    832	      0D*(00)
    833	7D69  0F*(00) 19*(04) 04* +	     db	15 dup(0),25 dup (4),4 dup(0),20 dup (4),20 dup(0),20 dup (4),8	dup(0),35 dup (4),35+
    834	      (00) 14*(04) 14*(00)+  dup(0),20 dup (4),13 dup(0)
    835	      14*(04) 08*(00) 23* +
    836	      (04) 23*(00) 14*(04)+
    837	      0D*(00)
    838	7E40  0F*(00) 19*(04) 04* +	     db	15 dup(0),25 dup (4),4 dup(0),20 dup (4),20 dup(0),20 dup (4),8	dup(0),35 dup (4),35+
    839	      (00) 14*(04) 14*(00)+  dup(0),20 dup (4),13 dup(0)
    840	      14*(04) 08*(00) 23* +
    841	      (04) 23*(00) 14*(04)+
    842	      0D*(00)
    843	7F17  0F*(00) 19*(04) 04* +	     db	15 dup(0),25 dup (4),4 dup(0),20 dup (4),20 dup(0),20 dup (4),8	dup(0),35 dup (4),35+
    844	      (00) 14*(04) 14*(00)+  dup(0),20 dup (4),13 dup(0)
    845	      14*(04) 08*(00) 23* +
    846	      (04) 23*(00) 14*(04)+
    847	      0D*(00)
    848	7FEE  0F*(00) 19*(04) 04* +	     db	15 dup(0),25 dup (4),4 dup(0),20 dup (4),20 dup(0),20 dup (4),8	dup(0),35 dup (4),35+
    849	      (00) 14*(04) 14*(00)+  dup(0),20 dup (4),13 dup(0)
    850	      14*(04) 08*(00) 23* +
    851	      (04) 23*(00) 14*(04)+
    852	      0D*(00)
    853	80C5  0F*(00) 19*(04) 04* +	     db	15 dup(0),25 dup (4),4 dup(0),20 dup (4),20 dup(0),20 dup (4),8	dup(0),35 dup (4),35+
    854	      (00) 14*(04) 14*(00)+  dup(0),20 dup (4),13 dup(0)
    855	      14*(04) 08*(00) 23* +
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 16
MAIN.ASM



    856	      (04) 23*(00) 14*(04)+
    857	      0D*(00)
    858	819C  0140*(04)			     db	320 dup	(4)
    859	82DC  0140*(04)			     db	320 dup	(4)
    860	841C  0140*(04)			     db	320 dup	(4)
    861	855C  1E*(04) 04*(0C) 19* +	     db	30 dup(4),4 dup(0CH),25	dup(4),3 dup(02H),35 dup(4),5 dup(0CH),30 dup(4),4 dup(02H),+
    862	      (04) 03*(02) 23*(04)+  32	dup(4),3 dup(0CH),35 dup(4),5 dup(02H),28 dup(4),4 dup(0CH),30 dup(4)
    863	      05*(0C) 1E*(04) 04* +
    864	      (02) 20*(04) 03*(0C)+
    865	      23*(04) 05*(02) 1C* +
    866	      (04) 04*(0C) 1E*(04)
    867	866D  1E*(04) 04*(0C) 19* +	     db	30 dup(4),4 dup(0CH),25	dup(4),3 dup(02H),35 dup(4),5 dup(0CH),30 dup(4),4 dup(02H),+
    868	      (04) 03*(02) 23*(04)+  32	dup(4),3 dup(0CH),35 dup(4),5 dup(02H),28 dup(4),4 dup(0CH),30 dup(4)
    869	      05*(0C) 1E*(04) 04* +
    870	      (02) 20*(04) 03*(0C)+
    871	      23*(04) 05*(02) 1C* +
    872	      (04) 04*(0C) 1E*(04)
    873	877E  1E*(04) 04*(0C) 19* +	     db	30 dup(4),4 dup(0CH),25	dup(4),3 dup(02H),35 dup(4),5 dup(0CH),30 dup(4),4 dup(02H),+
    874	      (04) 03*(02) 23*(04)+  32	dup(4),3 dup(0CH),35 dup(4),5 dup(02H),28 dup(4),4 dup(0CH),30 dup(4)
    875	      05*(0C) 1E*(04) 04* +
    876	      (02) 20*(04) 03*(0C)+
    877	      23*(04) 05*(02) 1C* +
    878	      (04) 04*(0C) 1E*(04)
    879	888F  19*(04) 07*(02) 14* +	     db	25 dup(4),7 dup(02H),20	dup(4),9 dup(0CH),25 dup(4),8 dup(02H),22 dup(4),10 dup	    +
    880	      (04) 09*(0C) 19*(04)+  (0CH),27 dup(4),9 dup(02H),25 dup(4),11 dup(0CH),20 dup(4),10 dup(02H),23 dup(4)
    881	      08*(02) 16*(04) 0A* +
    882	      (0C) 1B*(04) 09*(02)+
    883	      19*(04) 0B*(0C) 14* +
    884	      (04) 0A*(02) 17*(04)
    885	898A  19*(04) 07*(02) 14* +	     db	25 dup(4),7 dup(02H),20	dup(4),9 dup(0CH),25 dup(4),8 dup(02H),22 dup(4),10 dup	    +
    886	      (04) 09*(0C) 19*(04)+  (0CH),27 dup(4),9 dup(02H),25 dup(4),11 dup(0CH),20 dup(4),10 dup(02H),23 dup(4)
    887	      08*(02) 16*(04) 0A* +
    888	      (0C) 1B*(04) 09*(02)+
    889	      19*(04) 0B*(0C) 14* +
    890	      (04) 0A*(02) 17*(04)
    891	8A85  19*(04) 07*(02) 14* +	     db	25 dup(4),7 dup(02H),20	dup(4),9 dup(0CH),25 dup(4),8 dup(02H),22 dup(4),10 dup	    +
    892	      (04) 09*(0C) 19*(04)+  (0CH),27 dup(4),9 dup(02H),25 dup(4),11 dup(0CH),20 dup(4),10 dup(02H),23 dup(4)
    893	      08*(02) 16*(04) 0A* +
    894	      (0C) 1B*(04) 09*(02)+
    895	      19*(04) 0B*(0C) 14* +
    896	      (04) 0A*(02) 17*(04)
    897	8B80  14*(04) 0A*(0C) 12* +	     db	20 dup(4),10 dup(0CH),18 dup(4),12 dup(02H),20 dup(4),11 dup(0CH),19 dup(4),13 dup  +
    898	      (04) 0C*(02) 14*(04)+  (02H),22 dup(4),12	dup(0CH),21 dup(4),14 dup(02H),18 dup(4),13 dup(0CH),19	dup(4)
    899	      0B*(0C) 13*(04) 0D* +
    900	      (02) 16*(04) 0C*(0C)+
    901	      15*(04) 0E*(02) 12* +
    902	      (04) 0D*(0C) 13*(04)
    903	8C72  14*(04) 0A*(0C) 12* +	     db	20 dup(4),10 dup(0CH),18 dup(4),12 dup(02H),20 dup(4),11 dup(0CH),19 dup(4),13 dup  +
    904	      (04) 0C*(02) 14*(04)+  (02H),22 dup(4),12	dup(0CH),21 dup(4),14 dup(02H),18 dup(4),13 dup(0CH),19	dup(4)
    905	      0B*(0C) 13*(04) 0D* +
    906	      (02) 16*(04) 0C*(0C)+
    907	      15*(04) 0E*(02) 12* +
    908	      (04) 0D*(0C) 13*(04)
    909	8D64  14*(04) 0A*(0C) 12* +	     db	20 dup(4),10 dup(0CH),18 dup(4),12 dup(02H),20 dup(4),11 dup(0CH),19 dup(4),13 dup  +
    910	      (04) 0C*(02) 14*(04)+  (02H),22 dup(4),12	dup(0CH),21 dup(4),14 dup(02H),18 dup(4),13 dup(0CH),19	dup(4)
    911	      0B*(0C) 13*(04) 0D* +
    912	      (02) 16*(04) 0C*(0C)+
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 17
MAIN.ASM



    913	      15*(04) 0E*(02) 12* +
    914	      (04) 0D*(0C) 13*(04)
    915	8E56  0F*(04) 0F*(02) 0D* +	     db	15 dup(4),15 dup(02H),13 dup(4),18 dup(0CH),15 dup(4),16 dup(02H),14 dup(4),19 dup  +
    916	      (04) 12*(0C) 0F*(04)+  (0CH),17 dup(4),17	dup(02H),16 dup(4),20 dup(0CH),13 dup(4),18 dup(02H),15	dup(4)
    917	      10*(02) 0E*(04) 13* +
    918	      (0C) 11*(04) 11*(02)+
    919	      10*(04) 14*(0C) 0D* +
    920	      (04) 12*(02) 0F*(04)
    921	8F47  0A*(04) 14*(0C) 08* +	     db	10 dup(4),20 dup(0CH),8	dup(4),25 dup(02H),10 dup(4),21	dup(0CH),9 dup(4),26 dup    +
    922	      (04) 19*(02) 0A*(04)+  (02H),12 dup(4),22	dup(0CH),11 dup(4),27 dup(02H),8 dup(4),23 dup(0CH),10 dup(4)
    923	      15*(0C) 09*(04) 1A* +
    924	      (02) 0C*(04) 16*(0C)+
    925	      0B*(04) 1B*(02) 08* +
    926	      (04) 17*(0C) 0A*(04)
    927	9039  0140*(0C)			     db	320 dup	(0CH)
    928	9179  0140*(02)			     db	320 dup	(02H)
    929	92B9  0140*(0C)			     db	320 dup	(0CH)
    930	93F9  0140*(02)			     db	320 dup	(02H)
    931	9539  0140*(0C)			     db	320 dup	(0CH)
    932	9679  0140*(02)			     db	320 dup	(02H)
    933	97B9  0140*(0C)			     db	320 dup	(0CH)
    934	98F9  0140*(02)			     db	320 dup	(02H)
    935	9A39  0140*(0C)			     db	320 dup	(0CH)
    936	9B79  0140*(02)			     db	320 dup	(02H)
    937	9CB9  0140*(0C)			     db	320 dup	(0CH)
    938	9DF9  0140*(02)			     db	320 dup	(02H)
    939	9F39  0140*(0C)			     db	320 dup	(0CH)
    940	A079  0140*(02)			     db	320 dup	(02H)
    941	A1B9  0140*(0C)			     db	320 dup	(0CH)
    942
    943
    944	A2F9  00 00 04 04 04 04	04+  base    db	0, 0, 4, 4, 4, 4, 4, 4,	4, 4, 4, 4, 4, 4, 0, 0,	7, 7, 7, 7, 7, 7, 7, 7,	7, 7, 7, 7, +
    945	      04 04 04 04 04 04	04+  7,	7, 7, 7	, 0, 0
    946	      00 00 07 07 07 07	07+
    947	      07 07 07 07 07 07	07+
    948	      07 07 07 07 00 00
    949	A31B  00 00 00 00 00 00	00+	     db	0, 0, 0, 0, 0, 0, 0, 0,	0, 0, 0, 0, 0, 0, 0, 0,	7, 7, 0BH, 0BH,	0BH, 0BH, 0BH, 0BH, +
    950	      00 00 00 00 00 00	00+  0BH, 0BH, 0BH, 0BH, 0BH, 0BH, 7, 7, 0, 0
    951	      00 00 07 07 0B 0B	0B+
    952	      0B 0B 0B 0B 0B 0B	0B+
    953	      0B 0B 07 07 00 00
    954	A33D  04 04 04 04 04 04	00+	     db	4, 4, 4, 4, 4, 4, 0, 0,	0, 0, 4, 4, 4, 4, 4, 4,	7, 7, 0BH, 0BH,	0BH, 0BH, 0BH, 0BH, +
    955	      00 00 00 04 04 04	04+  0BH, 0BH, 0BH, 0BH, 0BH, 0BH, 7, 7, 0, 0
    956	      04 04 07 07 0B 0B	0B+
    957	      0B 0B 0B 0B 0B 0B	0B+
    958	      0B 0B 07 07 00 00
    959	A35F  04 04 04 04 04 04	00+	     db	4, 4, 4, 4, 4, 4, 0, 0,	0, 0, 4, 4, 4, 4, 4, 4,	7, 7, 0BH, 0BH,	0BH, 0BH, 0BH, 0BH, +
    960	      00 00 00 04 04 04	04+  0BH, 0BH, 0BH, 0BH, 0BH, 0BH, 7, 7, 0, 0
    961	      04 04 07 07 0B 0B	0B+
    962	      0B 0B 0B 0B 0B 0B	0B+
    963	      0B 0B 07 07 00 00
    964	A381  04 04 04 04 04 04	00+	     db	4, 4, 4, 4, 4, 4, 0, 0,	0, 0, 4, 4, 4, 4, 4, 4,	7, 7, 0BH, 0BH,	0BH, 0BH, 0BH, 0BH, +
    965	      00 00 00 04 04 04	04+  0BH, 0BH, 0BH, 0BH, 0BH, 0BH, 7, 7, 0, 0
    966	      04 04 07 07 0B 0B	0B+
    967	      0B 0B 0B 0B 0B 0B	0B+
    968	      0B 0B 07 07 00 00
    969	A3A3  04 04 04 04 04 04	00+	     db	4, 4, 4, 4, 4, 4, 0, 0,	0, 0, 4, 4, 4, 4, 4, 4,	7, 7, 0BH, 0BH,	0BH, 0BH, 0BH, 0BH, +
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 18
MAIN.ASM



    970	      00 00 00 04 04 04	04+  0BH, 0BH, 0BH, 0BH, 0BH, 0BH, 7, 7, 0, 0
    971	      04 04 07 07 0B 0B	0B+
    972	      0B 0B 0B 0B 0B 0B	0B+
    973	      0B 0B 07 07 00 00
    974	A3C5  00 00 04 04 04 04	04+	     db	0, 0, 4, 4, 4, 4, 4, 4,	4, 4, 4, 4, 4, 4, 0, 0,	7, 7, 0BH, 0BH,	0BH, 0BH, 0BH, 0BH, +
    975	      04 04 04 04 04 04	04+  0BH, 0BH, 0BH, 0BH, 0BH, 0BH, 7, 7, 0, 0
    976	      00 00 07 07 0B 0B	0B+
    977	      0B 0B 0B 0B 0B 0B	0B+
    978	      0B 0B 07 07 00 00
    979	A3E7  00 00 00 00 00 00	00+	     db	0, 0, 0, 0, 0, 0, 0, 0,	0, 0, 0, 0, 0, 0, 0, 0,	7, 7, 7, 7, 7, 7, 7, 7,	7, 7, 7, 7, +
    980	      00 00 00 00 00 00	00+  7,	7, 7, 7, 0, 0
    981	      00 00 07 07 07 07	07+
    982	      07 07 07 07 07 07	07+
    983	      07 07 07 07 00 00
    984
    985
    986	A409  07 07 04 04 04 04	04+  topo    db	7, 7, 4, 4, 4, 4, 4, 4,	4, 4, 4, 4, 4, 4, 7, 7,	7, 7, 4, 4, 4, 4, 4, 4,	4, 4, 4, 4, +
    987	      04 04 04 04 04 04	04+  4,	4, 7, 7, 0, 0
    988	      07 07 07 07 04 04	04+
    989	      04 04 04 04 04 04	04+
    990	      04 04 07 07 00 00
    991	A42B  07 07 07 07 07 07	07+	     db	7, 7, 7, 7, 7, 7, 7, 7,	7, 7, 7, 7, 7, 7, 7, 7,	7, 7, 7, 7, 7, 7, 7, 7,	7, 7, 7, 7, +
    992	      07 07 07 07 07 07	07+  7,	7, 7, 7, 0, 0
    993	      07 07 07 07 07 07	07+
    994	      07 07 07 07 07 07	07+
    995	      07 07 07 07 00 00
    996	A44D  04 04 04 04 04 04	07+	     db	4, 4, 4, 4, 4, 4, 7, 7,	7, 7, 4, 4, 4, 4, 4, 4,	4, 4, 4, 4, 4, 4, 7, 7,	7, 7, 4, 4, +
    997	      07 07 07 04 04 04	04+  4,	4, 4, 4, 0, 0
    998	      04 04 04 04 04 04	04+
    999	      04 07 07 07 07 04	04+
   1000	      04 04 04 04 00 00
   1001	A46F  04 04 04 04 04 04	07+	     db	4, 4, 4, 4, 4, 4, 7, 7,	7, 7, 4, 4, 4, 4, 4, 4,	4, 4, 4, 4, 4, 4, 7, 7,	7, 7, 4, 4, +
   1002	      07 07 07 04 04 04	04+  4,	4, 4, 4, 0, 0
   1003	      04 04 04 04 04 04	04+
   1004	      04 07 07 07 07 04	04+
   1005	      04 04 04 04 00 00
   1006	A491  04 04 04 04 04 04	07+	     db	4, 4, 4, 4, 4, 4, 7, 7,	7, 7, 4, 4, 4, 4, 4, 4,	4, 4, 4, 4, 4, 4, 7, 7,	7, 7, 4, 4, +
   1007	      07 07 07 04 04 04	04+  4,	4, 4, 4, 0, 0
   1008	      04 04 04 04 04 04	04+
   1009	      04 07 07 07 07 04	04+
   1010	      04 04 04 04 00 00
   1011	A4B3  04 04 04 04 04 04	07+	     db	4, 4, 4, 4, 4, 4, 7, 7,	7, 7, 4, 4, 4, 4, 4, 4,	4, 4, 4, 4, 4, 4, 7, 7,	7, 7, 4, 4, +
   1012	      07 07 07 04 04 04	04+  4,	4, 4, 4, 0, 0
   1013	      04 04 04 04 04 04	04+
   1014	      04 07 07 07 07 04	04+
   1015	      04 04 04 04 00 00
   1016	A4D5  07 07 04 04 04 04	04+	     db	7, 7, 4, 4, 4, 4, 4, 4,	4, 4, 4, 4, 4, 4, 7, 7,	7, 7, 4, 4, 4, 4, 4, 4,	4, 4, 4, 4, +
   1017	      04 04 04 04 04 04	04+  4,	4, 7, 7, 0, 0
   1018	      07 07 07 07 04 04	04+
   1019	      04 04 04 04 04 04	04+
   1020	      04 04 07 07 00 00
   1021	A4F7  07 07 07 07 07 07	07+	     db	7, 7, 7, 7, 7, 7, 7, 7,	7, 7, 7, 7, 7, 7, 7, 7,	7, 7, 7, 7, 7, 7, 7, 7,	7, 7, 7, 7, +
   1022	      07 07 07 07 07 07	07+  7,	7, 7, 7, 0, 0
   1023	      07 07 07 07 07 07	07+
   1024	      07 07 07 07 07 07	07+
   1025	      07 07 07 07 00 00
   1026
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 19
MAIN.ASM



   1027					 ; Vetor de terrenos para cada fase (fase3 não	usa terreno fixo)
   1028	A519  0C22r 6B63r 0000		 terrain_vec dw	offset terrain_fase1, offset terrain_fase2, 0
   1029
   1030	A51F  0000			 terrain_pos dw	0  ; Offset de scroll horizontal (0-319)
   1031
   1032					 ; Estrutura para torres da fase 3 (geração procedural)
   1033	      =000C			 MAX_TOWERS EQU	12
   1034	A521  0C*(00)			 tower_heights db MAX_TOWERS dup(0)  ; Altura de cada torre (em	andares)
   1035	A52D  0C*(0000)			 tower_x_pos   dw MAX_TOWERS dup(0)  ; Posição X de cada torre
   1036	A545  0C*(00)			 tower_active  db MAX_TOWERS dup(0)  ; Torre ativa? (0=não, 1=sim)
   1037	A551  0140			 next_tower_x  dw 320		     ; Próxima	posição X para gerar torre
   1038	A553  0000			 tower_spawn_counter dw	0	     ; Contador	para spawnar novas torres
   1039	      =0022			 tower_min_spacing   EQU 34	     ; Espaçamento = 34 frames	(mesma largura das torres)
   1040
   1041					 ; Variáveis temporárias para	clipping de torre
   1042	A555  0000			 tower_sprite_offset dw	0	     ; Offset no sprite	(pixels	a pular)
   1043	A557  0022			 tower_render_width  dw	BASE_WIDTH   ; Largura a renderizar
   1044
   1045					 ; Dimensões dos andares
   1046	      =0022			 BASE_WIDTH  EQU 34  ; Largura de um andar (em pixels)
   1047	      =0008			 BASE_HEIGHT EQU 8   ; Altura de um andar (em pixels)
   1048
   1049
   1050	A559			     .code
   1051	0000			     MAIN:
   1052	0000  B8 0000s			 mov AX, @data
   1053	0003  8E D8			 mov DS, AX
   1054	0005  B8 A000			 mov AX, 0A000H
   1055	0008  8E C0			 mov ES, AX
   1056	000A  33 FF			 xor DI, DI
   1057
   1058	000C  E8 00B4			 call N_ALE
   1059	000F  E8 0144			 call INIT_ALIEN_RANDOM
   1060
   1061					 ; Define o modo de video
   1062	0012  32 E4			 xor ah, ah
   1063	0014  32 FF			 xor bh, bh
   1064	0016  B0 13			 mov al, 13h
   1065	0018  CD 10			 int 10h
   1066
   1067	001A			     LOOP_MENU:
   1068					 ; Exibe titulo	e botoes do menu
   1069	001A  E8 00CA			 call PRINT_TITLE_MENU
   1070	001D  E8 006C			 call PRINT_BUTTONS
   1071
   1072	0020  E8 0248			 call MOVE_MENU
   1073					 ; Recebe entrada do usu??rio
   1074	0023  B4 01			 mov ah, 1H
   1075	0025  CD 16			 int 16H
   1076	0027  74 F1			 jz LOOP_MENU
   1077
   1078					 ; Chama a fun????o de navega????o
   1079	0029  E8 026D			 call HANDLE_INPUT
   1080
   1081					 ; Condi????o para iniciar o jogo
   1082	002C  80 FC 1C			 cmp ah, 1CH
   1083	002F  74 06			 je SELECT_OPTION
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 20
MAIN.ASM



   1084
   1085					 ; Retorno ao loop do menu
   1086	0031  32 E4			 xor ah, ah
   1087	0033  CD 16			 int 16H
   1088	0035  EB E3			 jmp LOOP_MENU
   1089	0037			     SELECT_OPTION:
   1090	0037  32 E4			 xor ah, ah
   1091	0039  CD 16			 int 16H
   1092
   1093	003B  8A 26 0002r		 mov ah, menu
   1094	003F  80 FC 01			 cmp ah, 1
   1095	0042  74 44			 je FINISH
   1096
   1097	0044  E8 0522			 call RESET_GAME  ; Reseta score, vidas	e fase
   1098
   1099	0047  E8 0294			 call RENDER_FASE  ; Mostra a tela da fase
   1100
   1101					 ; Aguarda um pouco para ver a fase
   1102	004A  33 C9			 xor cx, cx
   1103	004C  BA FFFF			 mov dx, 0FFFFH
   1104	004F  B4 86			 mov ah, 86H
   1105	0051  CD 15			 int 15h
   1106
   1107					 ; Limpa completamente a tela antes de iniciar o jogo
   1108	0053  E8 0270			 call CLEAR_SCREEN
   1109
   1110	0056  E8 04EF			 call RESET_SHIP
   1111
   1112	0059				 GAME_LOOP:
   1113	0059  E8 0635			 call RENDER_TERRAIN  ;	Renderiza o terreno primeiro
   1114	005C  E8 03A5			 call RENDER_STATUS   ;	Renderiza score, vidas e tempo
   1115	005F  E8 03AC			 call UPDATE_TIME
   1116	0062  E8 042A			 call UPDATE_SHIP
   1117	0065  E8 057D			 call UPDATE_SHOT     ;	Atualiza os tiros
   1118	0068  E8 0A2B			 call UPDATE_ALIENS   ;	Atualiza aliens
   1119	006B  E8 0BD1			 call CHECK_ALIEN_SHOT_COLLISION   ; Colisão tiros vs aliens
   1120	006E  E8 0C9C			 call CHECK_ALIEN_SHIP_COLLISION   ; Colisão nave vs aliens
   1121
   1122					 ; Verifica condições	de fim de jogo
   1123	0071  E8 0941			 call CHECK_GAME_END
   1124	0074  3C 01			 cmp al, 1	      ;	Game Over?
   1125	0076  74 06			 je GAME_OVER_END
   1126	0078  3C 02			 cmp al, 2	      ;	Vitória?
   1127	007A  74 07			 je VICTORY_END
   1128
   1129	007C  EB DB			 jmp GAME_LOOP
   1130
   1131	007E			     GAME_OVER_END:
   1132	007E  E8 0879			 call SHOW_GAME_OVER
   1133	0081  EB 97			 jmp LOOP_MENU	      ;	Volta ao menu principal
   1134
   1135	0083			     VICTORY_END:
   1136	0083  E8 08B7			 call SHOW_VICTORY
   1137	0086  EB 92			 jmp LOOP_MENU	      ;	Volta ao menu principal
   1138
   1139	0088			     FINISH:
   1140	0088  E8 022E			 CALL END_GAME
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 21
MAIN.ASM



   1141
   1142	008B  C3			 ret
   1143
   1144				     ;===============================================================================
   1145				     ; PRINT_BUTTONS
   1146				     ;===============================================================================
   1147				     ; Função: Exibe os botões do menu (INICIAR e SAIR) com destaque	visual
   1148				     ; Parâmetros de entrada:
   1149				     ;	 - menu	(variável global): 0 =	destaca	INICIAR, 1 = destaca SAIR
   1150				     ; Parâmetros de saída: Nenhum
   1151				     ;===============================================================================
   1152	008C			     PRINT_BUTTONS proc
   1153	008C  50			 push ax
   1154	008D  B3 0F			 mov bl, 0FH
   1155	008F  8A 26 0002r		 mov ah, menu
   1156	0093  80 FC 00			 cmp ah, 0
   1157	0096  75 02			 jne START_BTN
   1158	0098  B3 0C			 mov bl, 0CH
   1159
   1160	009A			     START_BTN:
   1161					 ; Exibe o bot??o INICIAR
   1162	009A  BD 0004r			 mov bp, offset	btn_iniciar
   1163	009D  B9 0051			 mov cx, btn_iniciar_length ; tamanho
   1164	00A0  32 D2			 xor dl, dl ; coluna = 0
   1165	00A2  B6 12			 mov dh, 18 ; linha = 18
   1166	00A4  E8 002B			 call PRINT_STRING
   1167
   1168	00A7  B3 0F			 mov bl, 0FH
   1169	00A9  8A 26 0002r		 mov ah, menu
   1170	00AD  80 FC 01			 cmp ah, 1
   1171	00B0  75 02			 jne EXIT_BTN
   1172	00B2  B3 0C			 mov bl, 0CH
   1173
   1174	00B4			     EXIT_BTN:
   1175	00B4  BD 0055r			 mov bp, offset	btn_sair
   1176	00B7  B9 0051			 mov cx, btn_sair_length ; tamanho
   1177	00BA  32 D2			 xor dl, dl ; coluna = 0
   1178	00BC  B6 15			 mov dh, 21 ; linha = 21
   1179	00BE  E8 0011			 call PRINT_STRING
   1180
   1181	00C1  58			 pop ax
   1182	00C2  C3			 ret
   1183	00C3			     PRINT_BUTTONS endp
   1184
   1185				     ;===============================================================================
   1186				     ; N_ALE
   1187				     ;===============================================================================
   1188				     ; Função: Gera um valor aleatório baseado no clock do sistema
   1189				     ; Parâmetros de entrada: Nenhum
   1190				     ; Parâmetros de saída:
   1191				     ;	 - random_value	(variável global): valor aleatório de	16 bits
   1192				     ;===============================================================================
   1193	00C3			     N_ALE proc
   1194	00C3  50			 push ax
   1195	00C4  51			 push cx
   1196	00C5  52			 push dx
   1197
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 22
MAIN.ASM



   1198	00C6  33 C0			 xor ax, ax
   1199	00C8  CD 1A			 int 1AH
   1200	00CA  89 16 0000r		 mov ale, dx
   1201
   1202	00CE  5A			 pop dx
   1203	00CF  59			 pop cx
   1204	00D0  58			 pop ax
   1205	00D1  C3			 ret
   1206	00D2			     N_ALE endp
   1207
   1208				     ;	Desenha	CX caracteres a	partir de ES:BP	na posi??o (linha DH, coluna DL).
   1209				     ;	Usa a cor/atributo em BL (p.ex.: 0Fh = branco, 0Ch = vermelho-claro).
   1210				     ;	Atualiza o cursor ap?s imprimir	(modo AL=1).
   1211				     ;	ES deve	apontar	para o segmento	onde est? a string (comumente ES=DS).
   1212				     ;	BP deve	conter o offset	da string dentro de ES.
   1213	00D2			     PRINT_STRING PROC
   1214	00D2  50			 push AX
   1215	00D3  53			 push BX
   1216	00D4  1E			 push DS
   1217	00D5  06			 push ES
   1218	00D6  56			 push SI
   1219	00D7  55			 push BP
   1220
   1221	00D8  B4 13			 mov ah, 13h
   1222	00DA  B0 01			 mov al, 1
   1223
   1224	00DC  32 FF			 xor bh, bh
   1225	00DE  CD 10			 int 10h  ; escreve string
   1226
   1227	00E0  5D			 pop BP
   1228	00E1  5E			 pop SI
   1229	00E2  07			 pop ES
   1230	00E3  1F			 pop DS
   1231	00E4  5B			 pop BX
   1232	00E5  58			 pop AX
   1233	00E6  C3			 ret
   1234	00E7			     PRINT_STRING ENDP
   1235
   1236				     ;===============================================================================
   1237				     ; PRINT_TITLE_MENU
   1238				     ;===============================================================================
   1239				     ; Função: Renderiza o título do	menu principal na tela
   1240				     ; Parâmetros de entrada: Nenhum
   1241				     ; Parâmetros de saída: Nenhum
   1242				     ;===============================================================================
   1243	00E7			     PRINT_TITLE_MENU proc
   1244	00E7  8C D8			 mov ax, ds
   1245	00E9  8E C0			 mov es, ax
   1246
   1247					 ; ajusta resgitradores	pro PRINT_STRING
   1248	00EB  BD 00A6r			 mov bp, offset	string
   1249	00EE  B9 00C8			 mov cx, string_length ; tamanho
   1250	00F1  B3 02			 mov bl, 02H ; Cor verde (se bit 1 de AL estiver limpo,	usamos BL)
   1251	00F3  BA 03C0			 mov dx, 320*3 ; linha / coluna
   1252	00F6  E8 FFD9			 call PRINT_STRING
   1253
   1254	00F9  C3			 ret
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 23
MAIN.ASM



   1255	00FA			     PRINT_TITLE_MENU endp
   1256
   1257				     ;===============================================================================
   1258				     ; RENDER_SPRITE
   1259				     ;===============================================================================
   1260				     ; Função: Renderiza um sprite genérico na memória de vídeo
   1261				     ; Parâmetros de entrada:
   1262				     ;	 - AX: posição linear	na tela	(offset	em 0xA000)
   1263				     ;	 - SI: offset do sprite	na memória de dados
   1264				     ; Parâmetros de saída: Nenhum
   1265				     ;===============================================================================
   1266	00FA			     RENDER_SPRITE proc
   1267	00FA  53			 push bx
   1268	00FB  51			 push cx
   1269	00FC  52			 push dx
   1270	00FD  57			 push di
   1271	00FE  06			 push es
   1272	00FF  1E			 push ds
   1273	0100  50			 push ax
   1274
   1275	0101  B8 0000s			 mov ax, @data
   1276	0104  8E D8			 mov ds, ax
   1277
   1278	0106  B8 A000			 mov ax, 0A000h
   1279	0109  8E C0			 mov es, ax
   1280
   1281	010B  58			 pop ax
   1282	010C  8B F8			 mov di, ax
   1283	010E  BA 0014			 mov dx, SPR_H
   1284	0111  50			 push ax
   1285
   1286	0112			     DRAW_SHIP_LINE:
   1287	0112  B9 0018			 mov cx, SPR_W
   1288	0115  F3> A4			 rep movsb
   1289	0117  81 C7 0128		 add di, SCREEN_W - SPR_W
   1290	011B  4A			 dec dx
   1291	011C  75 F4			 jnz DRAW_SHIP_LINE
   1292
   1293	011E  58			 pop ax
   1294	011F  1F			 pop ds
   1295	0120  07			 pop es
   1296	0121  5F			 pop di
   1297	0122  5A			 pop dx
   1298	0123  59			 pop cx
   1299	0124  5B			 pop bx
   1300	0125  C3			 ret
   1301	0126			     RENDER_SPRITE endp
   1302
   1303				     ;===============================================================================
   1304				     ; RANDOM_UINT16
   1305				     ;===============================================================================
   1306				     ; Função: Gera número pseudo-aleatório	usando LCG (Linear Congruential	Generator)
   1307				     ; Parâmetros de entrada: Nenhum (usa random_value	global)
   1308				     ; Parâmetros de saída:
   1309				     ;	 - AX: número aleatório de 16	bits
   1310				     ;	 - random_value: atualizado com	novo valor
   1311				     ;===============================================================================
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 24
MAIN.ASM



   1312	0126			     RANDOM_UINT16 proc
   1313	0126  52			 push dx
   1314
   1315	0127  B8 6255			 mov ax, 25173
   1316	012A  F7 26 0000r		 mul ale
   1317	012E  05 3619			 add ax, 13849
   1318	0131  A3 0000r			 mov ale, ax
   1319
   1320	0134  5A			 pop dx
   1321	0135  C3			 ret
   1322	0136			     endp
   1323
   1324				     ;===============================================================================
   1325				     ; CLEAR_SPRITE
   1326				     ;===============================================================================
   1327				     ; Função: Limpa um sprite da tela (pinta	de preto)
   1328				     ; Parâmetros de entrada:
   1329				     ;	 - DI: posição linear	do canto superior esquerdo do sprite
   1330				     ; Parâmetros de saída: Nenhum
   1331				     ;===============================================================================
   1332	0136			     CLEAR_SPRITE proc
   1333	0136  50			 push ax
   1334	0137  51			 push cx
   1335	0138  57			 push di
   1336	0139  06			 push es
   1337
   1338	013A  B8 A000			 mov ax, 0A000h
   1339	013D  8E C0			 mov es, ax
   1340	013F  B9 0014			 mov cx, SPR_H
   1341
   1342	0142			     CLEAR_LINE:
   1343	0142  51			 push cx
   1344	0143  B9 0018			 mov cx, SPR_W
   1345	0146  32 C0			 xor al, al	     ; cor 0 (preto)
   1346	0148  F3> AA			 rep stosb
   1347	014A  81 C7 0128		 add di, SCREEN_W - SPR_W
   1348	014E  59			 pop cx
   1349	014F  E2 F1			 loop CLEAR_LINE
   1350
   1351	0151  07			 pop es
   1352	0152  5F			 pop di
   1353	0153  59			 pop cx
   1354	0154  58			 pop ax
   1355	0155  C3			 ret
   1356	0156			     CLEAR_SPRITE endp
   1357
   1358				     ;===============================================================================
   1359				     ; INIT_ALIEN_RANDOM
   1360				     ;===============================================================================
   1361				     ; Função: Inicializa alien em posição aleatória (usado no menu)
   1362				     ; Parâmetros de entrada: Nenhum
   1363				     ; Parâmetros de saída:
   1364				     ;	 - alien_pos: posição	inicial	do alien (Y=100, X aleatório 0-306)
   1365				     ;===============================================================================
   1366	0156			     INIT_ALIEN_RANDOM proc
   1367	0156  50			 push ax
   1368	0157  53			 push bx
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 25
MAIN.ASM



   1369	0158  51			 push cx
   1370	0159  52			 push dx
   1371
   1372					 ; x aleatório	em [0..306]
   1373	015A  E8 FFC9			 call RANDOM_UINT16	    ; AX = rand
   1374	015D  33 D2			 xor dx, dx
   1375	015F  BB 0133			 mov bx, 307		    ; divisor
   1376	0162  F7 F3			 div bx			    ; AX/307
   1377	0164  8B CA			 mov cx, dx		    ; CX = x (0..306)
   1378
   1379					 ; y*320 (y = 125)
   1380	0166  BB 007D			 mov bx, 125
   1381	0169  8B C3			 mov ax, bx
   1382	016B  D1 E3 D1 E3 D1 E3	D1+	 shl bx, 6		    ; y<<6
   1383	      E3 D1 E3 D1 E3
   1384	0177  D1 E0 D1 E0 D1 E0	D1+	 shl ax, 8		    ; y<<8
   1385	      E0 D1 E0 D1 E0 D1	E0+
   1386	      D1 E0
   1387	0187  03 D8			 add bx, ax		    ; bx = y*320
   1388
   1389					 ; alien_pos = y*320 + x
   1390	0189  03 D9			 add bx, cx
   1391	018B  89 1E 0545r		 mov alien_pos,	bx
   1392
   1393	018F  5A			 pop dx
   1394	0190  59			 pop cx
   1395	0191  5B			 pop bx
   1396	0192  58			 pop ax
   1397	0193  C3			 ret
   1398	0194			     INIT_ALIEN_RANDOM endp
   1399
   1400				     ;===============================================================================
   1401				     ; MOVE_WRAP_LEFT_AND_DRAW
   1402				     ;===============================================================================
   1403				     ; Função: Move sprite para esquerda com wraparound (reaparece à	direita)
   1404				     ; Parâmetros de entrada:
   1405				     ;	 - BX: ponteiro	para variável de posição (ex: OFFSET	meteor_pos)
   1406				     ;	 - SI: offset do sprite	(ex: OFFSET meteor_sprite)
   1407				     ;	 - AX: posição inicial para wraparound
   1408				     ;	 - DX: limite esquerdo (wrap quando x <	DX)
   1409				     ; Parâmetros de saída: Nenhum (atualiza posição na variável apontada por BX)
   1410				     ;===============================================================================
   1411	0194			     MOVE_WRAP_LEFT_AND_DRAW proc
   1412	0194  50			 push ax
   1413	0195  53			 push bx
   1414	0196  51			 push cx
   1415	0197  52			 push dx
   1416	0198  56			 push si
   1417	0199  57			 push di
   1418	019A  55			 push bp
   1419
   1420	019B  8B E8			 mov bp, ax		 ; BP =	posição inicial (para	wrap)
   1421	019D  8B FA			 mov di, dx		 ; DI =	limite esquerdo
   1422
   1423					 ; Verifica limites: x = pos % 320
   1424	019F  8B 07			 mov ax, [bx]
   1425	01A1  33 D2			 xor dx, dx
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 26
MAIN.ASM



   1426	01A3  B9 0140			 mov cx, 320
   1427	01A6  F7 F1			 div cx			 ; DX =	x (coordenada X)
   1428
   1429	01A8  3B D7			 cmp dx, di		 ; compara com limite esquerdo
   1430	01AA  77 09			 ja  MOVE_LEFT_MENU
   1431
   1432					 ; wrap	para a direita
   1433	01AC  8B 3F			 mov di, [bx]
   1434	01AE  E8 FF85			 call CLEAR_SPRITE
   1435
   1436	01B1  8B C5			 mov ax, bp		 ; AX =	posição inicial
   1437	01B3  89 07			 mov [bx], ax
   1438
   1439	01B5			     MOVE_LEFT_MENU:
   1440					 ; move	para a esquerda	usando MOVE_LEFT_PROC
   1441	01B5  53			 push bx		     ; salva BX	original
   1442	01B6  57			 push di		     ; salva DI	original
   1443
   1444	01B7  B9 0001			 mov cx, 1		     ; velocidade = 1 pixel
   1445	01BA  8B D7			 mov dx, di		     ; limite esquerdo
   1446	01BC  E8 0849			 call MOVE_LEFT_PROC
   1447
   1448	01BF  5F			 pop di			     ; restaura	DI
   1449	01C0  5B			 pop bx			     ; restaura	BX
   1450
   1451	01C1			     DRAW_SPRITE:
   1452					 ; Renderiza sprite na nova posição
   1453	01C1  8B 07			 mov ax, [bx]		 ; AX =	nova posição
   1454	01C3  E8 FF34			 call RENDER_SPRITE
   1455
   1456	01C6  5D			 pop bp
   1457	01C7  5F			 pop di
   1458	01C8  5E			 pop si
   1459	01C9  5A			 pop dx
   1460	01CA  59			 pop cx
   1461	01CB  5B			 pop bx
   1462	01CC  58			 pop ax
   1463	01CD  C3			 ret
   1464	01CE			     MOVE_WRAP_LEFT_AND_DRAW endp
   1465
   1466				     ;===============================================================================
   1467				     ; MOVE_BOUNCE_X_AND_DRAW
   1468				     ;===============================================================================
   1469				     ; Função: Move sprite horizontalmente com bounce	nas bordas (inverte direção)
   1470				     ; Parâmetros de entrada:
   1471				     ;	 - BX: ponteiro	para variável de posição
   1472				     ;	 - BP: ponteiro	para flag de direção (0=esquerda, 1=direita)
   1473				     ;	 - SI: offset do sprite
   1474				     ;	 - AX: limite esquerdo (coordenada X)
   1475				     ;	 - DX: limite direito (coordenada X)
   1476				     ; Parâmetros de saída: Nenhum (atualiza posição e direção nas variáveis)
   1477				     ;===============================================================================
   1478	01CE			     MOVE_BOUNCE_X_AND_DRAW proc
   1479	01CE  50			 push ax
   1480	01CF  53			 push bx
   1481	01D0  51			 push cx
   1482	01D1  52			 push dx
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 27
MAIN.ASM



   1483	01D2  56			 push si
   1484	01D3  57			 push di
   1485	01D4  55			 push bp
   1486
   1487	01D5  8B C8			 mov cx, ax		 ; CX =	limite esquerdo	(coordenada X)
   1488	01D7  8B FA			 mov di, dx		 ; DI =	limite direito (coordenada X)
   1489
   1490					 ; Verifica limites: x = pos % 320
   1491	01D9  8B 07			 mov ax, [bx]
   1492	01DB  33 D2			 xor dx, dx
   1493	01DD  BD 0140			 mov bp, 320
   1494	01E0  F7 F5			 div bp			 ; DX =	x atual	(coordenada X)
   1495
   1496					 ; Verifica bounce esquerdo
   1497	01E2  3B D1			 cmp dx, cx		 ; compara X atual com X limite	esquerdo
   1498	01E4  76 07			 jbe BOUNCE_LEFT
   1499
   1500					 ; Verifica bounce direito
   1501	01E6  3B D7			 cmp dx, di		 ; compara X atual com X limite	direito
   1502	01E8  73 08			 jae BOUNCE_RIGHT
   1503	01EA  EB 0B 90			 jmp MOVE_BOUNCE_MENU
   1504
   1505	01ED			     BOUNCE_LEFT:
   1506	01ED  B0 01			 mov al, 1		 ; direção = direita
   1507	01EF  EB 03 90			 jmp SET_DIRECTION
   1508
   1509	01F2			     BOUNCE_RIGHT:
   1510	01F2  32 C0			 xor al, al		 ; direção = esquerda
   1511
   1512	01F4			     SET_DIRECTION:
   1513	01F4  A2 0547r			 mov alien_dir,	al	 ; atualiza direção global
   1514
   1515	01F7			     MOVE_BOUNCE_MENU:
   1516					 ; configura parâmetros para movimento
   1517	01F7  53			 push bx		 ; salva BX original
   1518	01F8  57			 push di		 ; salva DI original
   1519	01F9  51			 push cx		 ; salva CX original
   1520
   1521	01FA  8A 16 0547r		 mov dl, alien_dir	 ; DL =	dir (0=esq, 1=dir)
   1522	01FE  80 FA 01			 cmp dl, 1
   1523	0201  74 0D			 jz  MOVE_RIGHT_BOUNCE
   1524
   1525					 ; move	para esquerda
   1526	0203  8B C1			 mov ax, cx		 ; AX =	limite esquerdo	em coordenada X
   1527	0205  B9 0001			 mov cx, 1		 ; velocidade =	1 pixel
   1528	0208  8B D0			 mov dx, ax		 ; limite esquerdo em coordenada X
   1529	020A  E8 07FB			 call MOVE_LEFT_PROC
   1530	020D  EB 09 90			 jmp RESTORE_BOUNCE
   1531
   1532	0210			     MOVE_RIGHT_BOUNCE:
   1533					 ; move	para direita
   1534	0210  B9 0001			 mov cx, 1		 ; velocidade =	1 pixel
   1535	0213  8B D7			 mov dx, di		 ; limite direito em coordenada	X
   1536	0215  E8 0819			 call MOVE_RIGHT_PROC
   1537
   1538	0218			     RESTORE_BOUNCE:
   1539	0218  59			 pop cx			 ; restaura CX
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 28
MAIN.ASM



   1540	0219  5F			 pop di			 ; restaura DI
   1541	021A  5B			 pop bx			 ; restaura BX
   1542
   1543					 ; Renderiza sprite na nova posição
   1544	021B  8B 07			 mov ax, [bx]		 ; AX =	nova posição
   1545	021D  E8 FEDA			 call RENDER_SPRITE
   1546
   1547	0220  5D			 pop bp
   1548	0221  5F			 pop di
   1549	0222  5E			 pop si
   1550	0223  5A			 pop dx
   1551	0224  59			 pop cx
   1552	0225  5B			 pop bx
   1553	0226  58			 pop ax
   1554	0227  C3			 ret
   1555	0228			     MOVE_BOUNCE_X_AND_DRAW endp
   1556
   1557				     ;===============================================================================
   1558				     ; MOVE_WRAP_RIGHT_AND_DRAW
   1559				     ;===============================================================================
   1560				     ; Função: Move sprite para direita com wraparound (reaparece à esquerda)
   1561				     ; Parâmetros de entrada:
   1562				     ;	 - BX: ponteiro	para variável de posição
   1563				     ;	 - SI: offset do sprite
   1564				     ;	 - AX: posição inicial para wraparound
   1565				     ;	 - DX: limite direito (wrap quando x > DX)
   1566				     ; Parâmetros de saída: Nenhum
   1567				     ;===============================================================================
   1568	0228			     MOVE_WRAP_RIGHT_AND_DRAW proc
   1569	0228  50			 push ax
   1570	0229  53			 push bx
   1571	022A  51			 push cx
   1572	022B  52			 push dx
   1573	022C  56			 push si
   1574	022D  57			 push di
   1575
   1576	022E  BE 074Dr			 mov si, offset	ship_pos
   1577	0231  8B 3C			 mov di, [si]
   1578	0233  8B C7			 mov ax, di
   1579	0235  33 D2			 xor dx, dx
   1580	0237  B9 0140			 mov cx, 320
   1581	023A  F7 F1			 div cx
   1582
   1583	023C  81 FA 0128		 cmp dx, 320 - SPR_W
   1584	0240  72 0D			 jb MOVE_RIGHT_MENU
   1585					 ; wrap	para a esquerda
   1586	0242  8B 3E 074Dr		 mov di, ship_pos
   1587	0246  E8 FEED			 call CLEAR_SPRITE
   1588	0249  C7 06 074Dr 5DC0		 mov ship_pos, ship_pos_ini
   1589
   1590	024F			     MOVE_RIGHT_MENU:
   1591	024F  BB 074Dr			 mov bx, OFFSET	ship_pos
   1592	0252  B9 0005			 mov cx, ship_speed
   1593	0255  BA 0128			 mov dx, 320 - SPR_W
   1594	0258  E8 07D6			 call MOVE_RIGHT_PROC
   1595
   1596	025B			     DRAW_RIGHT:
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 29
MAIN.ASM



   1597	025B  A1 074Dr			 mov ax, ship_pos
   1598	025E  BE 0548r			 mov si, offset	ship_sprite
   1599	0261  E8 FE96			 call RENDER_SPRITE
   1600
   1601	0264  5F			 pop di
   1602	0265  5E			 pop si
   1603	0266  5A			 pop dx
   1604	0267  59			 pop cx
   1605	0268  5B			 pop bx
   1606	0269  58			 pop ax
   1607	026A  C3			 ret
   1608	026B			     MOVE_WRAP_RIGHT_AND_DRAW endp
   1609
   1610				     ;===============================================================================
   1611				     ; MOVE_MENU
   1612				     ;===============================================================================
   1613				     ; Função: Anima sprites no menu principal
   1614				     ; Parâmetros de entrada: Nenhum
   1615				     ; Parâmetros de saída: Nenhum
   1616				     ;===============================================================================
   1617	026B			     MOVE_MENU PROC
   1618	026B  BB 074Br			 mov bx, OFFSET	meteor_pos
   1619	026E  BE 016Er			 mov si, OFFSET	meteor_sprite
   1620	0271  B8 7E2C			 mov ax, meteor_pos_ini
   1621	0274  BA 0004			 mov dx, 4
   1622	0277  E8 FF1A			 call MOVE_WRAP_LEFT_AND_DRAW
   1623
   1624	027A  BB 0545r			 mov bx, OFFSET	alien_pos
   1625	027D  BD 0547r			 mov bp, OFFSET	alien_dir
   1626	0280  BE 034Er			 mov si, OFFSET	alien_sprite
   1627	0283  B8 0004			 mov ax, 4
   1628	0286  BA 012A			 mov dx, 298
   1629	0289  E8 FF42			 call MOVE_BOUNCE_X_AND_DRAW
   1630
   1631	028C  E8 FF99			 call MOVE_WRAP_RIGHT_AND_DRAW
   1632
   1633					 ; Delay
   1634	028F  33 C9			 xor cx, cx
   1635	0291  BA 2710			 mov dx, 2710H
   1636	0294  B4 86			 mov ah, 86H
   1637	0296  CD 15			 int 15h
   1638	0298  C3			 ret
   1639	0299			     MOVE_MENU ENDP
   1640
   1641	0299			     HANDLE_INPUT PROC
   1642	0299  80 FC 48			 cmp ah, 48H
   1643	029C  74 08			 je ARROW_UP
   1644
   1645	029E  80 FC 50			 cmp ah, 50H
   1646	02A1  74 0C			 je ARROW_DOWN
   1647
   1648	02A3  EB 13 90			 jmp END_HANDLE
   1649
   1650	02A6			     ARROW_UP:
   1651	02A6  32 E4			 xor ah, ah
   1652	02A8  88 26 0002r		 mov menu, ah
   1653
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 30
MAIN.ASM



   1654	02AC  EB 07 90			 jmp RENDER_BUTTONS
   1655
   1656	02AF			     ARROW_DOWN:
   1657	02AF  B4 01			 mov ah, 1
   1658	02B1  88 26 0002r		 mov menu, ah
   1659
   1660	02B5			     RENDER_BUTTONS:
   1661	02B5  E8 FDD4			 call PRINT_BUTTONS
   1662
   1663	02B8			     END_HANDLE:
   1664	02B8  C3			 ret
   1665	02B9			     ENDP
   1666
   1667				     ;===============================================================================
   1668				     ; END_GAME
   1669				     ;===============================================================================
   1670				     ; Função: Encerra o jogo	e retorna ao modo texto
   1671				     ; Parâmetros de entrada: Nenhum
   1672				     ; Parâmetros de saída: Nenhum
   1673				     ;===============================================================================
   1674	02B9			     END_GAME proc
   1675					 ; Back	to text	mode
   1676	02B9  32 E4			 xor ah, ah
   1677	02BB  B0 03			 mov al, 3h
   1678	02BD  CD 10			 int 10h
   1679
   1680					 ; Ends	program
   1681	02BF  B4 4C			 mov ah, 4ch
   1682	02C1  32 C0			 xor al, al
   1683	02C3  CD 21			 int 21h
   1684	02C5  C3			 ret
   1685	02C6			     endp
   1686
   1687				     ;===============================================================================
   1688				     ; CLEAR_SCREEN
   1689				     ;===============================================================================
   1690				     ; Função: Limpa toda a tela (pinta de preto)
   1691				     ; Parâmetros de entrada: Nenhum
   1692				     ; Parâmetros de saída: Nenhum
   1693				     ;===============================================================================
   1694	02C6			     CLEAR_SCREEN proc
   1695	02C6  50			 push ax
   1696	02C7  51			 push cx
   1697	02C8  06			 push es
   1698	02C9  57			 push di
   1699
   1700	02CA  B8 A000			 mov ax,0A000h
   1701	02CD  8E C0			 mov es,ax
   1702	02CF  33 FF			 xor di, di
   1703	02D1  B9 7D00			 mov cx, 32000d
   1704	02D4  FC			 cld
   1705	02D5  33 C0			 xor ax, ax
   1706	02D7  F3> AB			 rep stosw
   1707
   1708	02D9  5F			 pop di
   1709	02DA  07			 pop es
   1710	02DB  59			 pop cx
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 31
MAIN.ASM



   1711	02DC  58			 pop ax
   1712	02DD  C3			 ret
   1713	02DE			     endp
   1714
   1715				     ;===============================================================================
   1716				     ; RENDER_FASE
   1717				     ;===============================================================================
   1718				     ; Função: Renderiza o nome da fase atual	na tela
   1719				     ; Parâmetros de entrada:
   1720				     ;	 - fase	(variável global): número da fase atual (1, 2	ou 3)
   1721				     ; Parâmetros de saída: Nenhum
   1722				     ;===============================================================================
   1723	02DE			     RENDER_FASE proc
   1724	02DE  50			 push ax
   1725	02DF  53			 push bx
   1726	02E0  51			 push cx
   1727	02E1  52			 push dx
   1728	02E2  55			 push bp
   1729
   1730	02E3  E8 FFE0			 call CLEAR_SCREEN
   1731
   1732					 ; Ajusta posição da nave baseado na fase
   1733	02E6  A0 0003r			 mov al, fase
   1734	02E9  3C 03			 cmp al, 3
   1735	02EB  75 09			 jne SHIP_POS_NORMAL_RENDER
   1736	02ED  C7 06 074Dr 3E80		 mov ship_pos, ROW_SHIP_FASE3*320
   1737	02F3  EB 07 90			 jmp SHIP_POS_SET_RENDER
   1738	02F6			     SHIP_POS_NORMAL_RENDER:
   1739	02F6  C7 06 074Dr 5DC0		 mov ship_pos, ship_pos_ini
   1740	02FC			     SHIP_POS_SET_RENDER:
   1741
   1742					 ; Print Sector
   1743	02FC  33 C0			 xor ax, ax
   1744	02FE  A0 0003r			 mov al, fase
   1745
   1746	0301  3C 04			 cmp al, 4
   1747	0303  75 00			 jne SUM_POINTS
   1748	0305			     SUM_POINTS:
   1749	0305  FE C8			 dec al	; number vector	index
   1750
   1751	0307  33 C0			 xor ax, ax
   1752	0309  A0 0003r			 mov al, fase
   1753	030C  FE C8			 dec al	; number vector	index
   1754	030E  D0 E0			 shl al, 1 ; multiply by 2 (since num_vec values are dw)
   1755	0310  BB 09CAr			 mov bx, offset	fase_vec ; get the vector
   1756	0313  03 D8			 add bx, ax ; add the index to the vector ptr
   1757	0315  8B 2F			 mov bp, [bx] ;	set BP to base address of number
   1758	0317  B9 00C6			 mov cx, fase_string_length
   1759	031A  32 D2			 xor dl, dl; line
   1760	031C  B6 0A			 mov dh, 10
   1761
   1762	031E  B3 0B			 mov bl, 0BH ; Cor verde (se bit 1 de AL estiver limpo,	usamos BL)
   1763	0320  E8 FDAF			 call PRINT_STRING
   1764
   1765	0323  33 C9			 xor cx, cx
   1766	0325  B9 001E			 mov cx, 1Eh
   1767	0328  BA 2710			 mov dx, 2710H
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 32
MAIN.ASM



   1768	032B  B4 86			 mov ah, 86H
   1769	032D  CD 15			 int 15h
   1770
   1771	032F  E8 FF94			 call CLEAR_SCREEN
   1772
   1773	0332  5D			 pop bp
   1774	0333  5A			 pop dx
   1775	0334  59			 pop cx
   1776	0335  5B			 pop bx
   1777	0336  58			 pop ax
   1778	0337  C3			 ret
   1779	0338			     endp
   1780
   1781				     ;===============================================================================
   1782				     ; RENDER_TIME
   1783				     ;===============================================================================
   1784				     ; Função: Renderiza o contador de tempo na HUD
   1785				     ; Parâmetros de entrada:
   1786				     ;	 - time	(variável global): tempo restante em segundos
   1787				     ; Parâmetros de saída: Nenhum
   1788				     ;===============================================================================
   1789	0338			     RENDER_TIME proc
   1790	0338  55			 push bp
   1791	0339  53			 push bx
   1792	033A  51			 push cx
   1793	033B  52			 push dx
   1794
   1795	033C  BD 0C0Fr			 mov bp, offset	time_str
   1796	033F  B9 0006			 mov cx, time_str_len
   1797	0342  B3 0F			 mov bl, 0FH ; white
   1798	0344  32 F6			 xor dh, dh
   1799	0346  B2 1E			 mov dl, 30
   1800	0348  E8 FD87			 call PRINT_STRING
   1801
   1802	034B  33 C0			 xor ax, ax
   1803	034D  A0 0C0Br			 mov al, time
   1804	0350  BE 0C0Dr			 mov si, offset	time_buffer
   1805	0353  83 C6 01			 add si, time_buffer_len - 1
   1806	0356  B9 0002			 mov cx, 2
   1807	0359  E8 0014			 call CONVERT_UINT16
   1808
   1809	035C  BD 0C0Dr			 mov bp, offset	time_buffer
   1810	035F  B9 0002			 mov cx, time_buffer_len
   1811	0362  B3 02			 mov bl, 02H ; green
   1812	0364  32 F6			 xor dh, dh
   1813	0366  B2 24			 mov dl, 36
   1814	0368  E8 FD67			 call PRINT_STRING
   1815
   1816	036B  5A			 pop dx
   1817	036C  59			 pop cx
   1818	036D  5B			 pop bx
   1819	036E  5D			 pop bp
   1820
   1821	036F  C3			 ret
   1822	0370			     endp
   1823
   1824
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 33
MAIN.ASM



   1825				     ; AX = uint16 value to output
   1826				     ; SI = offset of end off string buffer
   1827				     ; CX = number of digits to	write
   1828	0370			     CONVERT_UINT16 proc
   1829	0370  56			 push si
   1830	0371  50			 push ax
   1831	0372  53			 push bx
   1832	0373  51			 push cx
   1833	0374  52			 push dx
   1834
   1835	0375  BB 000A			 mov bx, 10
   1836
   1837	0378			     LOOP_DIV:
   1838	0378  33 D2			 xor dx, dx
   1839	037A  F7 F3			 div bx
   1840
   1841	037C  80 C2 30			 add dl, '0'
   1842	037F  88 14			 mov byte ptr ds:[si], dl
   1843	0381  4E			 dec si
   1844
   1845	0382  49			 dec cx
   1846	0383  75 F3			 jnz LOOP_DIV
   1847
   1848	0385  5A			 pop dx
   1849	0386  59			 pop cx
   1850	0387  5B			 pop bx
   1851	0388  58			 pop ax
   1852	0389  5E			 pop si
   1853	038A  C3			 ret
   1854	038B			     endp
   1855
   1856				     ;===============================================================================
   1857				     ; RENDER_SCORE
   1858				     ;===============================================================================
   1859				     ; Função: Renderiza a pontuação do jogador na HUD
   1860				     ; Parâmetros de entrada:
   1861				     ;	 - score (variável global): pontuação atual
   1862				     ; Parâmetros de saída: Nenhum
   1863				     ;===============================================================================
   1864	038B			     RENDER_SCORE proc
   1865	038B  56			 push si
   1866	038C  55			 push bp
   1867	038D  50			 push ax
   1868	038E  53			 push bx
   1869	038F  51			 push cx
   1870	0390  52			 push dx
   1871
   1872	0391  BD 0C1Cr			 mov bp, offset	score_str
   1873	0394  B9 0006			 mov cx, score_str_len
   1874	0397  B3 0F			 mov bl, 0FH ; branco
   1875	0399  33 D2			 xor dx, dx  ; linha 0,	coluna 0
   1876	039B  E8 FD34			 call PRINT_STRING
   1877
   1878	039E  A1 0C15r			 mov ax, score
   1879	03A1  BE 0C17r			 mov si, offset	score_buffer
   1880	03A4  83 C6 04			 add si, score_buffer_len - 1
   1881	03A7  B9 0005			 mov cx, score_buffer_len
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 34
MAIN.ASM



   1882	03AA  E8 FFC3			 call CONVERT_UINT16
   1883
   1884	03AD  BD 0C17r			 mov bp, offset	score_buffer
   1885	03B0  B9 0005			 mov cx, score_buffer_len
   1886	03B3  B3 0A			 mov bl, 0AH ; verde claro
   1887	03B5  32 F6			 xor dh, dh
   1888	03B7  B2 07			 mov dl, 7   ; coluna 7	(após "SCORE:")
   1889	03B9  E8 FD16			 call PRINT_STRING
   1890
   1891	03BC  5A			 pop dx
   1892	03BD  59			 pop cx
   1893	03BE  5B			 pop bx
   1894	03BF  58			 pop ax
   1895	03C0  5D			 pop bp
   1896	03C1  5E			 pop si
   1897	03C2  C3			 ret
   1898	03C3			     RENDER_SCORE endp
   1899
   1900				     ;===============================================================================
   1901				     ; RENDER_LIVES
   1902				     ;===============================================================================
   1903				     ; Função: Renderiza o número de	vidas restantes	na HUD
   1904				     ; Parâmetros de entrada:
   1905				     ;	 - lives (variável global): número de	vidas restantes
   1906				     ; Parâmetros de saída: Nenhum
   1907				     ;===============================================================================
   1908	03C3			     RENDER_LIVES proc
   1909	03C3  50			 push ax
   1910	03C4  53			 push bx
   1911	03C5  51			 push cx
   1912	03C6  56			 push si
   1913	03C7  57			 push di
   1914
   1915					 ; Primeiro limpa todas	as posições possíveis de vidas (3 posições)
   1916	03C8  B9 0003			 mov cx, LIFES_START	     ; Limpa todas as 3	posições
   1917	03CB  B8 06BB			 mov ax, 5 * SCREEN_W +	123  ; Posição inicial
   1918
   1919	03CE			     CLEAR_LIVES_LOOP:
   1920	03CE  51			 push cx
   1921	03CF  50			 push ax
   1922	03D0  8B F8			 mov di, ax
   1923	03D2  E8 FD61			 call CLEAR_SPRITE	     ; Limpa cada sprite de vida
   1924	03D5  58			 pop ax
   1925	03D6  05 0019			 add ax, 25		     ; Próxima	posição
   1926	03D9  59			 pop cx
   1927	03DA  E2 F2			 loop CLEAR_LIVES_LOOP
   1928
   1929					 ; Agora renderiza apenas as vidas restantes
   1930	03DC  33 C9			 xor cx, cx
   1931	03DE  8A 0E 0777r		 mov cl, lives
   1932	03E2  80 F9 00			 cmp cl, 0
   1933	03E5  74 17			 je END_RENDER_LIVES
   1934
   1935					 ; Posição inicial: linha 5, centralizado
   1936					 ; Centro da tela = 160, cada vida ocupa 19 pixels + 6 de espaço = 25
   1937					 ; Para	3 vidas: 3*25 =	75 pixels, começa em 160-37 = 123
   1938	03E7  B8 06BB			 mov ax, 5 * SCREEN_W +	123  ; linha 5,	coluna 123 (centralizado)
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 35
MAIN.ASM



   1939	03EA  BE 0548r			 mov si, offset	ship_sprite
   1940
   1941	03ED			     RENDER_SINGLE_LIFE:
   1942	03ED  51			 push cx
   1943	03EE  50			 push ax
   1944	03EF  56			 push si
   1945	03F0  BE 0548r			 mov si, offset	ship_sprite  ; Resetar SI para o início do sprite
   1946	03F3  E8 FD04			 call RENDER_SPRITE
   1947	03F6  5E			 pop si
   1948	03F7  58			 pop ax
   1949	03F8  05 0019			 add ax, 25  ; próxima	vida (19 pixels	+ 6 de espaço)
   1950	03FB  59			 pop cx
   1951	03FC  E2 EF			 loop RENDER_SINGLE_LIFE
   1952
   1953	03FE			     END_RENDER_LIVES:
   1954	03FE  5F			 pop di
   1955	03FF  5E			 pop si
   1956	0400  59			 pop cx
   1957	0401  5B			 pop bx
   1958	0402  58			 pop ax
   1959	0403  C3			 ret
   1960	0404			     RENDER_LIVES endp
   1961
   1962				     ;===============================================================================
   1963				     ; RENDER_STATUS
   1964				     ;===============================================================================
   1965				     ; Função: Renderiza toda	a barra	de status (score, vidas	e tempo)
   1966				     ; Parâmetros de entrada: Nenhum
   1967				     ; Parâmetros de saída: Nenhum
   1968				     ;===============================================================================
   1969	0404			     RENDER_STATUS proc
   1970	0404  E8 FF84			 call RENDER_SCORE
   1971	0407  E8 FFB9			 call RENDER_LIVES
   1972	040A  E8 FF2B			 call RENDER_TIME
   1973	040D  C3			 ret
   1974	040E			     RENDER_STATUS endp
   1975
   1976				     ;===============================================================================
   1977				     ; UPDATE_TIME
   1978				     ;===============================================================================
   1979				     ; Função: Atualiza o contador de	tempo e	gerencia transições de fase
   1980				     ; Parâmetros de entrada: Nenhum
   1981				     ; Parâmetros de saída: Nenhum
   1982				     ;===============================================================================
   1983	040E			     UPDATE_TIME proc
   1984	040E  50			 push ax
   1985	040F  53			 push bx
   1986
   1987	0410  8A 26 0C0Cr		 mov ah, timeout
   1988	0414  FE C4			 inc ah
   1989	0416  80 FC 64			 cmp ah, 100
   1990	0419  75 6D			 jne SAVE_TIMEOUT
   1991
   1992	041B  8A 26 0C0Br		 mov ah, time
   1993	041F  FE CC			 dec ah
   1994	0421  75 37			 jnz SAVE_TIME
   1995
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 36
MAIN.ASM



   1996	0423  8A 26 0003r		 mov ah, fase
   1997	0427  FE C4			 inc ah
   1998	0429  88 26 0003r		 mov fase, ah		   ; Atualiza a	fase primeiro
   1999
   2000	042D  80 FC 04			 cmp ah, 4		   ; Verifica se passou	da fase	3
   2001	0430  73 25			 jae FINISH_GAME	  ; Se sim, marca como completado
   2002
   2003					 ; Reseta o tempo para a nova fase
   2004	0432  C6 06 0C0Br 3C		 mov time, SECONDS_START
   2005
   2006					 ; Reseta aliens ao mudar de fase
   2007	0437  E8 0620			 call RESET_ALIENS
   2008
   2009					 ; Ajusta posição do terreno baseado na fase
   2010	043A  80 FC 03			 cmp ah, 3
   2011	043D  75 0C			 jne TERRAIN_POS_NORMAL_ADVANCE
   2012					 ; Fase	3: terreno mais	baixo (linha 110) e inicializa torres
   2013	043F  C7 06 A51Fr 0000		 mov terrain_pos, 0
   2014	0445  E8 02D6			 call INIT_FASE3_TOWERS
   2015	0448  EB 07 90			 jmp TERRAIN_POS_SET_ADVANCE
   2016	044B			     TERRAIN_POS_NORMAL_ADVANCE:
   2017					 ; Fases 1 e 2:	terreno	normal (linha 150)
   2018	044B  C7 06 A51Fr 0000		 mov terrain_pos, 0
   2019	0451			     TERRAIN_POS_SET_ADVANCE:
   2020
   2021	0451  E8 FE8A			 call RENDER_FASE
   2022
   2023	0454  EB 36 90			 jmp END_TIME
   2024
   2025	0457			     FINISH_GAME:
   2026					 ; Player completou todas as fases - fase agora	é 4
   2027					 ; A verificação de vitória será feita no CHECK_GAME_END
   2028	0457  EB 33 90			 jmp END_TIME
   2029
   2030	045A			     SAVE_TIME:
   2031	045A  88 26 0C0Br		 mov time, ah
   2032
   2033					 ; Adiciona pontos por segundo baseado na fase
   2034	045E  8A 1E 0003r		 mov bl, fase
   2035	0462  80 FB 01			 cmp bl, 1
   2036	0465  75 08			 jne CHECK_FASE2
   2037	0467  83 06 0C15r 0A		 add score, 10	; Fase 1: +10 pontos/segundo
   2038	046C  EB 1A 90			 jmp SAVE_TIMEOUT
   2039
   2040	046F			     CHECK_FASE2:
   2041	046F  80 FB 02			 cmp bl, 2
   2042	0472  75 08			 jne CHECK_FASE3
   2043	0474  83 06 0C15r 0F		 add score, 15	; Fase 2: +15 pontos/segundo
   2044	0479  EB 0D 90			 jmp SAVE_TIMEOUT
   2045
   2046	047C			     CHECK_FASE3:
   2047	047C  80 FB 03			 cmp bl, 3
   2048	047F  75 07			 jne SAVE_TIMEOUT
   2049	0481  83 06 0C15r 14		 add score, 20	; Fase 3: +20 pontos/segundo
   2050
   2051	0486  32 E4			 xor ah, ah
   2052
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 37
MAIN.ASM



   2053	0488			     SAVE_TIMEOUT:
   2054	0488  88 26 0C0Cr		 mov timeout, ah
   2055
   2056	048C			     END_TIME:
   2057	048C  5B			 pop bx
   2058	048D  58			 pop ax
   2059	048E  C3			 ret
   2060	048F			     endp
   2061
   2062
   2063
   2064				     ;===============================================================================
   2065				     ; UPDATE_SHIP
   2066				     ;===============================================================================
   2067				     ; Função: Atualiza e renderiza a	nave do	jogador
   2068				     ; Parâmetros de entrada:
   2069				     ;	 - ship_pos (variável global):	posição da nave
   2070				     ; Parâmetros de saída: Nenhum
   2071				     ;===============================================================================
   2072	048F			     UPDATE_SHIP proc
   2073	048F  56			 push si
   2074	0490  57			 push di
   2075	0491  50			 push ax
   2076	0492  53			 push bx
   2077
   2078	0493  B4 01			 mov ah, 1H
   2079	0495  CD 16			 int 16H
   2080	0497  74 07			 jz END_SHIP_UPDATE
   2081
   2082	0499  E8 000F			 call HANDLE_CONTROLS
   2083	049C  32 E4			 xor ah, ah
   2084	049E  CD 16			 int 16H
   2085
   2086	04A0			     END_SHIP_UPDATE:
   2087	04A0  5B			 pop bx
   2088	04A1  58			 pop ax
   2089	04A2  5F			 pop di
   2090	04A3  5E			 pop si
   2091	04A4  E8 008F			 call RENDER_SHIP
   2092	04A7  E8 074D			 call RENDER_ALIENS
   2093	04AA  C3			 ret
   2094	04AB			     endp
   2095
   2096
   2097				     ;===============================================================================
   2098				     ; HANDLE_CONTROLS
   2099				     ;===============================================================================
   2100				     ; Função: Gerencia os controles do jogador (movimentação e disparo)
   2101				     ; Parâmetros de entrada:
   2102				     ;	 - Teclado: W/S	(cima/baixo), A/D (esquerda/direita), SPACE (atirar)
   2103				     ; Parâmetros de saída: Nenhum
   2104				     ;===============================================================================
   2105	04AB			     HANDLE_CONTROLS proc
   2106	04AB  56			 push si
   2107	04AC  57			 push di
   2108	04AD  50			 push ax
   2109	04AE  53			 push bx
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 38
MAIN.ASM



   2110	04AF  51			 push cx
   2111
   2112	04B0  BE 074Dr			 mov si, offset	ship_pos
   2113	04B3  8B 3C			 mov di, [si]
   2114
   2115	04B5  80 FC 48			 cmp ah, 48H
   2116	04B8  74 25			 je MOVE_UP
   2117
   2118	04BA  80 FC 50			 cmp ah, 50H
   2119	04BD  74 26			 je MOVE_DOWN
   2120
   2121	04BF  80 FC 4B			 cmp ah, 4BH
   2122	04C2  74 27			 je MOVE_LEFT
   2123
   2124	04C4  80 FC 4D			 cmp ah, 4DH
   2125	04C7  74 31			 je MOVE_RIGHT
   2126
   2127	04C9  80 FC 39			 cmp ah, 39H
   2128	04CC  74 0B			 je FIRE
   2129
   2130	04CE  3C 71			 cmp al, 'q'
   2131	04D0  75 37			 jne END_CONTROLS
   2132
   2133	04D2  33 C0			 xor ax, ax
   2134	04D4  CD 16			 int 16h
   2135	04D6  E8 FDE0			 call END_GAME
   2136
   2137	04D9			     FIRE:
   2138	04D9  E8 00C9			 call SHOOT
   2139	04DC  EB 2B 90			 jmp END_CONTROLS
   2140
   2141	04DF			     MOVE_UP:
   2142	04DF  E8 04F0			 call MOVE_UP_PROC
   2143	04E2  EB 25 90			 jmp END_CONTROLS
   2144	04E5			     MOVE_DOWN:
   2145	04E5  E8 0505			 call MOVE_DOWN_PROC
   2146	04E8  EB 1F 90			 jmp END_CONTROLS
   2147	04EB			     MOVE_LEFT:
   2148	04EB  BB 074Dr			 mov bx, OFFSET	ship_pos     ; ponteiro	para posição da nave
   2149	04EE  B9 0005			 mov cx, ship_speed	     ; velocidade da nave
   2150	04F1  BA 0004			 mov dx, 4		     ; limite esquerdo
   2151	04F4  E8 0511			 call MOVE_LEFT_PROC
   2152	04F7  EB 10 90			 jmp END_CONTROLS
   2153
   2154	04FA			     MOVE_RIGHT:
   2155	04FA  BB 074Dr			 mov bx, OFFSET	ship_pos     ; ponteiro	para posição da nave
   2156	04FD  B9 0005			 mov cx, ship_speed	     ; velocidade da nave
   2157	0500  BA 0128			 mov dx, 320 - SPR_W	     ; limite direito
   2158	0503  E8 052B			 call MOVE_RIGHT_PROC
   2159	0506  EB 01 90			 jmp END_CONTROLS
   2160
   2161	0509			     END_CONTROLS:
   2162	0509  59			 pop cx
   2163	050A  5B			 pop bx
   2164	050B  58			 pop ax
   2165	050C  5F			 pop di
   2166	050D  5E			 pop si
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 39
MAIN.ASM



   2167	050E  C3			 ret
   2168	050F			     endp
   2169
   2170				     ; AL = axis (0 is X, 1 is Y)
   2171				     ;===============================================================================
   2172				     ; MOVE_SPRITE
   2173				     ;===============================================================================
   2174				     ; Função: Move um sprite	na tela
   2175				     ; Parâmetros de entrada:
   2176				     ;	 - AH: direção (0=positiva, 1=negativa)
   2177				     ;	 - SI: ponteiro	para variável de posição
   2178				     ;	 - BX: incremento de movimento
   2179				     ; Parâmetros de saída: Nenhum
   2180				     ;===============================================================================
   2181	050F			     MOVE_SPRITE proc
   2182	050F  56			 push si
   2183	0510  50			 push ax
   2184	0511  53			 push bx
   2185
   2186	0512  8B 0C			 mov cx, [si]
   2187	0514  3C 00			 cmp al, 0
   2188	0516  75 03			 jne MOVE_Y_AXIS
   2189	0518  EB 0A 90			 jmp CHECK_DIRECTION
   2190
   2191	051B			     MOVE_Y_AXIS:
   2192	051B  50			 push ax
   2193	051C  B8 0140			 mov ax, 320
   2194	051F  F7 E3			 mul bx
   2195	0521  8B D8			 mov bx, ax
   2196	0523  58			 pop ax
   2197
   2198	0524			     CHECK_DIRECTION:
   2199	0524  80 FC 00			 cmp ah, 0
   2200	0527  75 05			 jne MOVE_NEGATIVE
   2201	0529  03 CB			 add cx, bx
   2202	052B  EB 03 90			 jmp SAVE_POS
   2203
   2204	052E			     MOVE_NEGATIVE:
   2205	052E  2B CB			 sub cx, bx
   2206
   2207	0530			     SAVE_POS:
   2208	0530  89 0C			 mov [si], cx
   2209
   2210	0532  5B			 pop bx
   2211	0533  58			 pop ax
   2212	0534  5E			 pop si
   2213	0535  C3			 ret
   2214	0536			     endp
   2215
   2216				     ;===============================================================================
   2217				     ; RENDER_SHIP
   2218				     ;===============================================================================
   2219				     ; Função: Renderiza a nave do jogador na	tela
   2220				     ; Parâmetros de entrada:
   2221				     ;	 - ship_pos (variável global):	posição da nave
   2222				     ; Parâmetros de saída: Nenhum
   2223				     ;===============================================================================
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 40
MAIN.ASM



   2224	0536			     RENDER_SHIP proc
   2225	0536  56			 push si
   2226	0537  57			 push di
   2227	0538  53			 push bx
   2228	0539  50			 push ax
   2229
   2230	053A  A1 074Dr			 mov ax, ship_pos
   2231	053D  BE 0548r			 mov si, offset	ship_sprite
   2232	0540  E8 FBB7			 call RENDER_SPRITE
   2233
   2234	0543  58			 pop ax
   2235	0544  5B			 pop bx
   2236	0545  5F			 pop di
   2237	0546  5E			 pop si
   2238	0547  C3			 ret
   2239	0548			     endp
   2240
   2241				     ;===============================================================================
   2242				     ; RESET_SHIP
   2243				     ;===============================================================================
   2244				     ; Função: Reseta	a posição da nave para a inicial
   2245				     ; Parâmetros de entrada: Nenhum
   2246				     ; Parâmetros de saída:
   2247				     ;	 - ship_pos: definida para posição inicial
   2248				     ;===============================================================================
   2249	0548			     RESET_SHIP	proc
   2250	0548  56			 push si
   2251	0549  53			 push bx
   2252
   2253	054A  C7 06 074Dr 5DC0		 mov ship_pos, ship_pos_ini ; Ship stating position
   2254
   2255	0550  5B			 pop bx
   2256	0551  5E			 pop si
   2257	0552  C3			 ret
   2258	0553			     endp
   2259
   2260				     ;===============================================================================
   2261				     ; RENDER_ALIEN
   2262				     ;===============================================================================
   2263				     ; Função: Renderiza um alien individual na tela
   2264				     ; Parâmetros de entrada:
   2265				     ;	 - AX: posição linear	na tela
   2266				     ; Parâmetros de saída: Nenhum
   2267				     ;===============================================================================
   2268	0553			     RENDER_ALIEN proc
   2269					 ; AX =	posição na tela
   2270	0553  57			 push di
   2271	0554  53			 push bx
   2272
   2273	0555  BE 034Er			 mov si, offset	alien_sprite
   2274	0558  E8 FB9F			 call RENDER_SPRITE
   2275
   2276	055B  5B			 pop bx
   2277	055C  5F			 pop di
   2278	055D  C3			 ret
   2279	055E			     endp
   2280
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 41
MAIN.ASM



   2281				     ;===============================================================================
   2282				     ; RENDER_METEOR
   2283				     ;===============================================================================
   2284				     ; Função: Renderiza um meteoro individual na tela (fase 2)
   2285				     ; Parâmetros de entrada:
   2286				     ;	 - AX: posição linear	na tela
   2287				     ; Parâmetros de saída: Nenhum
   2288				     ;===============================================================================
   2289	055E			     RENDER_METEOR proc
   2290					 ; AX =	posição na tela
   2291	055E  57			 push di
   2292	055F  53			 push bx
   2293
   2294	0560  BE 016Er			 mov si, offset	meteor_sprite
   2295	0563  E8 FB94			 call RENDER_SPRITE
   2296
   2297	0566  5B			 pop bx
   2298	0567  5F			 pop di
   2299	0568  C3			 ret
   2300	0569			     endp
   2301
   2302				     ;===============================================================================
   2303				     ; RESET_GAME
   2304				     ;===============================================================================
   2305				     ; Função: Reseta	todas as variáveis do jogo para o estado inicial
   2306				     ; Parâmetros de entrada: Nenhum
   2307				     ; Parâmetros de saída:
   2308				     ;	 - score = 0, lives = 3, fase =	1, time	= 10
   2309				     ;	 - Reseta nave,	tiros, aliens e	torres
   2310				     ;===============================================================================
   2311	0569			     RESET_GAME	proc
   2312	0569  50			 push ax
   2313	056A  51			 push cx
   2314	056B  56			 push si
   2315
   2316	056C  C7 06 0C15r 0000		 mov score, 0
   2317	0572  C6 06 0777r 03		 mov lives, LIFES_START
   2318	0577  C6 06 0003r 01		 mov fase, 1
   2319	057C  C6 06 0C0Br 3C		 mov time, SECONDS_START
   2320	0581  C6 06 0C0Cr 00		 mov timeout, 0
   2321	0586  C7 06 A51Fr 0000		 mov terrain_pos, 0
   2322
   2323					 ; Reset all shots
   2324	058C  C6 06 0756r 00		 mov byte ptr [shot_active], 0
   2325	0591  C6 06 0757r 00		 mov byte ptr [shot_active + 1], 0
   2326	0596  C6 06 0758r 00		 mov byte ptr [shot_active + 2], 0
   2327
   2328					 ; Reset aliens
   2329	059B  E8 04BC			 call RESET_ALIENS
   2330
   2331					 ; Reset fase 3	towers
   2332	059E  E8 017D			 call INIT_FASE3_TOWERS
   2333
   2334	05A1  5E			 pop si
   2335	05A2  59			 pop cx
   2336	05A3  58			 pop ax
   2337	05A4  C3			 ret
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 42
MAIN.ASM



   2338	05A5			     endp
   2339
   2340				     ;===============================================================================
   2341				     ; SHOOT
   2342				     ;===============================================================================
   2343				     ; Função: Dispara um tiro a partir da nave do jogador
   2344				     ; Parâmetros de entrada:
   2345				     ;	 - ship_pos (variável global):	posição da nave
   2346				     ; Parâmetros de saída:
   2347				     ;	 - Cria	novo tiro ativo	(se houver slot	disponível)
   2348				     ;===============================================================================
   2349	05A5			     SHOOT proc
   2350	05A5  50			 push ax
   2351	05A6  53			 push bx
   2352	05A7  51			 push cx
   2353	05A8  56			 push si
   2354
   2355					 ; Procura um slot livre para o	tiro
   2356	05A9  33 C9			 xor cx, cx
   2357	05AB  8A 0E 074Fr		 mov cl, shot_count
   2358	05AF  BE 0756r			 mov si, offset	shot_active
   2359
   2360	05B2			     FIND_FREE_SHOT:
   2361	05B2  80 3C 00			 cmp byte ptr [si], 0	 ; Verifica se este slot está livre
   2362	05B5  74 06			 je FOUND_FREE_SHOT
   2363	05B7  46			 inc si			 ; Próximo slot
   2364	05B8  E2 F8			 loop FIND_FREE_SHOT
   2365	05BA  EB 24 90			 jmp END_SHOOT		; Todos	os slots ocupados
   2366
   2367	05BD			     FOUND_FREE_SHOT:
   2368					 ; Calcula o índice do	slot livre
   2369	05BD  8B C6			 mov ax, si
   2370	05BF  2D 0756r			 sub ax, offset	shot_active  ; AX = índice do slot (0 ou 1)
   2371
   2372					 ; Ativa o tiro	na posição da	nave
   2373	05C2  8B 1E 074Dr		 mov bx, ship_pos
   2374	05C6  83 C3 1D			 add bx, 29		 ; Posição no	nariz da nave (largura do sprite = 29)
   2375	05C9  81 C3 0780		 add bx, 320 * 6	 ; Ajusta para o meio vertical da nave (altura/2 ≈ 6)
   2376
   2377					 ; Armazena a posição	do tiro
   2378	05CD  D1 E0			 shl ax, 1		 ; Multiplica por 2 (words são	2 bytes)
   2379	05CF  BE 0750r			 mov si, offset	shot_pos
   2380	05D2  03 F0			 add si, ax
   2381	05D4  89 1C			 mov [si], bx
   2382
   2383					 ; Marca o tiro	como ativo
   2384	05D6  D1 E8			 shr ax, 1		 ; Volta para índice original
   2385	05D8  BE 0756r			 mov si, offset	shot_active
   2386	05DB  03 F0			 add si, ax
   2387	05DD  C6 04 01			 mov byte ptr [si], 1
   2388
   2389	05E0			     END_SHOOT:
   2390	05E0  5E			 pop si
   2391	05E1  59			 pop cx
   2392	05E2  5B			 pop bx
   2393	05E3  58			 pop ax
   2394	05E4  C3			 ret
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 43
MAIN.ASM



   2395	05E5			     SHOOT endp
   2396
   2397
   2398				     ;===============================================================================
   2399				     ; UPDATE_SHOT
   2400				     ;===============================================================================
   2401				     ; Função: Atualiza e move todos os tiros	ativos na tela
   2402				     ; Parâmetros de entrada: Nenhum
   2403				     ; Parâmetros de saída: Nenhum (atualiza arrays shot_pos e shot_active)
   2404				     ;===============================================================================
   2405	05E5			     UPDATE_SHOT proc
   2406	05E5  57			 push di
   2407	05E6  56			 push si
   2408	05E7  50			 push ax
   2409	05E8  53			 push bx
   2410	05E9  51			 push cx
   2411	05EA  52			 push dx
   2412
   2413					 ; Loop	através de todos os tiros
   2414	05EB  33 C9			 xor cx, cx
   2415	05ED  8A 0E 074Fr		 mov cl, shot_count
   2416
   2417	05F1			     UPDATE_SHOT_LOOP:
   2418	05F1  51			 push cx		 ; Salva contador
   2419	05F2  49			 dec cx			 ; Converte para índice base 0
   2420
   2421					 ; Verifica se este tiro está ativo
   2422	05F3  BE 0756r			 mov si, offset	shot_active
   2423	05F6  03 F1			 add si, cx
   2424	05F8  80 3C 01			 cmp byte ptr [si], 1
   2425	05FB  75 3E			 jne NEXT_SHOT
   2426
   2427					 ; Obtém a posição do tiro
   2428	05FD  51			 push cx		 ; Salva índice
   2429	05FE  D1 E1			 shl cx, 1		 ; Multiplica por 2 (words)
   2430	0600  BE 0750r			 mov si, offset	shot_pos
   2431	0603  03 F1			 add si, cx
   2432	0605  8B 3C			 mov di, [si]		 ; DI =	posição atual	do tiro
   2433	0607  59			 pop cx			 ; Restaura índice
   2434
   2435					 ; Limpa a posição anterior do tiro
   2436	0608  E8 0066			 call CLEAR_SHOT_SPRITE
   2437
   2438					 ; Calcula posição X atual
   2439	060B  8B C7			 mov ax, di
   2440	060D  BB 0140			 mov bx, 320
   2441	0610  33 D2			 xor dx, dx
   2442	0612  F7 F3			 div bx
   2443					 ; DX =	posição X na linha
   2444
   2445					 ; Se posição	X >= 310, desativa o tiro (mais	conservador)
   2446	0614  81 FA 0136		 cmp dx, 310
   2447	0618  73 19			 jae DEACTIVATE_THIS_SHOT
   2448
   2449					 ; Move	o tiro para direita (2 pixels)
   2450	061A  83 C7 02			 add di, 2
   2451
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 44
MAIN.ASM



   2452					 ; Atualiza posição
   2453	061D  51			 push cx
   2454	061E  D1 E1			 shl cx, 1
   2455	0620  BE 0750r			 mov si, offset	shot_pos
   2456	0623  03 F1			 add si, cx
   2457	0625  89 3C			 mov [si], di
   2458	0627  59			 pop cx
   2459
   2460					 ; Renderiza o tiro na nova posição
   2461	0628  8B C7			 mov ax, di
   2462	062A  BE 0727r			 mov si, offset	shot_sprite
   2463	062D  E8 0015			 call RENDER_SHOT_SPRITE
   2464	0630  EB 09 90			 jmp NEXT_SHOT
   2465
   2466	0633			     DEACTIVATE_THIS_SHOT:
   2467					 ; Desativa este tiro específico
   2468	0633  BE 0756r			 mov si, offset	shot_active
   2469	0636  03 F1			 add si, cx
   2470	0638  C6 04 00			 mov byte ptr [si], 0
   2471
   2472	063B			     NEXT_SHOT:
   2473	063B  59			 pop cx			 ; Restaura contador
   2474	063C  E2 B3			 loop UPDATE_SHOT_LOOP
   2475
   2476	063E  5A			 pop dx
   2477	063F  59			 pop cx
   2478	0640  5B			 pop bx
   2479	0641  58			 pop ax
   2480	0642  5E			 pop si
   2481	0643  5F			 pop di
   2482	0644  C3			 ret
   2483	0645			     UPDATE_SHOT endp
   2484
   2485				     ;===============================================================================
   2486				     ; RENDER_SHOT_SPRITE
   2487				     ;===============================================================================
   2488				     ; Função: Renderiza o sprite de um tiro
   2489				     ; Parâmetros de entrada:
   2490				     ;	 - AX: posição linear	na tela
   2491				     ;	 - SI: offset do sprite	do tiro
   2492				     ; Parâmetros de saída: Nenhum
   2493				     ;===============================================================================
   2494	0645			     RENDER_SHOT_SPRITE	proc
   2495	0645  53			 push bx
   2496	0646  51			 push cx
   2497	0647  52			 push dx
   2498	0648  57			 push di
   2499	0649  06			 push es
   2500	064A  1E			 push ds
   2501	064B  50			 push ax
   2502
   2503	064C  B8 0000s			 mov ax, @data
   2504	064F  8E D8			 mov ds, ax
   2505
   2506	0651  B8 A000			 mov ax, 0A000h
   2507	0654  8E C0			 mov es, ax
   2508
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 45
MAIN.ASM



   2509	0656  58			 pop ax
   2510	0657  8B F8			 mov di, ax
   2511	0659  BA 0006			 mov dx, 6		 ; Sprite do tiro tem 6	linhas de altura
   2512	065C  50			 push ax
   2513
   2514	065D			     DRAW_SHOT_LINE:
   2515	065D  B9 0006			 mov cx, 6		; Cada linha do	sprite tem 22 bytes
   2516	0660  F3> A4			 rep movsb
   2517	0662  81 C7 013A		 add di, SCREEN_W - 6	; Ajusta para próxima linha (320 - 22)
   2518	0666  4A			 dec dx
   2519	0667  75 F4			 jnz DRAW_SHOT_LINE
   2520
   2521	0669  58			 pop ax
   2522	066A  1F			 pop ds
   2523	066B  07			 pop es
   2524	066C  5F			 pop di
   2525	066D  5A			 pop dx
   2526	066E  59			 pop cx
   2527	066F  5B			 pop bx
   2528	0670  C3			 ret
   2529	0671			     RENDER_SHOT_SPRITE	endp
   2530
   2531				     ;===============================================================================
   2532				     ; CLEAR_SHOT_SPRITE
   2533				     ;===============================================================================
   2534				     ; Função: Limpa o sprite	de um tiro da tela
   2535				     ; Parâmetros de entrada:
   2536				     ;	 - DI: posição linear	do tiro
   2537				     ; Parâmetros de saída: Nenhum
   2538				     ;===============================================================================
   2539	0671			     CLEAR_SHOT_SPRITE proc
   2540	0671  50			 push ax
   2541	0672  51			 push cx
   2542	0673  57			 push di
   2543	0674  06			 push es
   2544
   2545	0675  B8 A000			 mov ax, 0A000h
   2546	0678  8E C0			 mov es, ax
   2547	067A  B9 0006			 mov cx, 6		 ; Altura do sprite do tiro
   2548
   2549	067D			     CLEAR_SHOT_LINE:
   2550	067D  51			 push cx
   2551	067E  B9 0006			 mov cx, 6		; Largura do sprite do tiro
   2552	0681  32 C0			 xor al, al		 ; cor 0 (preto)
   2553	0683  F3> AA			 rep stosb
   2554	0685  81 C7 013A		 add di, SCREEN_W - 6	; Próxima linha
   2555	0689  59			 pop cx
   2556	068A  E2 F1			 loop CLEAR_SHOT_LINE
   2557
   2558	068C  07			 pop es
   2559	068D  5F			 pop di
   2560	068E  59			 pop cx
   2561	068F  58			 pop ax
   2562	0690  C3			 ret
   2563	0691			     CLEAR_SHOT_SPRITE endp
   2564
   2565
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 46
MAIN.ASM



   2566				     ;===============================================================================
   2567				     ; RENDER_TERRAIN
   2568				     ;===============================================================================
   2569				     ; Função: Renderiza o terreno apropriado	para a fase atual
   2570				     ; Parâmetros de entrada:
   2571				     ;	 - fase	(variável global): fase atual (1, 2 ou	3)
   2572				     ; Parâmetros de saída: Nenhum
   2573				     ;===============================================================================
   2574	0691			     RENDER_TERRAIN proc
   2575	0691  53			 push bx
   2576	0692  51			 push cx
   2577	0693  52			 push dx
   2578	0694  57			 push di
   2579	0695  06			 push es
   2580	0696  1E			 push ds
   2581	0697  50			 push ax
   2582
   2583	0698  B8 0000s			 mov ax, @data
   2584	069B  8E D8			 mov ds, ax
   2585
   2586	069D  B8 A000			 mov ax, 0A000h
   2587	06A0  8E C0			 mov es, ax
   2588
   2589					 ; Verifica se é fase 3 (usa renderização procedural)
   2590	06A2  A0 0003r			 mov al, fase
   2591	06A5  3C 03			 cmp al, 3
   2592	06A7  74 49			 je RENDER_TERRAIN_FASE3
   2593
   2594					 ; Seleciona o terreno correto baseado na fase
   2595	06A9  33 C0			 xor ax, ax
   2596	06AB  A0 0003r			 mov al, fase
   2597	06AE  FE C8			 dec al			     ; fase 1->0, fase 2->1
   2598	06B0  D0 E0			 shl al, 1		     ; multiplica por 2	(offsets são words)
   2599	06B2  BB A519r			 mov bx, offset	terrain_vec
   2600	06B5  03 D8			 add bx, ax
   2601	06B7  8B 37			 mov si, [bx]		    ; SI = offset do terreno da	fase atual
   2602
   2603					 ; DI =	posição inicial do terreno na	tela (linha 150)
   2604	06B9  BF BB80			 mov di, 320*150
   2605
   2606					 ; SI já aponta para o	offset do terreno
   2607					 ; Adiciona o scroll horizontal
   2608	06BC  03 36 A51Fr		 add si, terrain_pos
   2609
   2610					 ; Copia 50 linhas de 320 bytes
   2611	06C0  B9 0032			 mov cx, 50
   2612	06C3			     COPY_TERRAIN_LINE:
   2613	06C3  51			 push cx
   2614	06C4  56			 push si
   2615	06C5  57			 push di
   2616
   2617	06C6  B9 0140			 mov cx, 320
   2618	06C9  F3> A4			 rep movsb
   2619
   2620	06CB  5F			 pop di
   2621	06CC  5E			 pop si
   2622	06CD  59			 pop cx
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 47
MAIN.ASM



   2623
   2624	06CE  81 C7 0140		 add di, 320	     ; Próxima	linha na tela
   2625	06D2  81 C6 0140		 add si, 320	     ; Próxima	linha do terreno
   2626	06D6  E2 EB			 loop COPY_TERRAIN_LINE
   2627
   2628					 ; Atualiza scroll horizontal (1 pixel por frame)
   2629	06D8  FF 06 A51Fr		 inc terrain_pos
   2630	06DC  81 3E A51Fr 0140		 cmp terrain_pos, 320  ; Se completou uma linha
   2631	06E2  7C 06			 jl TERRAIN_DONE_RENDER
   2632	06E4  C7 06 A51Fr 0000		 mov terrain_pos, 0    ; Reseta	para início
   2633
   2634	06EA			     TERRAIN_DONE_RENDER:
   2635	06EA  58			 pop ax
   2636	06EB  1F			 pop ds
   2637	06EC  07			 pop es
   2638	06ED  5F			 pop di
   2639	06EE  5A			 pop dx
   2640	06EF  59			 pop cx
   2641	06F0  5B			 pop bx
   2642	06F1  C3			 ret
   2643
   2644	06F2			     RENDER_TERRAIN_FASE3:
   2645					 ; Renderização procedural para fase 3
   2646					 ; Limpa apenas	a borda	esquerda (onde torres saem)
   2647	06F2  50			 push ax
   2648	06F3  51			 push cx
   2649	06F4  57			 push di
   2650	06F5  06			 push es
   2651
   2652	06F6  B8 A000			 mov ax, 0A000h
   2653	06F9  8E C0			 mov es, ax
   2654
   2655					 ; Limpa apenas	primeiros pixels da borda esquerda (pequena margem)
   2656	06FB  BF 5780			 mov di, 70*320
   2657	06FE  B9 0082			 mov cx, 130
   2658	0701			     CLEAR_LEFT_EDGE:
   2659	0701  51			 push cx
   2660	0702  57			 push di
   2661	0703  B9 0005			 mov cx, 5		 ; Limpa apenas	5 pixels
   2662	0706  32 C0			 xor al, al
   2663	0708  F3> AA			 rep stosb
   2664	070A  5F			 pop di
   2665	070B  59			 pop cx
   2666	070C  81 C7 0140		 add di, 320
   2667	0710  E2 EF			 loop CLEAR_LEFT_EDGE
   2668
   2669	0712  07			 pop es
   2670	0713  5F			 pop di
   2671	0714  59			 pop cx
   2672	0715  58			 pop ax
   2673
   2674					 ; Atualiza e renderiza	torres
   2675	0716  E8 0047			 call UPDATE_FASE3_TOWERS
   2676	0719  E8 00C1			 call RENDER_FASE3_TOWERS
   2677
   2678	071C  EB CC			 jmp TERRAIN_DONE_RENDER
   2679
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 48
MAIN.ASM



   2680	071E			     endp
   2681
   2682
   2683				     ;===============================================================================
   2684				     ; INIT_FASE3_TOWERS
   2685				     ;===============================================================================
   2686				     ; Função: Inicializa o sistema de torres	procedurais da fase 3
   2687				     ; Parâmetros de entrada: Nenhum
   2688				     ; Parâmetros de saída:
   2689				     ;	 - Arrays tower_heights, tower_x_pos e tower_active inicializados
   2690				     ;===============================================================================
   2691	071E			     INIT_FASE3_TOWERS proc
   2692	071E  50			 push ax
   2693	071F  53			 push bx
   2694	0720  51			 push cx
   2695	0721  52			 push dx
   2696
   2697					 ; Inicializa torres preenchendo a tela	toda (da direita para esquerda)
   2698	0722  33 DB			 xor bx, bx
   2699	0724  BA 0140			 mov dx, 320			  ; Começa em X = 320 (borda direita)
   2700	0727  B9 000C			 mov cx, MAX_TOWERS		  ; 12 torres x	34 pixels = 408	pixels (cobre tela e mais)
   2701
   2702	072A			     INIT_TOWER_LOOP:
   2703					 ; Ativa torre
   2704	072A  C6 87 A545r 01		 mov byte ptr tower_active[bx],	1
   2705
   2706					 ; Define posição X
   2707	072F  53			 push bx
   2708	0730  D1 E3			 shl bx, 1		       ; BX = BX * 2
   2709	0732  89 97 A52Dr		 mov word ptr tower_x_pos[bx], dx
   2710	0736  5B			 pop bx
   2711
   2712					 ; Altura aleatória (3	a 6 andares para início)
   2713	0737  53			 push bx
   2714	0738  51			 push cx
   2715	0739  52			 push dx
   2716	073A  E8 F9E9			 call RANDOM_UINT16
   2717	073D  25 0003			 and ax, 3		 ; 0-3
   2718	0740  04 03			 add al, 3		 ; 3-6 andares
   2719	0742  5A			 pop dx
   2720	0743  59			 pop cx
   2721	0744  5B			 pop bx
   2722	0745  88 87 A521r		 mov byte ptr tower_heights[bx], al
   2723
   2724					 ; Próxima torre colada (BASE_WIDTH pixels à esquerda)
   2725	0749  83 EA 22			 sub dx, BASE_WIDTH
   2726
   2727	074C  43			 inc bx
   2728	074D  E2 DB			 loop INIT_TOWER_LOOP
   2729
   2730					 ; Reseta contadores
   2731					 ; Contador em 0 porque	a primeira torre já está no ciclo correto
   2732	074F  C7 06 A551r 0140		 mov next_tower_x, 320
   2733	0755  C7 06 A553r 0000		 mov tower_spawn_counter, 0
   2734
   2735	075B  5A			 pop dx
   2736	075C  59			 pop cx
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 49
MAIN.ASM



   2737	075D  5B			 pop bx
   2738	075E  58			 pop ax
   2739	075F  C3			 ret
   2740	0760			     INIT_FASE3_TOWERS endp
   2741
   2742
   2743				     ;===============================================================================
   2744				     ; UPDATE_FASE3_TOWERS
   2745				     ;===============================================================================
   2746				     ; Função: Atualiza movimento das	torres e gera novas quando necessário
   2747				     ; Parâmetros de entrada: Nenhum
   2748				     ; Parâmetros de saída:
   2749				     ;	 - Atualiza posições e spawna	novas torres
   2750				     ;===============================================================================
   2751	0760			     UPDATE_FASE3_TOWERS proc
   2752	0760  50			 push ax
   2753	0761  53			 push bx
   2754	0762  51			 push cx
   2755	0763  52			 push dx
   2756
   2757					 ; Move	todas as torres	para esquerda
   2758	0764  33 DB			 xor bx, bx
   2759	0766  B9 000C			 mov cx, MAX_TOWERS
   2760	0769			     MOVE_TOWERS_LOOP:
   2761	0769  80 BF A545r 00		 cmp byte ptr tower_active[bx],	0
   2762	076E  74 1C			 je SKIP_MOVE_TOWER
   2763
   2764					 ; Calcula offset para tower_x_pos (word array)
   2765	0770  53			 push bx
   2766	0771  D1 E3			 shl bx, 1		       ; BX = BX * 2
   2767
   2768					 ; Move	torre 1	pixel para esquerda
   2769	0773  FF 8F A52Dr		 dec word ptr tower_x_pos[bx]
   2770
   2771					 ; Verifica se saiu pela esquerda (X < -40)
   2772	0777  8B 87 A52Dr		 mov ax, word ptr tower_x_pos[bx]
   2773	077B  5B			 pop bx
   2774
   2775					 ; Se X	>= 0, continua
   2776	077C  85 C0			 test ax, ax
   2777	077E  79 0C			 jns SKIP_MOVE_TOWER
   2778
   2779					 ; X é	negativo, converte para	positivo e verifica
   2780	0780  F7 D8			 neg ax
   2781	0782  3D 0028			 cmp ax, 40
   2782	0785  7C 05			 jl SKIP_MOVE_TOWER
   2783
   2784					 ; Torre saiu pela esquerda, desativa e	será respawnada
   2785	0787  C6 87 A545r 00		 mov byte ptr tower_active[bx],	0
   2786
   2787	078C			     SKIP_MOVE_TOWER:
   2788	078C  43			 inc bx
   2789	078D  E2 DA			 loop MOVE_TOWERS_LOOP
   2790
   2791					 ; Verifica se deve gerar nova torre
   2792	078F  FF 06 A553r		 inc tower_spawn_counter
   2793	0793  A1 A553r			 mov ax, tower_spawn_counter
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 50
MAIN.ASM



   2794	0796  3D 0022			 cmp ax, tower_min_spacing
   2795	0799  7C 09			 jl SKIP_SPAWN_TOWER	     ; Pula se counter < 34
   2796
   2797					 ; Reseta contador e gera nova torre
   2798	079B  C7 06 A553r 0000		 mov tower_spawn_counter, 0
   2799	07A1  E8 0005			 call SPAWN_FASE3_TOWER
   2800
   2801	07A4			     SKIP_SPAWN_TOWER:
   2802	07A4  5A			 pop dx
   2803	07A5  59			 pop cx
   2804	07A6  5B			 pop bx
   2805	07A7  58			 pop ax
   2806	07A8  C3			 ret
   2807	07A9			     UPDATE_FASE3_TOWERS endp
   2808
   2809
   2810				     ;===============================================================================
   2811				     ; SPAWN_FASE3_TOWER
   2812				     ;===============================================================================
   2813				     ; Função: Spawna	uma nova torre com altura aleatória
   2814				     ; Parâmetros de entrada: Nenhum
   2815				     ; Parâmetros de saída:
   2816				     ;	 - Nova	torre criada em	slot disponível (se houver)
   2817				     ;===============================================================================
   2818	07A9			     SPAWN_FASE3_TOWER proc
   2819	07A9  50			 push ax
   2820	07AA  53			 push bx
   2821	07AB  51			 push cx
   2822
   2823					 ; Procura slot	vazio
   2824	07AC  33 DB			 xor bx, bx
   2825	07AE  B9 000C			 mov cx, MAX_TOWERS
   2826	07B1			     FIND_EMPTY_SLOT:
   2827	07B1  80 BF A545r 00		 cmp byte ptr tower_active[bx],	0
   2828	07B6  74 06			 je FOUND_EMPTY_SLOT
   2829	07B8  43			 inc bx
   2830	07B9  E2 F6			 loop FIND_EMPTY_SLOT
   2831	07BB  EB 1C 90			 jmp SPAWN_DONE	 ; Sem slots vazios
   2832
   2833	07BE			     FOUND_EMPTY_SLOT:
   2834					 ; Ativa torre
   2835	07BE  C6 87 A545r 01		 mov byte ptr tower_active[bx],	1
   2836
   2837					 ; Posição X inicial (320 para spawnar fora e	aparecer gradualmente)
   2838	07C3  53			 push bx
   2839	07C4  D1 E3			 shl bx, 1		       ; BX = BX * 2
   2840	07C6  C7 87 A52Dr 0140		 mov word ptr tower_x_pos[bx], 320  ; X	= 320 (fora da tela)
   2841	07CC  5B			 pop bx
   2842
   2843					 ; Gera	altura aleatória (2 a 8 andares)
   2844	07CD  E8 F956			 call RANDOM_UINT16
   2845	07D0  25 0007			 and ax, 7	  ; AX = 0-7
   2846	07D3  04 02			 add al, 2	  ; AL = 2-9
   2847	07D5  88 87 A521r		 mov byte ptr tower_heights[bx], al
   2848
   2849	07D9			     SPAWN_DONE:
   2850	07D9  59			 pop cx
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 51
MAIN.ASM



   2851	07DA  5B			 pop bx
   2852	07DB  58			 pop ax
   2853	07DC  C3			 ret
   2854	07DD			     SPAWN_FASE3_TOWER endp
   2855
   2856
   2857				     ;===============================================================================
   2858				     ; RENDER_FASE3_TOWERS
   2859				     ;===============================================================================
   2860				     ; Função: Renderiza todas as torres ativas na tela
   2861				     ; Parâmetros de entrada: Nenhum
   2862				     ; Parâmetros de saída: Nenhum
   2863				     ;===============================================================================
   2864	07DD			     RENDER_FASE3_TOWERS proc
   2865	07DD  50			 push ax
   2866	07DE  53			 push bx
   2867	07DF  51			 push cx
   2868	07E0  52			 push dx
   2869	07E1  56			 push si
   2870	07E2  57			 push di
   2871
   2872	07E3  33 DB			 xor bx, bx
   2873	07E5  B9 000C			 mov cx, MAX_TOWERS
   2874	07E8			     RENDER_TOWERS_LOOP:
   2875	07E8  80 BF A545r 00		 cmp byte ptr tower_active[bx],	0
   2876	07ED  74 17			 je SKIP_RENDER_TOWER
   2877
   2878					 ; Renderiza esta torre
   2879	07EF  53			 push bx
   2880	07F0  51			 push cx
   2881
   2882	07F1  32 E4			 xor ah, ah
   2883	07F3  8A 87 A521r		 mov al, byte ptr tower_heights[bx]
   2884	07F7  8B C8			 mov cx, ax			 ; CX =	altura em andares
   2885
   2886					 ; Calcula offset para tower_x_pos (word array)
   2887	07F9  53			 push bx
   2888	07FA  D1 E3			 shl bx, 1		       ; BX = BX * 2
   2889	07FC  8B 97 A52Dr		 mov dx, word ptr tower_x_pos[bx]  ; DX	= posição X
   2890	0800  5B			 pop bx
   2891
   2892	0801  E8 000C			 call RENDER_TOWER
   2893
   2894	0804  59			 pop cx
   2895	0805  5B			 pop bx
   2896
   2897	0806			     SKIP_RENDER_TOWER:
   2898	0806  43			 inc bx
   2899	0807  E2 DF			 loop RENDER_TOWERS_LOOP
   2900
   2901	0809  5F			 pop di
   2902	080A  5E			 pop si
   2903	080B  5A			 pop dx
   2904	080C  59			 pop cx
   2905	080D  5B			 pop bx
   2906	080E  58			 pop ax
   2907	080F  C3			 ret
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 52
MAIN.ASM



   2908	0810			     RENDER_FASE3_TOWERS endp
   2909
   2910
   2911				     ;===============================================================================
   2912				     ; RENDER_TOWER
   2913				     ;===============================================================================
   2914				     ; Função: Renderiza uma torre individual	com clipping horizontal
   2915				     ; Parâmetros de entrada:
   2916				     ;	 - CX: altura da torre (número	de andares: 2-9)
   2917				     ;	 - DX: posição X da torre
   2918				     ; Parâmetros de saída: Nenhum
   2919				     ;===============================================================================
   2920	0810			     RENDER_TOWER proc
   2921	0810  50			 push ax
   2922	0811  53			 push bx
   2923	0812  51			 push cx
   2924	0813  52			 push dx
   2925	0814  56			 push si
   2926	0815  57			 push di
   2927	0816  55			 push bp
   2928	0817  06			 push es
   2929
   2930					 ; Garante direção forward para movsb
   2931	0818  FC			 cld
   2932
   2933					 ; Configura ES	para apontar para memória de vídeo
   2934	0819  B8 A000			 mov ax, 0A000h
   2935	081C  8E C0			 mov es, ax
   2936
   2937					 ; Verifica se torre está visível (permite renderização parcial)
   2938	081E  83 FA DE			 cmp dx, -BASE_WIDTH
   2939	0821  7C 09			 jl TOWER_NOT_VISIBLE_JMP
   2940	0823  81 FA 0140		 cmp dx, 320
   2941	0827  7D 03			 jge TOWER_NOT_VISIBLE_JMP
   2942	0829  EB 04 90			 jmp TOWER_VISIBLE
   2943
   2944	082C			     TOWER_NOT_VISIBLE_JMP:
   2945	082C  E9 00C2			 jmp TOWER_NOT_VISIBLE
   2946
   2947	082F			     TOWER_VISIBLE:
   2948
   2949	082F  51			 push cx		 ; Salva altura	da torre original
   2950
   2951					 ; Calcula clipping horizontal usando variáveis globais
   2952					 ; DX =	X da torre (pode ser negativo)
   2953	0830  C7 06 A555r 0000		 mov tower_sprite_offset, 0
   2954	0836  B8 0022			 mov ax, BASE_WIDTH
   2955	0839  A3 A557r			 mov tower_render_width, ax
   2956
   2957					 ; Verifica se X < 0 (saindo pela esquerda)
   2958	083C  83 FA 00			 cmp dx, 0
   2959	083F  7D 16			 jge CLIP_RIGHT_CHECK
   2960
   2961					 ; X negativo: calcula offset e	ajusta
   2962	0841  8B C2			 mov ax, dx
   2963	0843  F7 D8			 neg ax			     ; AX = |X|
   2964	0845  A3 A555r			 mov tower_sprite_offset, ax ; Offset =	|X|
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 53
MAIN.ASM



   2965	0848  BB 0022			 mov bx, BASE_WIDTH
   2966	084B  2B D8			 sub bx, ax		     ; BX = largura - offset
   2967	084D  89 1E A557r		 mov tower_render_width, bx
   2968	0851  BA 0000			 mov dx, 0		     ; Desenha a partir	de X=0
   2969	0854  EB 13 90			 jmp CLIP_DONE
   2970
   2971	0857			     CLIP_RIGHT_CHECK:
   2972					 ; Verifica se ultrapassa borda	direita
   2973	0857  8B C2			 mov ax, dx
   2974	0859  05 0022			 add ax, BASE_WIDTH
   2975	085C  3D 0140			 cmp ax, 320
   2976	085F  7E 08			 jle CLIP_DONE
   2977					 ; Ajusta largura
   2978	0861  B8 0140			 mov ax, 320
   2979	0864  2B C2			 sub ax, dx		     ; AX = 320	- X
   2980	0866  A3 A557r			 mov tower_render_width, ax
   2981
   2982	0869			     CLIP_DONE:
   2983
   2984					 ; Calcula posição Y inicial (topo da	torre)
   2985					 ; Y_topo = ROW_TERRAIN_FASE3 -	(altura	* BASE_HEIGHT)
   2986	0869  8B C1			 mov ax, cx
   2987	086B  B3 08			 mov bl, BASE_HEIGHT
   2988	086D  F6 E3			 mul bl			 ; AX =	altura * BASE_HEIGHT (tamanho total em pixels)
   2989	086F  BB 0096			 mov bx, ROW_TERRAIN_FASE3
   2990	0872  2B D8			 sub bx, ax		 ; BX =	linha do terreno - altura total
   2991
   2992					 ; Permite torres altas	que começam acima da tela
   2993	0874  83 FB 00			 cmp bx, 0
   2994	0877  7D 02			 jge TOWER_Y_OK
   2995	0879  33 DB			 xor bx, bx		 ; Y inicial = 0
   2996	087B			     TOWER_Y_OK:
   2997
   2998					 ; Calcula offset linear: Y * 320 + X
   2999	087B  52			 push dx		 ; Salva X na stack
   3000	087C  8B C3			 mov ax, bx		 ; AX =	Y inicial (topo	da torre)
   3001	087E  BB 0140			 mov bx, 320
   3002	0881  F7 E3			 mul bx			 ; DX:AX = Y * 320
   3003	0883  5B			 pop bx			 ; BX =	X
   3004	0884  03 C3			 add ax, bx		 ; AX =	Y * 320	+ X
   3005	0886  8B F8			 mov di, ax		 ; DI =	posição inicial
   3006
   3007					 ; Calcula total de andares a renderizar
   3008	0888  58			 pop ax			 ; AX =	altura original	da torre
   3009	0889  8B E8			 mov bp, ax		 ; BP =	altura da torre
   3010	088B  05 0006			 add ax, 6		 ; +6 andares de preenchimento
   3011	088E  8B C8			 mov cx, ax		 ; CX =	total de andares
   3012
   3013	0890			     RENDER_FLOOR_LOOP:
   3014	0890  51			 push cx
   3015	0891  55			 push bp
   3016
   3017					 ; Verifica se é o primeiro andar (topo da torre)
   3018					 ; CX começa com o valor máximo (altura + 6)
   3019	0892  8B C5			 mov ax, bp
   3020	0894  05 0006			 add ax, 6		 ; Total de andares
   3021	0897  3B C8			 cmp cx, ax
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 54
MAIN.ASM



   3022	0899  5D			 pop bp
   3023	089A  75 24			 jne RENDER_BASE_ANDAR_2
   3024
   3025					 ; Renderiza TOPO
   3026	089C  57			 push di
   3027	089D  BE A409r			 mov si, offset	topo
   3028
   3029					 ; Adiciona offset do sprite (pixels a pular)
   3030	08A0  03 36 A555r		 add si, tower_sprite_offset
   3031
   3032	08A4  B9 0008			 mov cx, BASE_HEIGHT
   3033	08A7			     RENDER_TOP_LINE_LOOP:
   3034	08A7  51			 push cx
   3035	08A8  57			 push di
   3036	08A9  56			 push si
   3037
   3038	08AA  8B 0E A557r		 mov cx, tower_render_width  ; Largura a renderizar
   3039	08AE  F3> A4			 rep movsb		     ; Copia CX	pixels
   3040
   3041	08B0  5E			 pop si
   3042	08B1  83 C6 22			 add si, BASE_WIDTH	     ; Próxima	linha do sprite
   3043	08B4  5F			 pop di
   3044	08B5  59			 pop cx
   3045	08B6  81 C7 0140		 add di, 320		     ; Próxima	linha da tela
   3046	08BA  E2 EB			 loop RENDER_TOP_LINE_LOOP
   3047	08BC  5F			 pop di
   3048	08BD  EB 22 90			 jmp NEXT_FLOOR
   3049
   3050	08C0			     RENDER_BASE_ANDAR_2:
   3051					 ; Renderiza andar da BASE (usado tanto	para torre quanto preenchimento)
   3052	08C0  57			 push di
   3053	08C1  BE A2F9r			 mov si, offset	base
   3054
   3055					 ; Adiciona offset do sprite (pixels a pular)
   3056	08C4  03 36 A555r		 add si, tower_sprite_offset
   3057
   3058	08C8  B9 0008			 mov cx, BASE_HEIGHT
   3059	08CB			     RENDER_BASE_LINE_LOOP:
   3060	08CB  51			 push cx
   3061	08CC  57			 push di
   3062	08CD  56			 push si
   3063
   3064	08CE  8B 0E A557r		 mov cx, tower_render_width  ; Largura a renderizar
   3065	08D2  F3> A4			 rep movsb		     ; Copia CX	pixels
   3066
   3067	08D4  5E			 pop si
   3068	08D5  83 C6 22			 add si, BASE_WIDTH	     ; Próxima	linha do sprite
   3069	08D8  5F			 pop di
   3070	08D9  59			 pop cx
   3071	08DA  81 C7 0140		 add di, 320		     ; Próxima	linha da tela
   3072	08DE  E2 EB			 loop RENDER_BASE_LINE_LOOP
   3073	08E0  5F			 pop di
   3074
   3075	08E1			     NEXT_FLOOR:
   3076					 ; Move	para o próximo	andar (descendo	na tela)
   3077	08E1  B8 0008			 mov ax, BASE_HEIGHT
   3078	08E4  BB 0140			 mov bx, 320
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 55
MAIN.ASM



   3079	08E7  F7 E3			 mul bx
   3080	08E9  03 F8			 add di, ax	     ; DI += BASE_HEIGHT * 320
   3081
   3082	08EB  59			 pop cx
   3083	08EC  E2 A2			 loop RENDER_FLOOR_LOOP
   3084	08EE  EB 01 90			 jmp TOWER_DONE
   3085
   3086	08F1			     TOWER_NOT_VISIBLE:
   3087					 ; Torre não visível,	não faz nada
   3088
   3089	08F1			     TOWER_DONE:
   3090	08F1  07			 pop es
   3091	08F2  5D			 pop bp
   3092	08F3  5F			 pop di
   3093	08F4  5E			 pop si
   3094	08F5  5A			 pop dx
   3095	08F6  59			 pop cx
   3096	08F7  5B			 pop bx
   3097	08F8  58			 pop ax
   3098	08F9  C3			 ret
   3099	08FA			     RENDER_TOWER endp
   3100
   3101				     ;===============================================================================
   3102				     ; SHOW_GAME_OVER
   3103				     ;===============================================================================
   3104				     ; Função: Exibe tela de Game Over quando	o jogador perde	todas as vidas
   3105				     ; Parâmetros de entrada: Nenhum
   3106				     ; Parâmetros de saída: Nenhum (aguarda tecla e retorna ao menu)
   3107				     ;===============================================================================
   3108	08FA			     SHOW_GAME_OVER proc
   3109	08FA  50			 push ax
   3110	08FB  53			 push bx
   3111	08FC  51			 push cx
   3112	08FD  52			 push dx
   3113	08FE  56			 push si
   3114
   3115	08FF  E8 F9C4			 call CLEAR_SCREEN
   3116	0902  33 C9			 xor cx, cx
   3117	0904  B9 001E			 mov cx, 1Eh
   3118	0907  BA 2710			 mov dx, 2710H
   3119	090A  B4 86			 mov ah, 86H
   3120	090C  CD 15			 int 15h
   3121					 ; Configura ES	para apontar para o segmento de	dados
   3122	090E  8C D8			 mov ax, ds
   3123	0910  8E C0			 mov es, ax
   3124
   3125					 ; Exibe mensagem Game Over em vermelho
   3126	0912  BD 09D0r			 mov bp, offset	game_over_msg
   3127	0915  B9 0122			 mov cx, game_over_msg_length ;	tamanho
   3128	0918  B3 0C			 mov bl, 0Ch	 ; cor vermelha
   3129	091A  BA 03C0			 mov dx, 320*3 ; linha / coluna
   3130	091D  E8 F7B2			 call PRINT_STRING
   3131
   3132					 ; ; Move cursor para baixo
   3133					 ; mov ah, 02h
   3134					 ; mov bh, 0
   3135					 ; mov dh, 15	   ; linha 15
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 56
MAIN.ASM



   3136					 ; mov dl, 5	   ; coluna 5
   3137					 ; int 10h
   3138
   3139					 ; Exibe mensagem para pressionar tecla	em branco
   3140					 ; mov bp, offset press_key_msg
   3141					 ; mov cx, 999	   ; tamanho grande
   3142					 ; mov bl, 0Fh	   ; cor branca
   3143					 ; call	PRINT_STRING
   3144
   3145	0920  BD 0BE2r			 mov bp, offset	press_key_msg
   3146	0923  B9 001B			 mov cx, press_key_msg_length ;	tamanho	correto
   3147	0926  B3 0F			 mov bl, 0Fh	 ; cor branca
   3148	0928  BA 1680			 mov dx, 320*18	; linha	18, coluna 8 (centralizado)
   3149	092B  E8 F7A4			 call PRINT_STRING
   3150
   3151					 ; Aguarda tecla
   3152	092E  E8 0077			 call WAIT_KEY
   3153	0931  E8 0074			 call WAIT_KEY
   3154	0934  E8 F98F			 call CLEAR_SCREEN
   3155
   3156	0937  5E			 pop si
   3157	0938  5A			 pop dx
   3158	0939  59			 pop cx
   3159	093A  5B			 pop bx
   3160	093B  58			 pop ax
   3161	093C  C3			 ret
   3162	093D			     SHOW_GAME_OVER endp
   3163
   3164				     ;===============================================================================
   3165				     ; SHOW_VICTORY
   3166				     ;===============================================================================
   3167				     ; Função: Exibe tela de vitória	quando o jogador completa todas	as fases
   3168				     ; Parâmetros de entrada:
   3169				     ;	 - score (variável global): pontuação final
   3170				     ; Parâmetros de saída: Nenhum (aguarda tecla e retorna ao menu)
   3171				     ;===============================================================================
   3172	093D			     SHOW_VICTORY proc
   3173	093D  50			 push ax
   3174	093E  53			 push bx
   3175	093F  51			 push cx
   3176	0940  52			 push dx
   3177	0941  56			 push si
   3178
   3179	0942  E8 F981			 call CLEAR_SCREEN
   3180	0945  33 C9			 xor cx, cx
   3181	0947  B9 001E			 mov cx, 1Eh
   3182	094A  BA 2710			 mov dx, 2710H
   3183	094D  B4 86			 mov ah, 86H
   3184	094F  CD 15			 int 15h
   3185					 ; Configura ES	para apontar para o segmento de	dados
   3186	0951  8C D8			 mov ax, ds
   3187	0953  8E C0			 mov es, ax
   3188
   3189					 ; Exibe mensagem Vencedor em verde
   3190	0955  BD 0AF2r			 mov bp, offset	vencedor_msg
   3191	0958  B9 00F0			 mov cx, vencedor_msg_length ; tamanho correto
   3192	095B  B3 0A			 mov bl, 0Ah	 ; cor verde
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 57
MAIN.ASM



   3193	095D  BA 0640			 mov dx, 320*5 ; linha 5
   3194	0960  E8 F76F			 call PRINT_STRING
   3195
   3196					 ; Exibe score final em	branco
   3197	0963  BD 0BFDr			 mov bp, offset	final_score_msg
   3198	0966  B9 000E			 mov cx, final_score_msg_length	; tamanho correto
   3199	0969  B3 0F			 mov bl, 0Fh	 ; cor branca
   3200	096B  BA 0F0A			 mov dx, 320*12	+ 10 ; linha 12, coluna	15 (centralizado)
   3201	096E  E8 F761			 call PRINT_STRING
   3202
   3203					 ; Converte e exibe o score
   3204	0971  A1 0C15r			 mov ax, score
   3205	0974  BE 0C1Br			 mov si, offset	score_buffer + 4  ; final do buffer
   3206	0977  B9 0005			 mov cx, 5			  ; 5 dígitos
   3207	097A  E8 F9F3			 call CONVERT_UINT16
   3208
   3209	097D  BD 0C17r			 mov bp, offset	score_buffer
   3210	0980  B9 0005			 mov cx, 5	 ; 5 dígitos
   3211	0983  B3 0F			 mov bl, 0Fh	 ; cor branca
   3212	0985  BA 0F17			 mov dx, 320*12	+ 23 ; linha 12, coluna	28 (logo após "SCORE FINAL: ")
   3213	0988  E8 F747			 call PRINT_STRING
   3214
   3215					 ; Exibe mensagem para pressionar tecla
   3216	098B  BD 0BE2r			 mov bp, offset	press_key_msg
   3217	098E  B9 001B			 mov cx, press_key_msg_length ;	tamanho	correto
   3218	0991  B3 0F			 mov bl, 0Fh	 ; cor branca
   3219	0993  BA 1680			 mov dx, 320*18	; linha	18, coluna 8 (centralizado)
   3220	0996  E8 F739			 call PRINT_STRING
   3221					 ; Aguarda tecla
   3222	0999  E8 000C			 call WAIT_KEY
   3223	099C  E8 0009			 call WAIT_KEY
   3224	099F  E8 F924			 call CLEAR_SCREEN
   3225	09A2  5E			 pop si
   3226	09A3  5A			 pop dx
   3227	09A4  59			 pop cx
   3228	09A5  5B			 pop bx
   3229	09A6  58			 pop ax
   3230	09A7  C3			 ret
   3231	09A8			     SHOW_VICTORY endp
   3232
   3233				     ;===============================================================================
   3234				     ; WAIT_KEY
   3235				     ;===============================================================================
   3236				     ; Função: Aguarda qualquer tecla	ser pressionada
   3237				     ; Parâmetros de entrada: Nenhum
   3238				     ; Parâmetros de saída: Nenhum
   3239				     ;===============================================================================
   3240	09A8			     WAIT_KEY proc
   3241	09A8  50			 push ax
   3242
   3243	09A9			     WAIT_KEY_LOOP:
   3244	09A9  B4 01			 mov ah, 01h	 ; verifica se há tecla disponível
   3245	09AB  CD 16			 int 16h
   3246	09AD  74 FA			 jz WAIT_KEY_LOOP  ; se	não há tecla,	continua aguardando
   3247
   3248	09AF  B4 00			 mov ah, 00h	 ; lê a tecla
   3249	09B1  CD 16			 int 16h
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 58
MAIN.ASM



   3250
   3251	09B3  58			 pop ax
   3252	09B4  C3			 ret
   3253	09B5			     WAIT_KEY endp
   3254
   3255				     ;===============================================================================
   3256				     ; CHECK_GAME_END
   3257				     ;===============================================================================
   3258				     ; Função: Verifica se o jogo terminou (game over	ou vitória)
   3259				     ; Parâmetros de entrada: Nenhum
   3260				     ; Parâmetros de saída:
   3261				     ;	 - AL: 0 (continua jogando), 1 (game over), 2 (vitória)
   3262				     ;===============================================================================
   3263	09B5			     CHECK_GAME_END proc
   3264	09B5  53			 push bx
   3265
   3266					 ; Verifica se perdeu todas as vidas
   3267	09B6  80 3E 0777r 00		 cmp lives, 0
   3268	09BB  74 0C			 je GAME_OVER_CONDITION
   3269
   3270					 ; Verifica se completou todas as fases	(fase >	3)
   3271	09BD  80 3E 0003r 03		 cmp fase, 3
   3272	09C2  77 0A			 ja VICTORY_CONDITION
   3273
   3274					 ; Jogo	continua
   3275	09C4  B0 00			 mov al, 0
   3276	09C6  EB 08 90			 jmp END_CHECK
   3277
   3278	09C9			     GAME_OVER_CONDITION:
   3279	09C9  B0 01			 mov al, 1
   3280	09CB  EB 03 90			 jmp END_CHECK
   3281
   3282	09CE			     VICTORY_CONDITION:
   3283	09CE  B0 02			 mov al, 2
   3284
   3285	09D0			     END_CHECK:
   3286	09D0  5B			 pop bx
   3287	09D1  C3			 ret
   3288	09D2			     CHECK_GAME_END endp
   3289
   3290	09D2			     MOVE_UP_PROC proc
   3291	09D2  57			 push di
   3292	09D3  56			 push si
   3293	09D4  50			 push ax
   3294
   3295					 ; Verifica limites
   3296	09D5  8B 1E 074Dr		 mov bx, [ship_pos]
   3297	09D9  81 FB 192F		 cmp bx, 320 * 20 + 47
   3298	09DD  72 0A			 jb END_UP
   3299
   3300					 ; Move	a nave
   3301	09DF  B0 01			 mov al, 1
   3302	09E1  B4 01			 mov ah, 1
   3303	09E3  BB 0005			 mov bx, ship_speed
   3304	09E6  E8 FB26			 call MOVE_SPRITE
   3305
   3306
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 59
MAIN.ASM



   3307	09E9			     END_UP:
   3308	09E9  58			 pop ax
   3309	09EA  5E			 pop si
   3310	09EB  5F			 pop di
   3311	09EC  C3			 ret
   3312	09ED			     endp
   3313
   3314	09ED			     MOVE_DOWN_PROC proc
   3315	09ED  57			 push di
   3316	09EE  56			 push si
   3317	09EF  50			 push ax
   3318
   3319					 ; Verifica limites (até linha	135, deixando espaço antes do terreno)
   3320	09F0  8B 1E 074Dr		 mov bx, [ship_pos]
   3321	09F4  81 FB A8C0		 cmp bx, 320 * 135
   3322	09F8  73 0A			 jae END_DOWN
   3323
   3324					 ; Move	a nave
   3325	09FA  B0 01			 mov al, 1
   3326	09FC  32 E4			 xor ah, ah
   3327	09FE  BB 0005			 mov bx, ship_speed
   3328	0A01  E8 FB0B			 call MOVE_SPRITE
   3329
   3330
   3331	0A04			     END_DOWN:
   3332	0A04  58			 pop ax
   3333	0A05  5E			 pop si
   3334	0A06  5F			 pop di
   3335	0A07  C3			 ret
   3336	0A08			     endp
   3337
   3338	0A08			     MOVE_LEFT_PROC proc
   3339					 ; Entradas:
   3340					 ;   BX	= ponteiro para	posição (ex.:	OFFSET ship_pos)
   3341					 ;   CX	= velocidade (ex.: ship_speed)
   3342					 ;   DX	= limite esquerdo (ex.:	4)
   3343	0A08  57			 push di
   3344	0A09  56			 push si
   3345	0A0A  50			 push ax
   3346	0A0B  52			 push dx
   3347	0A0C  51			 push cx
   3348	0A0D  55			 push bp
   3349
   3350	0A0E  8B E9			 mov bp, cx		 ; BP =	velocidade
   3351	0A10  8B FA			 mov di, dx		 ; DI =	limite esquerdo
   3352
   3353					 ; Verifica limites: x = pos % 320
   3354	0A12  8B 07			 mov ax, [bx]		 ; AX =	posição atual
   3355	0A14  33 D2			 xor dx, dx
   3356	0A16  B9 0140			 mov cx, 320
   3357	0A19  F7 F1			 div cx			 ; DX =	coordenada X
   3358
   3359	0A1B  3B D7			 cmp dx, di		 ; compara com limite esquerdo
   3360	0A1D  76 0B			 jbe END_LEFT
   3361
   3362					 ; Move	para a esquerda
   3363	0A1F  8B F3			 mov si, bx		 ; SI =	ponteiro para posição
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 60
MAIN.ASM



   3364	0A21  B4 01			 mov ah, 1		 ; direção negativa (esquerda)
   3365	0A23  8B DD			 mov bx, bp		 ; BX =	velocidade
   3366	0A25  B0 00			 mov al, 0		 ; eixo	X
   3367	0A27  E8 FAE5			 call MOVE_SPRITE
   3368
   3369	0A2A			     END_LEFT:
   3370	0A2A  5D			 pop bp
   3371	0A2B  59			 pop cx
   3372	0A2C  5A			 pop dx
   3373	0A2D  58			 pop ax
   3374	0A2E  5E			 pop si
   3375	0A2F  5F			 pop di
   3376	0A30  C3			 ret
   3377	0A31			     endp
   3378
   3379	0A31			     MOVE_RIGHT_PROC proc
   3380					 ; Entradas:
   3381					 ;   BX	= ponteiro para	posição (ex.:	OFFSET alien_pos)
   3382					 ;   CX	= velocidade (ex.: 1)
   3383					 ;   DX	= limite direito em coordenada X (ex.: 320-SPR_W)
   3384	0A31  57			 push di
   3385	0A32  56			 push si
   3386	0A33  50			 push ax
   3387	0A34  52			 push dx
   3388	0A35  51			 push cx
   3389	0A36  55			 push bp
   3390
   3391	0A37  8B E9			 mov bp, cx		 ; BP =	velocidade
   3392	0A39  8B FA			 mov di, dx		 ; DI =	limite direito
   3393
   3394					 ; Verifica limites: x = pos % 320
   3395	0A3B  8B 07			 mov ax, [bx]		 ; AX =	posição atual
   3396	0A3D  33 D2			 xor dx, dx
   3397	0A3F  B9 0140			 mov cx, 320
   3398	0A42  F7 F1			 div cx			 ; DX =	coordenada X
   3399
   3400	0A44  3B D7			 cmp dx, di		 ; compara com limite direito
   3401	0A46  73 0B			 jae END_RIGHT
   3402
   3403					 ; Move	para a direita
   3404	0A48  8B F3			 mov si, bx		 ; SI =	ponteiro para posição
   3405	0A4A  32 E4			 xor ah, ah		 ; direção positiva (direita)
   3406	0A4C  8B DD			 mov bx, bp		 ; BX =	velocidade
   3407	0A4E  B0 00			 mov al, 0		 ; eixo	X
   3408	0A50  E8 FABC			 call MOVE_SPRITE
   3409
   3410	0A53			     END_RIGHT:
   3411	0A53  5D			 pop bp
   3412	0A54  59			 pop cx
   3413	0A55  5A			 pop dx
   3414	0A56  58			 pop ax
   3415	0A57  5E			 pop si
   3416	0A58  5F			 pop di
   3417	0A59  C3			 ret
   3418	0A5A			     endp
   3419
   3420				     ; ==================== SISTEMA DE ALIENS (PADRÃO K-STAR PATROL) ====================
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 61
MAIN.ASM



   3421
   3422				     ;===============================================================================
   3423				     ; RESET_ALIENS
   3424				     ;===============================================================================
   3425				     ; Função: Reseta	o sistema de aliens/meteoros para estado inicial
   3426				     ; Parâmetros de entrada: Nenhum
   3427				     ; Parâmetros de saída:
   3428				     ;	 - Arrays alien_array_active e alien_array_pos zerados
   3429				     ;	 - alien_spawn_timer resetado
   3430				     ;===============================================================================
   3431	0A5A			     RESET_ALIENS proc
   3432	0A5A  50			 push ax
   3433	0A5B  53			 push bx
   3434	0A5C  51			 push cx
   3435
   3436	0A5D  C7 06 0769r 0000		 mov alien_spawn_timer,	0
   3437
   3438					 ; Quantidade baseada na fase: 4 (fase 1) ou 5 (fases 2	e 3)
   3439	0A63  B9 0004			 mov cx, 4
   3440	0A66  80 3E 0003r 02		 cmp fase, 2
   3441	0A6B  74 0A			 je RESET_ALIENS_5
   3442	0A6D  80 3E 0003r 03		 cmp fase, 3
   3443	0A72  74 03			 je RESET_ALIENS_5
   3444	0A74  EB 04 90			 jmp RESET_ALIENS_START
   3445	0A77			     RESET_ALIENS_5:
   3446	0A77  B9 0005			 mov cx, 5
   3447	0A7A			     RESET_ALIENS_START:
   3448	0A7A  33 DB			 xor bx, bx
   3449
   3450	0A7C			     RESET_ALIENS_LOOP:
   3451	0A7C  C6 87 0764r 00		 mov byte ptr [alien_array_active + bx], 0
   3452	0A81  D1 E3			 shl bx, 1
   3453	0A83  C7 87 075Ar 0000		 mov word ptr [alien_array_pos + bx], 0
   3454	0A89  D1 EB			 shr bx, 1
   3455	0A8B  43			 inc bx
   3456	0A8C  49			 dec cx
   3457	0A8D  75 ED			 jnz RESET_ALIENS_LOOP
   3458
   3459					 ; Força spawn	imediato de 1 alien para teste
   3460	0A8F  E8 00BC			 call SPAWN_ALIEN
   3461
   3462	0A92  59			 pop cx
   3463	0A93  5B			 pop bx
   3464	0A94  58			 pop ax
   3465	0A95  C3			 ret
   3466	0A96			     endp
   3467
   3468				     ;===============================================================================
   3469				     ; UPDATE_ALIENS
   3470				     ;===============================================================================
   3471				     ; Função: Atualiza movimento e spawn de aliens/meteoros
   3472				     ; Parâmetros de entrada: Nenhum
   3473				     ; Parâmetros de saída:
   3474				     ;	 - Atualiza posições,	spawna novos aliens, verifica colisões
   3475				     ;===============================================================================
   3476	0A96			     UPDATE_ALIENS proc
   3477	0A96  50			 push ax
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 62
MAIN.ASM



   3478	0A97  53			 push bx
   3479	0A98  51			 push cx
   3480	0A99  52			 push dx
   3481
   3482					 ; Incrementa timer
   3483	0A9A  FF 06 0769r		 inc alien_spawn_timer
   3484
   3485					 ; Verifica spawn (delay baseado na fase)
   3486	0A9E  A1 0769r			 mov ax, alien_spawn_timer
   3487	0AA1  8B 16 076Br		 mov dx, alien_spawn_delay
   3488	0AA5  80 3E 0003r 02		 cmp fase, 2
   3489	0AAA  74 0A			 je USE_FASE2_DELAY
   3490	0AAC  80 3E 0003r 03		 cmp fase, 3
   3491	0AB1  74 0A			 je USE_FASE3_DELAY
   3492	0AB3  EB 0C 90			 jmp USE_NORMAL_DELAY
   3493	0AB6			     USE_FASE2_DELAY:
   3494	0AB6  8B 16 0771r		 mov dx, meteor_spawn_delay  ; Fase 2: spawn meteoros
   3495	0ABA  EB 05 90			 jmp USE_NORMAL_DELAY
   3496	0ABD			     USE_FASE3_DELAY:
   3497	0ABD  8B 16 0775r		 mov dx, alien_fase3_spawn_delay  ; Fase 3: spawn mais rápido
   3498	0AC1			     USE_NORMAL_DELAY:
   3499	0AC1  3B C2			 cmp ax, dx
   3500	0AC3  72 09			 jb UPDATE_EXISTING_ALIENS
   3501
   3502					 ; Reset timer e spawna
   3503	0AC5  C7 06 0769r 0000		 mov alien_spawn_timer,	0
   3504	0ACB  E8 0080			 call SPAWN_ALIEN
   3505
   3506	0ACE			     UPDATE_EXISTING_ALIENS:
   3507					 ; Move	aliens/meteoros	existentes
   3508					 ; Quantidade baseada na fase: 4 (fase 1) ou 5 (fases 2	e 3)
   3509	0ACE  B9 0004			 mov cx, 4
   3510	0AD1  80 3E 0003r 02		 cmp fase, 2
   3511	0AD6  74 0A			 je UPDATE_ALIENS_5
   3512	0AD8  80 3E 0003r 03		 cmp fase, 3
   3513	0ADD  74 03			 je UPDATE_ALIENS_5
   3514	0ADF  EB 04 90			 jmp UPDATE_ALIENS_START
   3515	0AE2			     UPDATE_ALIENS_5:
   3516	0AE2  B9 0005			 mov cx, 5
   3517	0AE5			     UPDATE_ALIENS_START:
   3518	0AE5  33 DB			 xor bx, bx
   3519
   3520	0AE7			     UPDATE_ALIENS_LOOP:
   3521	0AE7  80 BF 0764r 00		 cmp byte ptr [alien_array_active + bx], 0
   3522	0AEC  74 57			 je NEXT_UPDATE_ALIEN
   3523
   3524					 ; Pega	posição do alien (BX * 2 para	word array)
   3525	0AEE  53			 push bx
   3526	0AEF  D1 E3			 shl bx, 1
   3527	0AF1  8B 87 075Ar		 mov ax, word ptr [alien_array_pos + bx]
   3528	0AF5  5B			 pop bx
   3529
   3530					 ; Verifica se X >= 2 para evitar underflow
   3531	0AF6  50			 push ax
   3532	0AF7  53			 push bx
   3533	0AF8  33 D2			 xor dx, dx
   3534	0AFA  BB 0140			 mov bx, 320
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 63
MAIN.ASM



   3535	0AFD  F7 F3			 div bx		     ; ax = y, dx = x
   3536	0AFF  5B			 pop bx
   3537
   3538	0B00  83 FA 02			 cmp dx, 2
   3539	0B03  58			 pop ax		     ; recupera	posição original
   3540	0B04  72 2F			 jb REMOVE_ALIEN
   3541
   3542					 ; Move	para esquerda (velocidade baseada na fase)
   3543	0B06  53			 push bx
   3544	0B07  8B 1E 076Dr		 mov bx, alien_move_speed
   3545	0B0B  80 3E 0003r 02		 cmp fase, 2
   3546	0B10  74 0A			 je USE_FASE2_SPEED
   3547	0B12  80 3E 0003r 03		 cmp fase, 3
   3548	0B17  74 0A			 je USE_FASE3_SPEED
   3549	0B19  EB 0C 90			 jmp USE_NORMAL_SPEED
   3550	0B1C			     USE_FASE2_SPEED:
   3551	0B1C  8B 1E 076Fr		 mov bx, meteor_move_speed  ; Fase 2: meteoros
   3552	0B20  EB 05 90			 jmp USE_NORMAL_SPEED
   3553	0B23			     USE_FASE3_SPEED:
   3554	0B23  8B 1E 0773r		 mov bx, alien_fase3_move_speed	 ; Fase	3: aliens mais rápidos
   3555	0B27			     USE_NORMAL_SPEED:
   3556	0B27  2B C3			 sub ax, bx
   3557	0B29  5B			 pop bx
   3558
   3559	0B2A  53			 push bx
   3560	0B2B  D1 E3			 shl bx, 1
   3561	0B2D  89 87 075Ar		 mov word ptr [alien_array_pos + bx], ax
   3562	0B31  5B			 pop bx
   3563	0B32  EB 11 90			 jmp NEXT_UPDATE_ALIEN
   3564
   3565	0B35			     REMOVE_ALIEN:
   3566					 ; Limpa sprite	do alien antes de desativar
   3567	0B35  53			 push bx
   3568	0B36  D1 E3			 shl bx, 1
   3569	0B38  8B BF 075Ar		 mov di, word ptr [alien_array_pos + bx]
   3570	0B3C  E8 F5F7			 call CLEAR_SPRITE
   3571	0B3F  5B			 pop bx
   3572
   3573	0B40  C6 87 0764r 00		 mov byte ptr [alien_array_active + bx], 0
   3574
   3575	0B45			     NEXT_UPDATE_ALIEN:
   3576	0B45  43			 inc bx
   3577	0B46  49			 dec cx
   3578	0B47  75 9E			 jnz UPDATE_ALIENS_LOOP
   3579
   3580	0B49  5A			 pop dx
   3581	0B4A  59			 pop cx
   3582	0B4B  5B			 pop bx
   3583	0B4C  58			 pop ax
   3584	0B4D  C3			 ret
   3585	0B4E			     endp
   3586
   3587				     ;===============================================================================
   3588				     ; SPAWN_ALIEN
   3589				     ;===============================================================================
   3590				     ; Função: Spawna	um novo	alien/meteoro em posição aleatória
   3591				     ; Parâmetros de entrada:
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 64
MAIN.ASM



   3592				     ;	 - fase	(variável global): determina tipo e quantidade
   3593				     ; Parâmetros de saída:
   3594				     ;	 - Novo	alien criado em	slot disponível (se houver)
   3595				     ;===============================================================================
   3596	0B4E			     SPAWN_ALIEN proc
   3597	0B4E  50			 push ax
   3598	0B4F  53			 push bx
   3599	0B50  51			 push cx
   3600	0B51  52			 push dx
   3601
   3602					 ; Procura slot	livre (quantidade baseada na fase: 4 (fase 1) ou 5 (fases 2 e 3))
   3603	0B52  B9 0004			 mov cx, 4
   3604	0B55  80 3E 0003r 02		 cmp fase, 2
   3605	0B5A  74 0A			 je SPAWN_ALIEN_5
   3606	0B5C  80 3E 0003r 03		 cmp fase, 3
   3607	0B61  74 03			 je SPAWN_ALIEN_5
   3608	0B63  EB 04 90			 jmp SPAWN_ALIEN_START
   3609	0B66			     SPAWN_ALIEN_5:
   3610	0B66  B9 0005			 mov cx, 5
   3611	0B69			     SPAWN_ALIEN_START:
   3612	0B69  33 DB			 xor bx, bx
   3613
   3614	0B6B			     FIND_SLOT:
   3615	0B6B  80 BF 0764r 00		 cmp byte ptr [alien_array_active + bx], 0
   3616	0B70  74 07			 je FOUND_SLOT
   3617	0B72  43			 inc bx
   3618	0B73  49			 dec cx
   3619	0B74  75 F5			 jnz FIND_SLOT
   3620	0B76  EB 39 90			 jmp END_SPAWN
   3621
   3622	0B79			     FOUND_SLOT:
   3623					 ; BX contém o	índice	do slot	livre (0-3)
   3624	0B79  53			 push bx	     ; Salva índice do	slot
   3625
   3626					 ; Gera	Y aleatório baseado na	fase
   3627	0B7A  E8 F5A9			 call RANDOM_UINT16
   3628	0B7D  33 D2			 xor dx, dx	     ; Zera DX para divisão
   3629
   3630					 ; Fase	3: espaço vertical seguro (linha 25-60)
   3631					 ; HUD está nas linhas	0-20, torres começam em Y~78
   3632					 ; Aliens devem	ficar entre a HUD e as torres
   3633	0B7F  80 3E 0003r 03		 cmp fase, 3
   3634	0B84  75 0D			 jne SPAWN_ALIEN_NORMAL_Y
   3635	0B86  B9 0024			 mov cx, 36	     ; Divisor para fase 3 (36 linhas de espaço)
   3636	0B89  F7 F1			 div cx		     ; AX / CX,	resto em DX
   3637	0B8B  8B C2			 mov ax, dx	     ; Usa resto (0-35)
   3638	0B8D  05 0019			 add ax, 25	     ; Y entre 25-60 (área segura)
   3639	0B90  EB 0B 90			 jmp SPAWN_ALIEN_CALC_POS
   3640
   3641	0B93			     SPAWN_ALIEN_NORMAL_Y:
   3642					 ; Fases 1 e 2:	Y entre	20-130
   3643	0B93  B9 006E			 mov cx, 110	     ; Divisor em CX
   3644	0B96  F7 F1			 div cx		     ; AX / CX,	resto em DX
   3645	0B98  8B C2			 mov ax, dx	     ; Usa resto (0-109)
   3646	0B9A  05 0014			 add ax, 20	     ; Y entre 20-129
   3647
   3648	0B9D			     SPAWN_ALIEN_CALC_POS:
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 65
MAIN.ASM



   3649
   3650					 ; Calcula posição: Y*320 + X
   3651					 ; X = 298 (320	- 22 = 298, garante sprite dentro da tela)
   3652	0B9D  B9 0140			 mov cx, 320
   3653	0BA0  F7 E1			 mul cx		     ; AX = Y *	320, resultado em DX:AX
   3654	0BA2  05 012A			 add ax, 298	     ; Adiciona	X=298 (lado direito, sprite completo visível)
   3655
   3656					 ; Ativa alien
   3657	0BA5  5B			 pop bx		     ; Recupera	índice	do slot
   3658	0BA6  C6 87 0764r 01		 mov byte ptr [alien_array_active + bx], 1
   3659	0BAB  D1 E3			 shl bx, 1	     ; BX *= 2 para word array
   3660	0BAD  89 87 075Ar		 mov word ptr [alien_array_pos + bx], ax
   3661
   3662	0BB1			     END_SPAWN:
   3663	0BB1  5A			 pop dx
   3664	0BB2  59			 pop cx
   3665	0BB3  5B			 pop bx
   3666	0BB4  58			 pop ax
   3667	0BB5  C3			 ret
   3668	0BB6			     endp
   3669
   3670				     ; Verifica	sobreposição entre aliens
   3671				     ; Entrada:	AX = Y do novo alien
   3672				     ; Retorna:	AL = 1 se há sobreposição, 0	caso contrário
   3673	0BB6			     CHECK_ALIEN_OVERLAP proc
   3674	0BB6  53			 push bx
   3675	0BB7  51			 push cx
   3676	0BB8  52			 push dx
   3677	0BB9  56			 push si
   3678
   3679	0BBA  8B F0			 mov si, ax	     ; SI = Y do novo alien
   3680	0BBC  B9 0004			 mov cx, 4
   3681	0BBF  33 DB			 xor bx, bx
   3682
   3683	0BC1			     CHECK_OVERLAP_LOOP:
   3684	0BC1  80 BF 0764r 00		 cmp byte ptr [alien_array_active + bx], 0
   3685	0BC6  74 1F			 je NEXT_CHECK_OVERLAP
   3686
   3687					 ; Calcula Y do	alien existente
   3688	0BC8  53			 push bx
   3689	0BC9  D1 E3			 shl bx, 1
   3690	0BCB  8B 87 075Ar		 mov ax, word ptr [alien_array_pos + bx]
   3691	0BCF  5B			 pop bx
   3692
   3693	0BD0  53			 push bx
   3694	0BD1  BB 0140			 mov bx, 320
   3695	0BD4  33 D2			 xor dx, dx
   3696	0BD6  F7 F3			 div bx		     ; ax = y
   3697	0BD8  5B			 pop bx
   3698
   3699					 ; Verifica distância
   3700	0BD9  2B C6			 sub ax, si
   3701	0BDB  3D 0000			 cmp ax, 0
   3702	0BDE  7D 02			 jge POSITIVE_DIST
   3703	0BE0  F7 D8			 neg ax
   3704	0BE2			     POSITIVE_DIST:
   3705	0BE2  3D 0019			 cmp ax, 25
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 66
MAIN.ASM



   3706	0BE5  72 09			 jb OVERLAP_FOUND
   3707
   3708	0BE7			     NEXT_CHECK_OVERLAP:
   3709	0BE7  43			 inc bx
   3710	0BE8  49			 dec cx
   3711	0BE9  75 D6			 jnz CHECK_OVERLAP_LOOP
   3712
   3713	0BEB  B0 00			 mov al, 0
   3714	0BED  EB 03 90			 jmp END_CHECK_OVERLAP
   3715
   3716	0BF0			     OVERLAP_FOUND:
   3717	0BF0  B0 01			 mov al, 1
   3718
   3719	0BF2			     END_CHECK_OVERLAP:
   3720	0BF2  5E			 pop si
   3721	0BF3  5A			 pop dx
   3722	0BF4  59			 pop cx
   3723	0BF5  5B			 pop bx
   3724	0BF6  C3			 ret
   3725	0BF7			     endp
   3726
   3727				     ; Renderiza aliens/meteoros
   3728	0BF7			     RENDER_ALIENS proc
   3729	0BF7  50			 push ax
   3730	0BF8  53			 push bx
   3731	0BF9  51			 push cx
   3732	0BFA  56			 push si
   3733
   3734					 ; Quantidade baseada na fase: 4 (fase 1) ou 5 (fases 2	e 3)
   3735	0BFB  B9 0004			 mov cx, 4
   3736	0BFE  80 3E 0003r 02		 cmp fase, 2
   3737	0C03  74 0A			 je RENDER_ALIENS_5
   3738	0C05  80 3E 0003r 03		 cmp fase, 3
   3739	0C0A  74 03			 je RENDER_ALIENS_5
   3740	0C0C  EB 04 90			 jmp RENDER_ALIENS_START
   3741	0C0F			     RENDER_ALIENS_5:
   3742	0C0F  B9 0005			 mov cx, 5
   3743	0C12			     RENDER_ALIENS_START:
   3744	0C12  33 DB			 xor bx, bx
   3745
   3746	0C14			     RENDER_ALIENS_LOOP:
   3747	0C14  80 BF 0764r 00		 cmp byte ptr [alien_array_active + bx], 0
   3748	0C19  74 1B			 je NEXT_RENDER_ALIEN
   3749
   3750	0C1B  53			 push bx
   3751	0C1C  D1 E3			 shl bx, 1
   3752	0C1E  8B 87 075Ar		 mov ax, word ptr [alien_array_pos + bx]
   3753	0C22  5B			 pop bx
   3754
   3755					 ; Escolhe sprite baseado na fase
   3756	0C23  80 3E 0003r 02		 cmp fase, 2
   3757	0C28  74 06			 je USE_METEOR_SPRITE
   3758					 ; Fases 1 e 3 usam alien sprite
   3759	0C2A  BE 034Er			 mov si, offset	alien_sprite
   3760	0C2D  EB 04 90			 jmp DRAW_ENEMY
   3761	0C30			     USE_METEOR_SPRITE:
   3762	0C30  BE 016Er			 mov si, offset	meteor_sprite
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 67
MAIN.ASM



   3763	0C33			     DRAW_ENEMY:
   3764	0C33  E8 F4C4			 call RENDER_SPRITE
   3765
   3766	0C36			     NEXT_RENDER_ALIEN:
   3767	0C36  43			 inc bx
   3768	0C37  49			 dec cx
   3769	0C38  75 DA			 jnz RENDER_ALIENS_LOOP
   3770
   3771	0C3A  5E			 pop si
   3772	0C3B  59			 pop cx
   3773	0C3C  5B			 pop bx
   3774	0C3D  58			 pop ax
   3775	0C3E  C3			 ret
   3776	0C3F			     endp
   3777
   3778				     ; Verifica	colisões tiros	vs aliens/meteoros
   3779	0C3F			     CHECK_ALIEN_SHOT_COLLISION	proc
   3780	0C3F  50			 push ax
   3781	0C40  53			 push bx
   3782	0C41  51			 push cx
   3783	0C42  52			 push dx
   3784	0C43  56			 push si
   3785	0C44  57			 push di
   3786
   3787					 ; Quantidade baseada na fase: 4 (fase 1) ou 5 (fases 2	e 3)
   3788	0C45  B9 0004			 mov cx, 4
   3789	0C48  80 3E 0003r 02		 cmp fase, 2
   3790	0C4D  74 0A			 je CHECK_SHOT_COLLISION_5
   3791	0C4F  80 3E 0003r 03		 cmp fase, 3
   3792	0C54  74 03			 je CHECK_SHOT_COLLISION_5
   3793	0C56  EB 04 90			 jmp CHECK_SHOT_COLLISION_START
   3794	0C59			     CHECK_SHOT_COLLISION_5:
   3795	0C59  B9 0005			 mov cx, 5
   3796	0C5C			     CHECK_SHOT_COLLISION_START:
   3797	0C5C  33 DB			 xor bx, bx
   3798
   3799	0C5E			     CHECK_COLLISION_ALIEN_LOOP:
   3800	0C5E  80 BF 0764r 00		 cmp byte ptr [alien_array_active + bx], 0
   3801	0C63  75 03			 jne CHECK_ALIEN_ACTIVE
   3802	0C65  EB 45 90			 jmp NEXT_COLLISION_ALIEN
   3803	0C68			     CHECK_ALIEN_ACTIVE:
   3804
   3805					 ; Posição do	alien
   3806	0C68  53			 push bx
   3807	0C69  D1 E3			 shl bx, 1
   3808	0C6B  8B BF 075Ar		 mov di, word ptr [alien_array_pos + bx]
   3809	0C6F  5B			 pop bx
   3810
   3811					 ; Verifica cada tiro
   3812	0C70  51			 push cx
   3813	0C71  53			 push bx
   3814
   3815	0C72  8A 0E 074Fr		 mov cl, shot_count
   3816	0C76  32 ED			 xor ch, ch
   3817	0C78  33 F6			 xor si, si
   3818
   3819	0C7A			     CHECK_COLLISION_SHOT_LOOP:
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 68
MAIN.ASM



   3820	0C7A  80 BC 0756r 00		 cmp byte ptr [shot_active + si], 0
   3821	0C7F  74 24			 je NEXT_COLLISION_SHOT
   3822
   3823					 ; Posição do	tiro
   3824	0C81  56			 push si
   3825	0C82  D1 E6			 shl si, 1
   3826	0C84  8B 84 0750r		 mov ax, word ptr [shot_pos + si]
   3827	0C88  5E			 pop si
   3828
   3829					 ; Verifica colisão
   3830	0C89  E8 00D7			 call CHECK_COLLISION_XY
   3831	0C8C  3C 01			 cmp al, 1
   3832	0C8E  75 15			 jne NEXT_COLLISION_SHOT
   3833
   3834					 ; Colisão detectada! Chama handler apropriado
   3835	0C90  80 3E 0003r 02		 cmp fase, 2
   3836	0C95  74 06			 je CALL_METEOR_HIT
   3837	0C97  E8 0020			 call HANDLE_ALIEN_DESTROYED
   3838	0C9A  EB 04 90			 jmp END_COLLISION_CHECK
   3839	0C9D			     CALL_METEOR_HIT:
   3840	0C9D  E8 0058			 call HANDLE_METEOR_HIT
   3841	0CA0			     END_COLLISION_CHECK:
   3842	0CA0  5B			 pop bx
   3843	0CA1  59			 pop cx
   3844	0CA2  EB 08 90			 jmp NEXT_COLLISION_ALIEN
   3845
   3846	0CA5			     NEXT_COLLISION_SHOT:
   3847	0CA5  46			 inc si
   3848	0CA6  FE C9			 dec cl
   3849	0CA8  75 D0			 jnz CHECK_COLLISION_SHOT_LOOP
   3850
   3851	0CAA  5B			 pop bx
   3852	0CAB  59			 pop cx
   3853
   3854	0CAC			     NEXT_COLLISION_ALIEN:
   3855	0CAC  43			 inc bx
   3856	0CAD  49			 dec cx
   3857	0CAE  83 F9 00			 cmp cx, 0
   3858	0CB1  75 AB			 jne CHECK_COLLISION_ALIEN_LOOP
   3859
   3860	0CB3  5F			 pop di
   3861	0CB4  5E			 pop si
   3862	0CB5  5A			 pop dx
   3863	0CB6  59			 pop cx
   3864	0CB7  5B			 pop bx
   3865	0CB8  58			 pop ax
   3866	0CB9  C3			 ret
   3867	0CBA			     endp
   3868
   3869				     ; Handler para alien destruído (fases 1 e	3)
   3870				     ; Entrada:	BX = índice do	alien, SI = índice do tiro
   3871	0CBA			     HANDLE_ALIEN_DESTROYED proc
   3872	0CBA  50			 push ax
   3873	0CBB  53			 push bx
   3874	0CBC  56			 push si
   3875	0CBD  57			 push di
   3876
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 69
MAIN.ASM



   3877					 ; Limpa sprite	do alien
   3878	0CBE  53			 push bx
   3879	0CBF  D1 E3			 shl bx, 1
   3880	0CC1  8B BF 075Ar		 mov di, word ptr [alien_array_pos + bx]
   3881	0CC5  E8 F46E			 call CLEAR_SPRITE
   3882	0CC8  5B			 pop bx
   3883
   3884					 ; Limpa sprite	do tiro
   3885	0CC9  56			 push si
   3886	0CCA  D1 E6			 shl si, 1
   3887	0CCC  8B BC 0750r		 mov di, word ptr [shot_pos + si]
   3888	0CD0  E8 F99E			 call CLEAR_SHOT_SPRITE
   3889	0CD3  5E			 pop si
   3890
   3891					 ; Desativa alien e tiro
   3892	0CD4  C6 87 0764r 00		 mov byte ptr [alien_array_active + bx], 0
   3893	0CD9  C6 84 0756r 00		 mov byte ptr [shot_active + si], 0
   3894
   3895					 ; Pontuação:	100 (fase 1) ou	150 (fase 3)
   3896	0CDE  80 3E 0003r 03		 cmp fase, 3
   3897	0CE3  74 08			 je ALIEN_SCORE_150
   3898	0CE5  83 06 0C15r 64		 add score, 100
   3899	0CEA  EB 07 90			 jmp END_ALIEN_SCORE
   3900	0CED			     ALIEN_SCORE_150:
   3901	0CED  81 06 0C15r 0096		 add score, 150
   3902	0CF3			     END_ALIEN_SCORE:
   3903
   3904	0CF3  5F			 pop di
   3905	0CF4  5E			 pop si
   3906	0CF5  5B			 pop bx
   3907	0CF6  58			 pop ax
   3908	0CF7  C3			 ret
   3909	0CF8			     endp
   3910
   3911				     ; Handler para meteoro atingido (fase 2)
   3912				     ; Entrada:	SI = índice do	tiro
   3913	0CF8			     HANDLE_METEOR_HIT proc
   3914	0CF8  56			 push si
   3915	0CF9  57			 push di
   3916
   3917					 ; Limpa sprite	do tiro	apenas
   3918	0CFA  56			 push si
   3919	0CFB  D1 E6			 shl si, 1
   3920	0CFD  8B BC 0750r		 mov di, word ptr [shot_pos + si]
   3921	0D01  E8 F96D			 call CLEAR_SHOT_SPRITE
   3922	0D04  5E			 pop si
   3923
   3924					 ; Desativa tiro (meteoro continua ativo)
   3925	0D05  C6 84 0756r 00		 mov byte ptr [shot_active + si], 0
   3926
   3927	0D0A  5F			 pop di
   3928	0D0B  5E			 pop si
   3929	0D0C  C3			 ret
   3930	0D0D			     endp
   3931
   3932				     ; Verifica	colisões nave vs aliens/meteoros
   3933	0D0D			     CHECK_ALIEN_SHIP_COLLISION	proc
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 70
MAIN.ASM



   3934	0D0D  50			 push ax
   3935	0D0E  53			 push bx
   3936	0D0F  51			 push cx
   3937	0D10  57			 push di
   3938
   3939					 ; Quantidade baseada na fase: 4 (fase 1) ou 5 (fases 2	e 3)
   3940	0D11  B9 0004			 mov cx, 4
   3941	0D14  80 3E 0003r 02		 cmp fase, 2
   3942	0D19  74 0A			 je CHECK_SHIP_COLLISION_5
   3943	0D1B  80 3E 0003r 03		 cmp fase, 3
   3944	0D20  74 03			 je CHECK_SHIP_COLLISION_5
   3945	0D22  EB 04 90			 jmp CHECK_SHIP_COLLISION_START
   3946	0D25			     CHECK_SHIP_COLLISION_5:
   3947	0D25  B9 0005			 mov cx, 5
   3948	0D28			     CHECK_SHIP_COLLISION_START:
   3949	0D28  33 DB			 xor bx, bx
   3950
   3951	0D2A			     CHECK_SHIP_COLLISION_LOOP:
   3952	0D2A  80 BF 0764r 00		 cmp byte ptr [alien_array_active + bx], 0
   3953	0D2F  74 29			 je NEXT_SHIP_COLLISION
   3954
   3955					 ; Posição do	alien
   3956	0D31  53			 push bx
   3957	0D32  D1 E3			 shl bx, 1
   3958	0D34  8B BF 075Ar		 mov di, word ptr [alien_array_pos + bx]
   3959	0D38  5B			 pop bx
   3960
   3961					 ; Posição da	nave
   3962	0D39  A1 074Dr			 mov ax, ship_pos
   3963
   3964					 ; Verifica colisão
   3965	0D3C  E8 0024			 call CHECK_COLLISION_XY
   3966	0D3F  3C 01			 cmp al, 1
   3967	0D41  75 17			 jne NEXT_SHIP_COLLISION
   3968
   3969					 ; Colisão! Perde vida
   3970					 ; Limpa sprite	do alien da tela
   3971	0D43  53			 push bx
   3972	0D44  D1 E3			 shl bx, 1
   3973	0D46  8B BF 075Ar		 mov di, word ptr [alien_array_pos + bx]
   3974	0D4A  E8 F3E9			 call CLEAR_SPRITE
   3975	0D4D  5B			 pop bx
   3976
   3977	0D4E  C6 87 0764r 00		 mov byte ptr [alien_array_active + bx], 0
   3978	0D53  FE 0E 0777r		 dec lives
   3979
   3980					 ; Atualiza exibição de vidas	na tela
   3981	0D57  E8 F669			 call RENDER_LIVES
   3982
   3983	0D5A			     NEXT_SHIP_COLLISION:
   3984	0D5A  43			 inc bx
   3985	0D5B  49			 dec cx
   3986	0D5C  75 CC			 jnz CHECK_SHIP_COLLISION_LOOP
   3987
   3988	0D5E  5F			 pop di
   3989	0D5F  59			 pop cx
   3990	0D60  5B			 pop bx
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 71
MAIN.ASM



   3991	0D61  58			 pop ax
   3992	0D62  C3			 ret
   3993	0D63			     endp
   3994
   3995				     ; Verifica	colisão entre dois objetos
   3996				     ; Entrada:	AX = posição 1, DI = posição 2
   3997				     ; Retorna:	AL = 1 se colidiu, 0 caso contrário
   3998	0D63			     CHECK_COLLISION_XY	proc
   3999	0D63  53			 push bx
   4000	0D64  51			 push cx
   4001	0D65  52			 push dx
   4002	0D66  56			 push si
   4003
   4004					 ; Calcula X,Y do objeto 1
   4005	0D67  BB 0140			 mov bx, 320
   4006	0D6A  33 D2			 xor dx, dx
   4007	0D6C  F7 F3			 div bx		     ; ax = y1,	dx = x1
   4008	0D6E  8B C8			 mov cx, ax	     ; cx = y1
   4009	0D70  8B F2			 mov si, dx	     ; si = x1
   4010
   4011					 ; Calcula X,Y do objeto 2
   4012	0D72  8B C7			 mov ax, di
   4013	0D74  33 D2			 xor dx, dx
   4014	0D76  F7 F3			 div bx		     ; ax = y2,	dx = x2
   4015
   4016					 ; Distância X
   4017	0D78  2B F2			 sub si, dx
   4018	0D7A  83 FE 00			 cmp si, 0
   4019	0D7D  7D 02			 jge ABS_X
   4020	0D7F  F7 DE			 neg si
   4021	0D81			     ABS_X:
   4022	0D81  83 FE 14			 cmp si, 20
   4023	0D84  77 13			 ja NO_COLLISION_XY
   4024
   4025					 ; Distância Y
   4026	0D86  2B C8			 sub cx, ax
   4027	0D88  83 F9 00			 cmp cx, 0
   4028	0D8B  7D 02			 jge ABS_Y
   4029	0D8D  F7 D9			 neg cx
   4030	0D8F			     ABS_Y:
   4031	0D8F  83 F9 0F			 cmp cx, 15
   4032	0D92  77 05			 ja NO_COLLISION_XY
   4033
   4034	0D94  B0 01			 mov al, 1
   4035	0D96  EB 03 90			 jmp END_COLLISION_XY
   4036
   4037	0D99			     NO_COLLISION_XY:
   4038	0D99  B0 00			 mov al, 0
   4039
   4040	0D9B			     END_COLLISION_XY:
   4041	0D9B  5E			 pop si
   4042	0D9C  5A			 pop dx
   4043	0D9D  59			 pop cx
   4044	0D9E  5B			 pop bx
   4045	0D9F  C3			 ret
   4046	0DA0			     endp
   4047
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 72
MAIN.ASM



   4048				     end MAIN
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 73
Symbol Table




Symbol Name			  Type	 Value

??DATE				  Text	 "12/05/25"
??FILENAME			  Text	 "MAIN	  "
??TIME				  Text	 "16:32:08"
??VERSION			  Number 040A
@32BIT				  Text	 0
@CODE				  Text	 _TEXT
@CODESIZE			  Text	 0
@CPU				  Text	 0101H
@CURSEG				  Text	 _TEXT
@DATA				  Text	 DGROUP
@DATASIZE			  Text	 0
@FILENAME			  Text	 MAIN
@INTERFACE			  Text	 000H
@MODEL				  Text	 2
@STACK				  Text	 DGROUP
@WORDSIZE			  Text	 2
ABS_X				  Near	 _TEXT:0D81
ABS_Y				  Near	 _TEXT:0D8F
ALE				  Word	 DGROUP:0000
ALIEN_ARRAY_ACTIVE		  Byte	 DGROUP:0764
ALIEN_ARRAY_POS			  Word	 DGROUP:075A
ALIEN_COUNT			  Byte	 DGROUP:0759
ALIEN_DIR			  Byte	 DGROUP:0547
ALIEN_FASE3_MOVE_SPEED		  Word	 DGROUP:0773
ALIEN_FASE3_SPAWN_DELAY		  Word	 DGROUP:0775
ALIEN_MOVE_SPEED		  Word	 DGROUP:076D
ALIEN_POS			  Word	 DGROUP:0545
ALIEN_SCORE_150			  Near	 _TEXT:0CED
ALIEN_SPAWN_DELAY		  Word	 DGROUP:076B
ALIEN_SPAWN_TIMER		  Word	 DGROUP:0769
ALIEN_SPRITE			  Byte	 DGROUP:034E
ARROW_DOWN			  Near	 _TEXT:02AF
ARROW_UP			  Near	 _TEXT:02A6
BASE				  Byte	 DGROUP:A2F9
BASE_HEIGHT			  Number 0008
BASE_WIDTH			  Number 0022
BOUNCE_LEFT			  Near	 _TEXT:01ED
BOUNCE_RIGHT			  Near	 _TEXT:01F2
BTN_INICIAR			  Byte	 DGROUP:0004
BTN_INICIAR_LENGTH		  Number 0051
BTN_SAIR			  Byte	 DGROUP:0055
BTN_SAIR_LENGTH			  Number 0051
CALL_METEOR_HIT			  Near	 _TEXT:0C9D
CHECK_ALIEN_ACTIVE		  Near	 _TEXT:0C68
CHECK_ALIEN_OVERLAP		  Near	 _TEXT:0BB6
CHECK_ALIEN_SHIP_COLLISION	  Near	 _TEXT:0D0D
CHECK_ALIEN_SHOT_COLLISION	  Near	 _TEXT:0C3F
CHECK_COLLISION_ALIEN_LOOP	  Near	 _TEXT:0C5E
CHECK_COLLISION_SHOT_LOOP	  Near	 _TEXT:0C7A
CHECK_COLLISION_XY		  Near	 _TEXT:0D63
CHECK_DIRECTION			  Near	 _TEXT:0524
CHECK_FASE2			  Near	 _TEXT:046F
CHECK_FASE3			  Near	 _TEXT:047C
CHECK_GAME_END			  Near	 _TEXT:09B5
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 74
Symbol Table



CHECK_OVERLAP_LOOP		  Near	 _TEXT:0BC1
CHECK_SHIP_COLLISION_5		  Near	 _TEXT:0D25
CHECK_SHIP_COLLISION_LOOP	  Near	 _TEXT:0D2A
CHECK_SHIP_COLLISION_START	  Near	 _TEXT:0D28
CHECK_SHOT_COLLISION_5		  Near	 _TEXT:0C59
CHECK_SHOT_COLLISION_START	  Near	 _TEXT:0C5C
CLEAR_LEFT_EDGE			  Near	 _TEXT:0701
CLEAR_LINE			  Near	 _TEXT:0142
CLEAR_LIVES_LOOP		  Near	 _TEXT:03CE
CLEAR_SCREEN			  Near	 _TEXT:02C6
CLEAR_SHOT_LINE			  Near	 _TEXT:067D
CLEAR_SHOT_SPRITE		  Near	 _TEXT:0671
CLEAR_SPRITE			  Near	 _TEXT:0136
CLIP_DONE			  Near	 _TEXT:0869
CLIP_RIGHT_CHECK		  Near	 _TEXT:0857
CONVERT_UINT16			  Near	 _TEXT:0370
COPY_TERRAIN_LINE		  Near	 _TEXT:06C3
DEACTIVATE_THIS_SHOT		  Near	 _TEXT:0633
DRAW_ENEMY			  Near	 _TEXT:0C33
DRAW_RIGHT			  Near	 _TEXT:025B
DRAW_SHIP_LINE			  Near	 _TEXT:0112
DRAW_SHOT_LINE			  Near	 _TEXT:065D
DRAW_SPRITE			  Near	 _TEXT:01C1
END_ALIEN_SCORE			  Near	 _TEXT:0CF3
END_CHECK			  Near	 _TEXT:09D0
END_CHECK_OVERLAP		  Near	 _TEXT:0BF2
END_COLLISION_CHECK		  Near	 _TEXT:0CA0
END_COLLISION_XY		  Near	 _TEXT:0D9B
END_CONTROLS			  Near	 _TEXT:0509
END_DOWN			  Near	 _TEXT:0A04
END_GAME			  Near	 _TEXT:02B9
END_HANDLE			  Near	 _TEXT:02B8
END_LEFT			  Near	 _TEXT:0A2A
END_RENDER_LIVES		  Near	 _TEXT:03FE
END_RIGHT			  Near	 _TEXT:0A53
END_SHIP_UPDATE			  Near	 _TEXT:04A0
END_SHOOT			  Near	 _TEXT:05E0
END_SPAWN			  Near	 _TEXT:0BB1
END_TIME			  Near	 _TEXT:048C
END_UP				  Near	 _TEXT:09E9
EXIT_BTN			  Near	 _TEXT:00B4
FASE				  Byte	 DGROUP:0003
FASE1				  Byte	 DGROUP:0778
FASE2				  Byte	 DGROUP:083E
FASE3				  Byte	 DGROUP:0904
FASE_STRING_LENGTH		  Number 00C6
FASE_VEC			  Word	 DGROUP:09CA
FINAL_SCORE_MSG			  Byte	 DGROUP:0BFD
FINAL_SCORE_MSG_LENGTH		  Number 000E
FIND_EMPTY_SLOT			  Near	 _TEXT:07B1
FIND_FREE_SHOT			  Near	 _TEXT:05B2
FIND_SLOT			  Near	 _TEXT:0B6B
FINISH				  Near	 _TEXT:0088
FINISH_GAME			  Near	 _TEXT:0457
FIRE				  Near	 _TEXT:04D9
FOUND_EMPTY_SLOT		  Near	 _TEXT:07BE
FOUND_FREE_SHOT			  Near	 _TEXT:05BD
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 75
Symbol Table



FOUND_SLOT			  Near	 _TEXT:0B79
GAME_LOOP			  Near	 _TEXT:0059
GAME_OVER_CONDITION		  Near	 _TEXT:09C9
GAME_OVER_END			  Near	 _TEXT:007E
GAME_OVER_MSG			  Byte	 DGROUP:09D0
GAME_OVER_MSG_LENGTH		  Number 0122
HANDLE_ALIEN_DESTROYED		  Near	 _TEXT:0CBA
HANDLE_CONTROLS			  Near	 _TEXT:04AB
HANDLE_INPUT			  Near	 _TEXT:0299
HANDLE_METEOR_HIT		  Near	 _TEXT:0CF8
INIT_ALIEN_RANDOM		  Near	 _TEXT:0156
INIT_FASE3_TOWERS		  Near	 _TEXT:071E
INIT_TOWER_LOOP			  Near	 _TEXT:072A
LIFES_START			  Number 0003
LIVES				  Byte	 DGROUP:0777
LOOP_DIV			  Near	 _TEXT:0378
LOOP_MENU			  Near	 _TEXT:001A
MAIN				  Near	 _TEXT:0000
MAX_TOWERS			  Number 000C
MENU				  Byte	 DGROUP:0002
METEOR_MOVE_SPEED		  Word	 DGROUP:076F
METEOR_POS			  Word	 DGROUP:074B
METEOR_POS_INI			  Number 7E2C
METEOR_SPAWN_DELAY		  Word	 DGROUP:0771
METEOR_SPRITE			  Byte	 DGROUP:016E
MOVE_BOUNCE_MENU		  Near	 _TEXT:01F7
MOVE_BOUNCE_X_AND_DRAW		  Near	 _TEXT:01CE
MOVE_DOWN			  Near	 _TEXT:04E5
MOVE_DOWN_PROC			  Near	 _TEXT:09ED
MOVE_LEFT			  Near	 _TEXT:04EB
MOVE_LEFT_MENU			  Near	 _TEXT:01B5
MOVE_LEFT_PROC			  Near	 _TEXT:0A08
MOVE_MENU			  Near	 _TEXT:026B
MOVE_NEGATIVE			  Near	 _TEXT:052E
MOVE_RIGHT			  Near	 _TEXT:04FA
MOVE_RIGHT_BOUNCE		  Near	 _TEXT:0210
MOVE_RIGHT_MENU			  Near	 _TEXT:024F
MOVE_RIGHT_PROC			  Near	 _TEXT:0A31
MOVE_SPRITE			  Near	 _TEXT:050F
MOVE_TOWERS_LOOP		  Near	 _TEXT:0769
MOVE_UP				  Near	 _TEXT:04DF
MOVE_UP_PROC			  Near	 _TEXT:09D2
MOVE_WRAP_LEFT_AND_DRAW		  Near	 _TEXT:0194
MOVE_WRAP_RIGHT_AND_DRAW	  Near	 _TEXT:0228
MOVE_Y_AXIS			  Near	 _TEXT:051B
NEXT_CHECK_OVERLAP		  Near	 _TEXT:0BE7
NEXT_COLLISION_ALIEN		  Near	 _TEXT:0CAC
NEXT_COLLISION_SHOT		  Near	 _TEXT:0CA5
NEXT_FLOOR			  Near	 _TEXT:08E1
NEXT_RENDER_ALIEN		  Near	 _TEXT:0C36
NEXT_SHIP_COLLISION		  Near	 _TEXT:0D5A
NEXT_SHOT			  Near	 _TEXT:063B
NEXT_TOWER_X			  Word	 DGROUP:A551
NEXT_UPDATE_ALIEN		  Near	 _TEXT:0B45
NO_COLLISION_XY			  Near	 _TEXT:0D99
N_ALE				  Near	 _TEXT:00C3
OVERLAP_FOUND			  Near	 _TEXT:0BF0
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 76
Symbol Table



POSITIVE_DIST			  Near	 _TEXT:0BE2
PRESS_KEY_MSG			  Byte	 DGROUP:0BE2
PRESS_KEY_MSG_LENGTH		  Number 001B
PRINT_BUTTONS			  Near	 _TEXT:008C
PRINT_STRING			  Near	 _TEXT:00D2
PRINT_TITLE_MENU		  Near	 _TEXT:00E7
RANDOM_UINT16			  Near	 _TEXT:0126
REMOVE_ALIEN			  Near	 _TEXT:0B35
RENDER_ALIEN			  Near	 _TEXT:0553
RENDER_ALIENS			  Near	 _TEXT:0BF7
RENDER_ALIENS_5			  Near	 _TEXT:0C0F
RENDER_ALIENS_LOOP		  Near	 _TEXT:0C14
RENDER_ALIENS_START		  Near	 _TEXT:0C12
RENDER_BASE_ANDAR_2		  Near	 _TEXT:08C0
RENDER_BASE_LINE_LOOP		  Near	 _TEXT:08CB
RENDER_BUTTONS			  Near	 _TEXT:02B5
RENDER_FASE			  Near	 _TEXT:02DE
RENDER_FASE3_TOWERS		  Near	 _TEXT:07DD
RENDER_FLOOR_LOOP		  Near	 _TEXT:0890
RENDER_LIVES			  Near	 _TEXT:03C3
RENDER_METEOR			  Near	 _TEXT:055E
RENDER_SCORE			  Near	 _TEXT:038B
RENDER_SHIP			  Near	 _TEXT:0536
RENDER_SHOT_SPRITE		  Near	 _TEXT:0645
RENDER_SINGLE_LIFE		  Near	 _TEXT:03ED
RENDER_SPRITE			  Near	 _TEXT:00FA
RENDER_STATUS			  Near	 _TEXT:0404
RENDER_TERRAIN			  Near	 _TEXT:0691
RENDER_TERRAIN_FASE3		  Near	 _TEXT:06F2
RENDER_TIME			  Near	 _TEXT:0338
RENDER_TOP_LINE_LOOP		  Near	 _TEXT:08A7
RENDER_TOWER			  Near	 _TEXT:0810
RENDER_TOWERS_LOOP		  Near	 _TEXT:07E8
RESET_ALIENS			  Near	 _TEXT:0A5A
RESET_ALIENS_5			  Near	 _TEXT:0A77
RESET_ALIENS_LOOP		  Near	 _TEXT:0A7C
RESET_ALIENS_START		  Near	 _TEXT:0A7A
RESET_GAME			  Near	 _TEXT:0569
RESET_SHIP			  Near	 _TEXT:0548
RESTORE_BOUNCE			  Near	 _TEXT:0218
ROW_ALIEN			  Number 007D
ROW_ALIEN_FASE3			  Number 0032
ROW_METEOR			  Number 0064
ROW_SHIP			  Number 004B
ROW_SHIP_FASE3			  Number 0032
ROW_TERRAIN_FASE3		  Number 0096
SAVE_POS			  Near	 _TEXT:0530
SAVE_TIME			  Near	 _TEXT:045A
SAVE_TIMEOUT			  Near	 _TEXT:0488
SCORE				  Word	 DGROUP:0C15
SCORE_BUFFER			  Byte	 DGROUP:0C17
SCORE_BUFFER_LEN		  Number 0005
SCORE_STR			  Byte	 DGROUP:0C1C
SCORE_STR_LEN			  Number 0006
SCREEN_H			  Number 00C8
SCREEN_W			  Number 0140
SECONDS_START			  Number 003C
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 77
Symbol Table



SELECT_OPTION			  Near	 _TEXT:0037
SET_DIRECTION			  Near	 _TEXT:01F4
SHIP_POS			  Word	 DGROUP:074D
SHIP_POS_INI			  Number 5DC0
SHIP_POS_NORMAL_RENDER		  Near	 _TEXT:02F6
SHIP_POS_SET_RENDER		  Near	 _TEXT:02FC
SHIP_SPEED			  Number 0005
SHIP_SPRITE			  Byte	 DGROUP:0548
SHOOT				  Near	 _TEXT:05A5
SHOT_ACTIVE			  Byte	 DGROUP:0756
SHOT_COUNT			  Byte	 DGROUP:074F
SHOT_POS			  Word	 DGROUP:0750
SHOT_SPRITE			  Byte	 DGROUP:0727
SHOW_GAME_OVER			  Near	 _TEXT:08FA
SHOW_VICTORY			  Near	 _TEXT:093D
SKIP_MOVE_TOWER			  Near	 _TEXT:078C
SKIP_RENDER_TOWER		  Near	 _TEXT:0806
SKIP_SPAWN_TOWER		  Near	 _TEXT:07A4
SPAWN_ALIEN			  Near	 _TEXT:0B4E
SPAWN_ALIEN_5			  Near	 _TEXT:0B66
SPAWN_ALIEN_CALC_POS		  Near	 _TEXT:0B9D
SPAWN_ALIEN_NORMAL_Y		  Near	 _TEXT:0B93
SPAWN_ALIEN_START		  Near	 _TEXT:0B69
SPAWN_DONE			  Near	 _TEXT:07D9
SPAWN_FASE3_TOWER		  Near	 _TEXT:07A9
SPR_H				  Number 0014
SPR_W				  Number 0018
START_BTN			  Near	 _TEXT:009A
STRING				  Byte	 DGROUP:00A6
STRING_LENGTH			  Number 00C8
SUM_POINTS			  Near	 _TEXT:0305
TERRAIN_DONE_RENDER		  Near	 _TEXT:06EA
TERRAIN_FASE1			  Byte	 DGROUP:0C22
TERRAIN_FASE2			  Byte	 DGROUP:6B63
TERRAIN_POS			  Word	 DGROUP:A51F
TERRAIN_POS_NORMAL_ADVANCE	  Near	 _TEXT:044B
TERRAIN_POS_SET_ADVANCE		  Near	 _TEXT:0451
TERRAIN_VEC			  Word	 DGROUP:A519
TIME				  Byte	 DGROUP:0C0B
TIMEOUT				  Byte	 DGROUP:0C0C
TIME_BUFFER			  Byte	 DGROUP:0C0D
TIME_BUFFER_LEN			  Number 0002
TIME_STR			  Byte	 DGROUP:0C0F
TIME_STR_LEN			  Number 0006
TOPO				  Byte	 DGROUP:A409
TOWER_ACTIVE			  Byte	 DGROUP:A545
TOWER_DONE			  Near	 _TEXT:08F1
TOWER_HEIGHTS			  Byte	 DGROUP:A521
TOWER_MIN_SPACING		  Number 0022
TOWER_NOT_VISIBLE		  Near	 _TEXT:08F1
TOWER_NOT_VISIBLE_JMP		  Near	 _TEXT:082C
TOWER_RENDER_WIDTH		  Word	 DGROUP:A557
TOWER_SPAWN_COUNTER		  Word	 DGROUP:A553
TOWER_SPRITE_OFFSET		  Word	 DGROUP:A555
TOWER_VISIBLE			  Near	 _TEXT:082F
TOWER_X_POS			  Word	 DGROUP:A52D
TOWER_Y_OK			  Near	 _TEXT:087B
Turbo Assembler	 Version 4.1	    12/05/25 16:32:11	    Page 78
Symbol Table



UPDATE_ALIENS			  Near	 _TEXT:0A96
UPDATE_ALIENS_5			  Near	 _TEXT:0AE2
UPDATE_ALIENS_LOOP		  Near	 _TEXT:0AE7
UPDATE_ALIENS_START		  Near	 _TEXT:0AE5
UPDATE_EXISTING_ALIENS		  Near	 _TEXT:0ACE
UPDATE_FASE3_TOWERS		  Near	 _TEXT:0760
UPDATE_SHIP			  Near	 _TEXT:048F
UPDATE_SHOT			  Near	 _TEXT:05E5
UPDATE_SHOT_LOOP		  Near	 _TEXT:05F1
UPDATE_TIME			  Near	 _TEXT:040E
USE_FASE2_DELAY			  Near	 _TEXT:0AB6
USE_FASE2_SPEED			  Near	 _TEXT:0B1C
USE_FASE3_DELAY			  Near	 _TEXT:0ABD
USE_FASE3_SPEED			  Near	 _TEXT:0B23
USE_METEOR_SPRITE		  Near	 _TEXT:0C30
USE_NORMAL_DELAY		  Near	 _TEXT:0AC1
USE_NORMAL_SPEED		  Near	 _TEXT:0B27
VENCEDOR_MSG			  Byte	 DGROUP:0AF2
VENCEDOR_MSG_LENGTH		  Number 00F0
VICTORY_CONDITION		  Near	 _TEXT:09CE
VICTORY_END			  Near	 _TEXT:0083
WAIT_KEY			  Near	 _TEXT:09A8
WAIT_KEY_LOOP			  Near	 _TEXT:09A9

Groups & Segments		  Bit Size Align  Combine Class

DGROUP				  Group
  STACK				  16  0400 Para	  Stack	  STACK
  _DATA				  16  A559 Word	  Public  DATA
_TEXT				  16  0DA0 Word	  Public  CODE
